<?xml version="1.0" encoding="utf-8" ?>
<?xml-stylesheet type="text/xsl" title="XSL Formatting" href="/rss.xsl" media="all" ?>
<rss version="2.0">
<channel>
    <title>adsdassadfasdfasdf的专栏</title>
    <image>
    <link>http://blog.csdn.net</link>
    <url>http://static.blog.csdn.net/images/logo.gif</url>
    </image>
    <description>㊣er八经de爱</description>
	<link>http://blog.csdn.net/adsdassadfasdfasdf</link>
	<language>zh-cn</language>
	<generator>http://blog.csdn.net</generator>
	<ttl>5</ttl>
	<copyright><![CDATA[Copyright &copy; adsdassadfasdfasdf]]></copyright> 
	<pubDate>2015/9/17 14:30:05</pubDate>
    <item>
        <title><![CDATA[[原]做一个简单的大视频截取播放功能]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/23867153</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/23867153</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2014/4/16 18:35:03</pubDate>
        <description><![CDATA[
            
<p>index.aspx</p>
<pre code_snippet_id="296180" snippet_file_name="blog_20140416_1_9714473"  class="html" name="code">&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;index.aspx.cs&quot; Inherits=&quot;WebApplication1.index&quot; %&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;

&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
    &lt;div&gt;
            &lt;object align=&quot;middle&quot; classid=&quot;CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95&quot; class=&quot;OBJECT&quot;
            id=&quot;MediaPlayer1&quot;&gt;
            &lt;param name=&quot;ShowStatusBar&quot; value=&quot;-1&quot;&gt;
            &lt;param name=&quot;Filename&quot; value='Default.aspx?file=D:\1.wmv'&gt;
            &lt;embed type='application/x-oleobject' codebase='http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701'
                flename='mp' src='Default.aspx?file=D:\1.wmv'&gt;&lt;/object&gt;
                
                
    &lt;/div&gt;
    
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
<p><br>
Default.aspx</p>
<pre code_snippet_id="296180" snippet_file_name="blog_20140416_2_9790920"  class="html" name="code">&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;Default.aspx.cs&quot; Inherits=&quot;WebApplication1._Default&quot; %&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
    &lt;div&gt;

    &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
<p><br>
&nbsp;</p>
<p>Default.aspx.cs</p>
<pre code_snippet_id="296180" snippet_file_name="blog_20140416_3_1677512"  class="csharp" name="code">using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebApplication1
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            WriteFile(Request.QueryString[&quot;file&quot;]);
        }
        public void WriteFile(string filepath)
        {
            System.IO.Stream iStream = null;

            //缓冲区读取10K字节块
            byte[] buffer = new Byte[10240];

            //该文件的长度：
            int length;

            //总字节数为
            long dataToRead;

            // 识别下载，包括其路径中的文件。
            //string filepath  = @&quot;E:\software\SQL Server 2000 Personal Edition.ISO&quot;;
            // 识别的文件名。
            //string  filename  = System.IO.Path.GetFileName(filepath);

            try
            {
                ///打开文件。
                iStream = new System.IO.FileStream(filepath, System.IO.FileMode.Open,
                System.IO.FileAccess.Read, System.IO.FileShare.Read);

                // 总字节数为
                dataToRead = iStream.Length;

                long p = 0;
                if (Request.Headers[&quot;Range&quot;] != null)
                {
                    Response.StatusCode = 206;
                    p = long.Parse(Request.Headers[&quot;Range&quot;].Replace(&quot;bytes=&quot;, &quot;&quot;).Replace(&quot;-&quot;, &quot;&quot;));
                }
                if (p != 0)
                {
                    Response.AddHeader(&quot;Content-Range&quot;, &quot;bytes &quot; + p.ToString() + &quot;-&quot; + ((long)(dataToRead - 1)).ToString() + &quot;/&quot; + dataToRead.ToString());
                }
                Response.AddHeader(&quot;Content-Length&quot;, ((long)(dataToRead - p)).ToString());
                iStream.Position = p;
                dataToRead = dataToRead - p;
                // 读取的字节数
                while (dataToRead &gt; 0)
                {
                    // 验证客户端连接。
                    if (Response.IsClientConnected)
                    {
                        // 读入缓冲区中的数据
                        length = iStream.Read(buffer, 0, 10240);

                        // 写数据到当前输出流
                        Response.OutputStream.Write(buffer, 0, length);

                        // 刷新数据到HTML输出
                        Response.Flush();

                        buffer = new Byte[10240];
                        dataToRead = dataToRead - length;
                    }
                    else
                    {
                        //prevent infinite loop if user disconnects
                        dataToRead = -1;
                    }
                }
            }
            catch (Exception ex)
            {
                // Trap the error, if any.
                Response.Write(&quot;Error : &quot; + ex.Message);
            }
            finally
            {
                if (iStream != null)
                {
                    //Close the file.
                    iStream.Close();
                }
                Response.End();
            }
        }
    }
}
</pre>
<p><br>
&nbsp;</p>

            <div>
                作者：adsdassadfasdfasdf 发表于2014/4/16 18:35:03 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/23867153">原文链接</a>
            </div>
            <div>
            阅读：226 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/23867153#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[转]sqlserver字符串拆分(split)方法汇总]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/22598807</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/22598807</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2014/3/30 18:24:32</pubDate>
        <description><![CDATA[
            
<strong></strong><pre code_snippet_id="265246" snippet_file_name="blog_20140330_1_8112011"  class="sql" name="code" snippet_file_name="blog_20140330_1_8112011" code_snippet_id="265246">--方法0：动态SQL法</pre><pre code_snippet_id="265246" snippet_file_name="blog_20140330_1_8112011"  class="sql" name="code" snippet_file_name="blog_20140330_1_8112011" code_snippet_id="265246">declare @s varchar(100),@sql varchar(1000)
set @s='1,2,3,4,5,6,7,8,9,10'
set @sql='select col='''+ replace(@s,',',''' union all select ''')+''''
PRINT @sql
exec (@sql)<p> </p><p>if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[f_splitSTR]') and xtype in (N'FN', N'IF', N'TF'))
drop function [dbo].[f_splitSTR]
GO</p></pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<pre code_snippet_id="265246" snippet_file_name="blog_20140330_2_3139712"  class="sql" name="code" snippet_file_name="blog_20140330_2_3139712" code_snippet_id="265246">--方法1：循环截取法
CREATE FUNCTION f_splitSTR(
@s   varchar(8000),   --待分拆的字符串
@split varchar(10)     --数据分隔符
)RETURNS @re TABLE(col varchar(100))
AS
BEGIN
 DECLARE @splitlen int
 SET @splitlen=LEN(@split+'a')-2
 WHILE CHARINDEX(@split,@s)&gt;0
 BEGIN
  INSERT @re VALUES(LEFT(@s,CHARINDEX(@split,@s)-1))
  SET @s=STUFF(@s,1,CHARINDEX(@split,@s)+@splitlen,'')
 END
 INSERT @re VALUES(@s)
 RETURN
END
GO
 
 
 
if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[f_splitSTR]') and xtype in (N'FN', N'IF', N'TF'))
drop function [dbo].[f_splitSTR]
GO
</pre>
<p><br>
</p>
<pre code_snippet_id="265246" snippet_file_name="blog_20140330_3_75832"  class="sql" name="code" snippet_file_name="blog_20140330_3_75832" code_snippet_id="265246">--方法2：使用临时性分拆辅助表法
CREATE FUNCTION f_splitSTR(
@s   varchar(8000),  --待分拆的字符串
@split varchar(10)     --数据分隔符
)RETURNS @re TABLE(col varchar(100))
AS
BEGIN
 --创建分拆处理的辅助表(用户定义函数中只能操作表变量)
 DECLARE @t TABLE(ID int IDENTITY,b bit)
 INSERT @t(b) SELECT TOP 8000 0 FROM syscolumns a,syscolumns b
 
 INSERT @re SELECT SUBSTRING(@s,ID,CHARINDEX(@split,@s+@split,ID)-ID)
 FROM @t
 WHERE ID&lt;=LEN(@s+'a') 
  AND CHARINDEX(@split,@split+@s,ID)=ID
 RETURN
END
GO
 
 
 
if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[f_splitSTR]') and xtype in (N'FN', N'IF', N'TF'))
drop function [dbo].[f_splitSTR]
GO
if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[tb_splitSTR]') and objectproperty(id,N'IsUserTable')=1)
drop table [dbo].[tb_splitSTR]
GO
--方法3：使用永久性分拆辅助表法
--字符串分拆辅助表
SELECT TOP 8000 ID=IDENTITY(int,1,1) INTO dbo.tb_splitSTR
FROM syscolumns a,syscolumns b
GO
--字符串分拆处理函数
CREATE FUNCTION f_splitSTR(
@s     varchar(8000),  --待分拆的字符串
@split  varchar(10)     --数据分隔符
)RETURNS TABLE
AS
RETURN(
 SELECT col=CAST(SUBSTRING(@s,ID,CHARINDEX(@split,@s+@split,ID)-ID) as varchar(100))
 FROM tb_splitSTR
 WHERE ID&lt;=LEN(@s+'a') 
  AND CHARINDEX(@split,@split+@s,ID)=ID)
GO
 
 
 
--方法4：利用sql server2005的OUTER APPLY
 
CREATE FUNCTION [dbo].[ufn_SplitStringToTable]
(
  @str VARCHAR(MAX) ,
  @split VARCHAR(10)
)
RETURNS TABLE
    AS 
RETURN
    ( SELECT    B.id
      FROM      ( SELECT    [value] = CONVERT(XML , '&lt;v&gt;' + REPLACE(@str , @split , '&lt;/v&gt;&lt;v&gt;')
                            + '&lt;/v&gt;')
                ) A
      OUTER APPLY ( SELECT  id = N.v.value('.' , 'varchar(100)')
                    FROM    A.[value].nodes('/v') N ( v )
                  ) B
    )
</pre>
<p><br>
</p>
<p>备注说明：</p>
<p>方法4必须在sql server2005下才可以运行</p>
<p></p>

            <div>
                作者：adsdassadfasdfasdf 发表于2014/3/30 18:24:32 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/22598807">原文链接</a>
            </div>
            <div>
            阅读：202 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/22598807#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[原]html横向导入word]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/9319727</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/9319727</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2013/7/13 17:17:39</pubDate>
        <description><![CDATA[
            
<p>导入word事件</p>
<pre class="csharp" name="code"> /// &lt;summary&gt;
    /// 导入word事件
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
    /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
    protected void btuDaoWord_ServerClick(object sender, EventArgs e)
    {
        StringBuilder html = new StringBuilder();
        TenderNoticeEntity etyTenderNotice = new TenderNoticeEntity();
        etyTenderNotice = _busTenderNotice.SearchId(hdCID.Value);

        if (etyTenderNotice != null)
        {
            html.Append(@&quot;
                    &lt;html&gt;
                    &lt;head&gt;
                        &lt;style&gt;
                            .t1{background:URL('&quot; + System.Configuration.ConfigurationManager.AppSettings.Get(&quot;ImgFilePath&quot;).ToString() + @&quot;/images/shuiyin.png');position:absolute;filter:alpha(opacity=10);z-index:1; width:100%; height:100%}
                            .t2{z-index:2; width:100%; height:100%;position:absolute}
                            .table7
                            {
                                 font-size:14pt;
                                border-top: 1px solid #000000;
                                border-left: 1px solid #000000;
                            }
                             .table7 th
                             {
                                 font-size:14pt;
                                font-weight:lighter ;
                            }
                            .tabletd
                            {
                                 font-size:14pt;
                                border-bottom: 1px solid #000000;
                                border-left: 1px solid #000000;
                                border-top: 1px solid #000000;
                                border-right: 1px solid #000000;
                                padding-left:5px;
                                padding-right:5px;
                            }
                            #gvContractDetail
                            {
                                border-top: 1px solid #000000;
                                border-left: 1px solid #000000;
                                border-bottom: 1px solid #000000;
                                border-right: 1px solid #000000;
                            }
                            #gvContractDetail th
                            {
                                border-top: 1px solid #000000;
                                border-left: 1px solid #000000;
                                border-right: 1px solid #000000;
                                line-height: 50px;
                                font-weight:lighter ;
                            }
                            #gvContractDetail td
                            {
                                border-top: 1px solid #000000;
                                border-left: 1px solid #000000;
                                line-height: 50px;
                            }
                            .p1
                            {
                                margin: 0px;
                                padding: 0px;
                                height: 25px;
                                line-height: 50px;
                                font-size:14pt;
                            }
                      &lt;!--
                         @page
                            {mso-page-border-surround-header:no;
                            mso-page-border-surround-footer:no;}
                        @page WordSection1
                            {size:841.9pt 595.3pt;
                            mso-page-orientation:landscape;
                            margin:89.85pt 72.0pt 89.85pt 72.0pt;
                            mso-header-margin:42.55pt;
                            mso-footer-margin:49.6pt;
                            mso-paper-source:0;
                            layout-grid:15.6pt;}
                        div.WordSection1
                            {page:WordSection1;}

                        --&gt;

                        &lt;/style&gt;
                    &lt;/head&gt;
                    &lt;body style=&quot;&quot;background:URL('&quot; + System.Configuration.ConfigurationManager.AppSettings.Get(&quot;ImgFilePath&quot;).ToString() + @&quot;/images/shuiyin2.png');position:absolute;&quot;&quot;&gt;
                    &lt;div class=&quot;&quot;t1&quot;&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;&quot;WordSection1&quot;&quot;&gt;
                   &lt;table cellspacing=&quot;&quot;4&quot;&quot; cellpadding=&quot;&quot;0&quot;&quot; width=&quot;&quot;100%&quot;&quot; Height=&quot;&quot;100%&quot;&quot; align=&quot;&quot;center&quot;&quot; border=&quot;&quot;0&quot;&quot;&gt;
                    &lt;tr&gt;
                        &lt;td&gt;
                            &lt;p align=&quot;&quot;center&quot;&quot; style=&quot;&quot;margin: 0px; padding: 0px; font-size:30pt;&quot;&quot;&gt;
                                &lt;strong&gt;中&nbsp;标&nbsp;通&nbsp;知&nbsp;书&lt;/strong&gt;
                            &lt;/p&gt;
                            &lt;p align=&quot;&quot;right&quot;&quot; style=&quot;&quot;margin: 0px; padding: 0px; font-size:14pt;&quot;&quot;&gt;
                                招标编号：&quot; + etyTenderNotice.Tendernum + @&quot;
                            &lt;/p&gt;
                            &lt;table cellspacing=&quot;&quot;0&quot;&quot; cellpadding=&quot;&quot;0&quot;&quot; width=&quot;&quot;100%&quot;&quot; Height=&quot;&quot;80%&quot;&quot; align=&quot;&quot;center&quot;&quot;&gt;
                            &lt;tr style=&quot;&quot; height:100%&quot;&quot;&gt;
                                &lt;td style=&quot;&quot;height: 25px;&quot;&quot; align=&quot;&quot;right&quot;&quot; valign=&quot;&quot;top&quot;&quot; width=&quot;&quot;48%&quot;&quot; class=&quot;&quot;tabletd&quot;&quot;&gt;
                                    &lt;p align=&quot;&quot;left&quot;&quot; class=&quot;&quot;p1&quot;&quot; style=&quot;&quot;padding-top:10px;&quot;&quot;&gt;
                                        &lt;u&gt;&nbsp;&quot; + etyTenderNotice.Successtenderdept + @&quot;&nbsp;&lt;/u&gt;：
                                    &lt;/p&gt;
                                    &lt;br /&gt;
                                    &lt;p  class=&quot;&quot;p1&quot;&quot; align=&quot;&quot;left&quot;&quot;&gt;
                                        &lt;span align=&quot;&quot;left&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;u&gt;潞安环保能源开发股份有限公司:&quot; + etyTenderNotice.TenderPeopleName + @&quot;&nbsp;&lt;/u&gt;
                                        （招标人名称）的&lt;u&gt;&nbsp;&quot; + etyTenderNotice.Tendername + @&quot;&nbsp;&lt;/u&gt;（招标项目名称）于&lt;u&gt;&nbsp;&quot; + etyTenderNotice.Tenderdate.ToString(&quot;yyyy年MM月dd日&quot;) + @&quot;&nbsp;&lt;/u&gt;
                                        开标后，已完成评标工作，确定你单位下列设备（材料）中标：
                                    &lt;/p&gt;
                                    &lt;br /&gt;
                                     &lt;div&gt;
	                                    &lt;table cellspacing=&quot;&quot;0&quot;&quot; rules=&quot;&quot;all&quot;&quot; border=&quot;&quot;1&quot;&quot; id=&quot;&quot;gvContractDetail&quot;&quot; style=&quot;&quot;width:100%;border-collapse:collapse;&quot;&quot;&gt;
		                                    &lt;tr align=&quot;&quot;center&quot;&quot;&gt;
			                                    &lt;th scope=&quot;&quot;col&quot;&quot;&gt;序号&lt;/th&gt;&lt;th scope=&quot;&quot;col&quot;&quot;&gt;名称&lt;/th&gt;&lt;th scope=&quot;&quot;col&quot;&quot;&gt;规格型号&lt;/th&gt;&lt;th scope=&quot;&quot;col&quot;&quot;&gt;数量&lt;/th&gt;&lt;th scope=&quot;&quot;col&quot;&quot;&gt;金额（万元）&lt;/th&gt;
		                                    &lt;/tr&gt;&quot;);
                                        DataTable dt = _busTenderNoticeDetails.Search(new TenderNoticeDetailsEntity() { Id = etyTenderNotice.Tendernoticeid }).Tables[0];
                                        foreach (DataRow dr in dt.Rows)
                                        {
                                            html.Append(@&quot;
                                            &lt;tr align=&quot;&quot;center&quot;&quot;&gt;
                                                &lt;td&gt;&quot; + dr[&quot;PlanOrder&quot;] + @&quot;&lt;/td&gt;&lt;td&gt;&quot; + dr[&quot;MachineName&quot;] + @&quot;&lt;/td&gt;&lt;td&gt;&quot; + dr[&quot;MachineNum&quot;] + @&quot;&lt;/td&gt;&lt;td&gt;&quot; + dr[&quot;GZSL&quot;] + @&quot;&lt;/td&gt;&lt;td&gt;&quot; + dr[&quot;GZJE&quot;] + @&quot;&lt;/td&gt;
                                            &lt;/tr&gt;&quot;);
                                        }
                                        html.Append(@&quot;
	                                    &lt;/table&gt;
                                    &lt;/div&gt;
                                &lt;/td&gt;
                                &lt;td valign=&quot;&quot;top&quot;&quot;&gt;
                                    &nbsp;
                                &lt;/td&gt;
                                &lt;td valign=&quot;&quot;top&quot;&quot; class=&quot;&quot;tabletd&quot;&quot;  width=&quot;&quot;48%&quot;&quot; &gt;
                                    &lt;p&gt;
                                        &lt;span&gt;&nbsp;&lt;/span&gt;
                                    &lt;/p&gt;
                                    &lt;p  class=&quot;&quot;p1&quot;&quot;&gt;
                                        &nbsp; &nbsp; 中标总价&lt;u&gt; &nbsp;&quot; + DataConvert.ConvertSum((DataConvert.ToDecimal(etyTenderNotice.Successtenderprice) * 10000).ToString(&quot;0&quot;)) + @&quot;&nbsp;（大写）&nbsp;&lt;/u&gt;万元，
                                        请贵单位收到中标通知书后，在&lt;u&gt;&quot; + etyTenderNotice.Lastdate.ToString(&quot;yyyy年MM月dd日&quot;) + @&quot;&lt;/u&gt;前持中标通知书与招标人进行合同谈判与签订。
                                    &lt;/p&gt;
                                    &lt;p&gt;
                                        &lt;span&gt;&nbsp;&lt;/span&gt;
                                    &lt;/p&gt;
                                    &lt;p class=&quot;&quot;p1&quot;&quot;&gt;
                                        &nbsp;&nbsp;招标人（盖章）&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;潞安集团招标领导组&lt;br&gt;
                                        &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;办公室（备案）
                                    &lt;/p&gt;
                                    &lt;p&gt;
                                        &lt;span&gt;&nbsp;&lt;/span&gt;
                                    &lt;/p&gt;
                                    &lt;p  class=&quot;&quot;p1&quot;&quot; align=&quot;&quot;right&quot;&quot;&gt;
                                        &quot; + etyTenderNotice.SendDate.ToString(&quot;yyyy年MM月dd日&quot;) + @&quot;&nbsp;&nbsp;
                                        &lt;br&gt;
                                    &lt;/p&gt;
                                &lt;/td&gt;
                            &lt;/tr&gt;
                        &lt;/table&gt;
                    &lt;div style=&quot;&quot;padding-top:10px;&quot;&quot;&gt;&lt;/div&gt;
                    &lt;span style=&quot;&quot;font-size: 10pt;height: 15px;line-height: 15px;&quot;&quot;&gt;备注：&lt;span&gt;1.&lt;/span&gt;此中标通知书一式三份，招标人、中标人、集团公司招标办公室各一份。&lt;/span&gt;
                    &lt;br&gt;
                    &lt;span style=&quot;&quot;font-size: 10pt;&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;2.设备（材料）种类、项目过多超出表格时，可采用附页填报并加盖公章。&lt;/span&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
            &lt;/table&gt;
            &lt;/div&gt;
            &lt;/body&gt;
            &lt;/html&gt;
		                            &quot;);

        }
        Tools.ToWord(html);
        Response.End();
    }</pre>
<p>C#导入word方法：</p>
<pre class="csharp" name="code"> //************************************************************************************************
        /// &lt;summary&gt;
        /// 将控件内容导出到Excel,传递一个控件
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;body&quot;&gt;控件名称&lt;/param&gt;
        public static void ToDocument(StringBuilder str)
        {
            //清除Response缓存内容
            HttpContext.Current.Response.Clear();
            HttpContext.Current.Response.Buffer = true;

            //确定字符的编码格式
            HttpContext.Current.Response.AppendHeader(&quot;Content-Disposition&quot;, &quot;attachment;filename=Document.xls&quot;);
            HttpContext.Current.Response.ContentType = &quot;application/ms-excel&quot;;//image/JPEG;text/HTML;image/GIF;vnd.ms-excel/msword
            HttpContext.Current.Response.Charset = &quot;GB2312&quot;;
            HttpContext.Current.Response.ContentEncoding = System.Text.Encoding.GetEncoding(&quot;GB2312&quot;);



            //表体空间
            // System.IO.StringWriter swBody = new System.IO.StringWriter();
            // System.Web.UI.HtmlTextWriter hwBody = new System.Web.UI.HtmlTextWriter(swBody);
            // body.RenderControl(hwBody);

            //消除乱码特别设定，非常规方法
            string strExcel = &quot;&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html; charset=gb2312\&quot;&gt;&quot;;
            //strExcel += hwBody.InnerWriter.ToString();

            HttpContext.Current.Response.Write(strExcel + str);
            HttpContext.Current.Response.End();
        }

        //************************************************************************************************
        /// &lt;summary&gt;
        /// 将控件内容导出到word,传递一个控件
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;body&quot;&gt;控件名称&lt;/param&gt;
        public static void ToWord(StringBuilder str)
        {
            //清除Response缓存内容
            HttpContext.Current.Response.Clear();
            HttpContext.Current.Response.Buffer = true;

            //确定字符的编码格式
            HttpContext.Current.Response.AppendHeader(&quot;Content-Disposition&quot;, &quot;attachment;filename=Document.doc&quot;);
            HttpContext.Current.Response.ContentType = &quot;application/msword&quot;;//image/JPEG;text/HTML;image/GIF;vnd.ms-excel/msword
            HttpContext.Current.Response.Charset = &quot;GB2312&quot;;
            HttpContext.Current.Response.ContentEncoding = System.Text.Encoding.GetEncoding(&quot;GB2312&quot;);


            //表体空间
            // System.IO.StringWriter swBody = new System.IO.StringWriter();
            // System.Web.UI.HtmlTextWriter hwBody = new System.Web.UI.HtmlTextWriter(swBody);
            // body.RenderControl(hwBody);

            //消除乱码特别设定，非常规方法
            string strExcel = &quot;&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html; charset=gb2312\&quot;&gt;&quot;;
            //strExcel += hwBody.InnerWriter.ToString();

            HttpContext.Current.Response.Write(strExcel + str);
            HttpContext.Current.Response.End();
        }</pre>
<p>今天一直在弄横向导入word</p>
<p>在网上收了收主要就是通过css样式把要导入的html设置为横向的</p>
<p>首先在页面的head中加下面的一段代码 <br>
&lt;head&gt;<br>
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=gb2312&quot;&gt;<br>
&lt;style&gt;<br>
&lt;!--<br>
@page<br>
&nbsp;&nbsp;&nbsp; {mso-page-border-surround-header:no;<br>
&nbsp;&nbsp;&nbsp; mso-page-border-surround-footer:no;}<br>
@page Section1<br>
&nbsp;&nbsp;&nbsp; {size:841.9pt 595.3pt;<br>
&nbsp;&nbsp;&nbsp; mso-page-orientation:landscape;<br>
&nbsp;&nbsp;&nbsp; margin:89.85pt 72.0pt 89.85pt 72.0pt;<br>
&nbsp;&nbsp;&nbsp; mso-header-margin:42.55pt;<br>
&nbsp;&nbsp;&nbsp; mso-footer-margin:49.6pt;<br>
&nbsp;&nbsp;&nbsp; mso-paper-source:0;<br>
&nbsp;&nbsp;&nbsp; layout-grid:15.6pt;}<br>
div.Section1<br>
&nbsp;&nbsp;&nbsp; {page:Section1;}<br>
--&gt;<br>
&lt;/style&gt;<br>
&lt;/head&gt;<br>
然后用div包含整个的显示内容，会调用上面的style </p>
<p>&lt;div class=Section1&gt;</p>
<p>&lt;/div&gt;<br>
</p>
<p><br>
<br>
&nbsp;</p>

            <div>
                作者：adsdassadfasdfasdf 发表于2013/7/13 17:17:39 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/9319727">原文链接</a>
            </div>
            <div>
            阅读：1120 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/9319727#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[转]SQL Server中删除重复数据的几个方法]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/8286821</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/8286821</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/12/12 15:21:41</pubDate>
        <description><![CDATA[
            
数据库的使用过程中由于程序方面的问题有时候会碰到重复数据，重复数据导致了数据库部分设置不能正确设置…… <br>
<br>
　　方法一<br>
<pre class="sql" name="code">declare @max integer,@id integer
declare cur_rows cursor local for select 主字段,count(*) from 表名 group by 主字段 having count(*) &gt; 1
open cur_rows
fetch cur_rows into @id,@max
while @@fetch_status=0
begin
select @max = @max -1
set rowcount @max
delete from 表名 where 主字段 = @id
fetch cur_rows into @id,@max
end
close cur_rows
set rowcount 0</pre><br>
<br>
方法二<br>
<br>
　　有两个意义上的重复记录，一是完全重复的记录，也即所有字段均重复的记录，二是部分关键字段重复的记录，比如Name字段重复，而其他字段不一定重复或都重复可以忽略。<br>
<br>
　　1、对于第一种重复，比较容易解决，使用<br>
<br>
<pre class="sql" name="code">select distinct * from tableName</pre><br>
就可以得到无重复记录的结果集。<br>
<br>
　　如果该表需要删除重复的记录（重复记录保留1条），可以按以下方法删除<br>
<br>
<pre class="sql" name="code">select distinct * into #Tmp from tableName
drop table tableName
select * into tableName from #Tmp
drop table #Tmp</pre><br>
发生这种重复的原因是表设计不周产生的，增加唯一索引列即可解决。<br>
<br>
　　2、这类重复问题通常要求保留重复记录中的第一条记录，操作方法如下<br>
<br>
　　假设有重复的字段为Name,Address，要求得到这两个字段唯一的结果集<br>
<br>
<pre class="sql" name="code">select identity(int,1,1) as autoID, * into #Tmp from tableName
select min(autoID) as autoID into #Tmp2 from #Tmp group by Name,autoID
select * from #Tmp where autoID in(select autoID from #tmp2)</pre><br>
最后一个select即得到了Name，Address不重复的结果集（但多了一个autoID字段，实际写时可以写在select子句中省去此列）<br>
<br>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/12/12 15:21:41 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/8286821">原文链接</a>
            </div>
            <div>
            阅读：315 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/8286821#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[原]asp.net获取Repeater里面Button提交后的文本框的值]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/8258721</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/8258721</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/12/5 10:09:43</pubDate>
        <description><![CDATA[
            
<pre class="csharp" name="code"> protected void btnAddFJ_Click(object sender, EventArgs e)
        {
            Button bt = sender as Button;
            RepeaterItem rptItem = bt.Parent as RepeaterItem;
            TextBox txt = rptItem.FindControl(&quot;txtFJName&quot;) as TextBox;
            //ScriptManager.RegisterStartupScript(this.btnShow, this.GetType(), &quot;myscript&quot;, &quot;alert('&quot; + txt.Text + &quot;');&quot;, true);
            ScriptManager.RegisterStartupScript(this.btnShow, this.GetType(), &quot;myscript&quot;, &quot;navtabshow();&quot;, true);
        }</pre>效果：<br>
<img src="http://img.my.csdn.net/uploads/201212/05/1354673655_5488.png" width="926" height="369" alt="">

            <div>
                作者：adsdassadfasdfasdf 发表于2012/12/5 10:09:43 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/8258721">原文链接</a>
            </div>
            <div>
            阅读：1048 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/8258721#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[原]Gridview创建行列 合并列、行类]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/8106371</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/8106371</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/10/24 12:59:34</pubDate>
        <description><![CDATA[
            
<p>Gridview创建行列</p>
<p>1种.</p>
<pre class="csharp" name="code">//行
GridViewRow rowHeader = new GridViewRow(0, 0, DataControlRowType.Header, DataControlRowState.Normal);

//TH
TableCell th = new TableHeaderCell();

//TD
TableCell td = new TableCell();

//添加单元格
rowHeader.Cells.Add(headerCell);
rowHeader.Visible = true;

//添加行
GridView1.Controls[0].Controls.AddAt(0, rowHeader);</pre>
<p>2.种</p>
<pre class="csharp" name="code">            //创建一个GridView的一个分隔行(根据DataControlRowType来设置)
            GridViewRow rowSeparator = new GridViewRow(0, 0, DataControlRowType.Separator, DataControlRowState.Normal);
            //设置行的底色
            rowSeparator.BackColor = System.Drawing.Color.White;
            //设置单元格集
            //可以根据实际情况设置，我在这儿是根据RowDataBound事件（e参数）来设置的
            TableCellCollection cells = e.Row.Cells;
            //设置单元格，根据实际情况增加，我这儿是增加一个跨所有列的行
            TableCell separatorCell = new TableCell();
            //根据GridView的第一列的显示情况设置单元格和跨列数
            if (gvMain.Columns[0].Visible == true)
            {
               separatorCell.ColumnSpan = cells.Count;
            }
            else
            {
                separatorCell.ColumnSpan = cells.Count - 1;
            }
             //单元格的对齐
            separatorCell.HorizontalAlign = HorizontalAlign.Right;
            //单元格的背景色
            separatorCell.BackColor = System.Drawing.Color.FromArgb(226, 226, 226);
            //单元格的高度
            separatorCell.ControlStyle.Height = 5;
             //在单元格集中增加单元格控件
            rowSeparator.Cells.Add(separatorCell);
            //设置GridView行的可见性
            rowSeparator.Visible = true;
            //在GridView中的相应行插入行
            gvMain.Controls[0].Controls.AddAt(e.Row.RowIndex + 1, rowSeparator);</pre>
<p>GridView 合并行、列</p>
<pre class="csharp" name="code">using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data;
using System.Web.UI.WebControls;

/// &lt;summary&gt;
///GridViewMergeCell 合并GridView liyang 20090916
/// &lt;/summary&gt;
public class GridViewMergeCell
{
    public GridViewMergeCell()
    {
        //
        //TODO: 在此处添加构造函数逻辑
        //
    }
    #region 合并单元格 合并某一行的所有列
    public static void GroupRow(GridView gridView)
    {
        for (int rowIndex = gridView.Rows.Count - 2; rowIndex &gt;= 0; rowIndex--)
        {
            GridViewRow row = gridView.Rows[rowIndex];
            GridViewRow previousRow = gridView.Rows[rowIndex + 1];

            for (int i = 0; i &lt; row.Cells.Count; i++)
            {
                if (row.Cells[i].Text == previousRow.Cells[i].Text)
                {
                    row.Cells[i].RowSpan = previousRow.Cells[i].RowSpan &lt; 2 ? 2 :
                                           previousRow.Cells[i].RowSpan + 1;
                    previousRow.Cells[i].Visible = false;
                }
            }
        }
    }
    ///　 &lt;summary&gt;　
    ///　 合并GridView中某行相同信息的行（单元格）
    ///　 &lt;/summary&gt;　
    ///　 &lt;param　 name=&quot;GridView1&quot;&gt;GridView对象&lt;/param&gt;　
    ///　 &lt;param　 name=&quot;cellNum&quot;&gt;需要合并的行&lt;/param&gt;
    public static void GroupRow(GridView gridView, int rows)
    {
        TableCell oldTc = gridView.Rows[rows].Cells[0];
        for (int i = 1; i &lt; gridView.Rows[rows].Cells.Count; i++)
        {
            TableCell tc = gridView.Rows[rows].Cells[i];　 //Cells[0]就是你要合并的列
            if (oldTc.Text == tc.Text)
            {
                tc.Visible = false;
                if (oldTc.ColumnSpan == 0)
                {
                    oldTc.ColumnSpan = 1;
                }
                oldTc.ColumnSpan++;
                oldTc.VerticalAlign = VerticalAlign.Middle;
            }
            else
            {
                oldTc = tc;
            }
        }
    }
    #endregion
    #region 合并单元格 合并一行中的几列
    /// &lt;summary&gt;
    /// 合并单元格 合并一行中的几列
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;GridView1&quot;&gt;GridView ID&lt;/param&gt;
    /// &lt;param name=&quot;rows&quot;&gt;行&lt;/param&gt;
    /// &lt;param name=&quot;sCol&quot;&gt;开始列&lt;/param&gt;
    /// &lt;param name=&quot;eCol&quot;&gt;结束列&lt;/param&gt;
    public static void GroupRow(GridView gridView, int rows, int sCol, int eCol)
    {
        TableCell oldTc = gridView.Rows[rows].Cells[sCol];
        for (int i = 1; i &lt; eCol - sCol; i++)
        {
            TableCell tc = gridView.Rows[rows].Cells[i + sCol];　 //Cells[0]就是你要合并的列
            tc.Visible = false;
            if (oldTc.ColumnSpan == 0)
            {
                oldTc.ColumnSpan = 1;
            }
            oldTc.ColumnSpan++;
            oldTc.VerticalAlign = VerticalAlign.Middle;
        }
    }
    #endregion
    #region 合并单元格 合并某一列所有行
    /// &lt;summary&gt;
    /// 合并GridView中某列相同信息的行（单元格）
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;GridView1&quot;&gt;&lt;/param&gt;
    /// &lt;param name=&quot;cellNum&quot;&gt;&lt;/param&gt;
    public static void GroupCol(GridView gridView, int cols)
    {
        if (gridView.Rows.Count &lt; 1 || cols &gt; gridView.Rows[0].Cells.Count - 1)
        {
            return;
        }
        TableCell oldTc = gridView.Rows[0].Cells[cols];
        for (int i = 1; i &lt; gridView.Rows.Count; i++)
        {
            TableCell tc = gridView.Rows[i].Cells[cols];
            if (oldTc.Text == tc.Text)
            {
                tc.Visible = false;
                if (oldTc.RowSpan == 0)
                {
                    oldTc.RowSpan = 1;
                }
                oldTc.RowSpan++;
                oldTc.VerticalAlign = VerticalAlign.Middle;
            }
            else
            {
                oldTc = tc;
            }
        }
    }
    #endregion
    #region 合并单元格 合并某一列中的某些行
    /// &lt;summary&gt;
    /// 合并单元格 合并某一列中的某些行
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;GridView1&quot;&gt;GridView ID&lt;/param&gt;
    /// &lt;param name=&quot;cellNum&quot;&gt;列&lt;/param&gt;
    /// &lt;param name=&quot;sRow&quot;&gt;开始行&lt;/param&gt;
    /// &lt;param name=&quot;eRow&quot;&gt;结束列&lt;/param&gt;
    public static void GroupCol(GridView gridView, int cols, int sRow, int eRow)
    {
        if (gridView.Rows.Count &lt; 1 || cols &gt; gridView.Columns.Count - 1)
        {
            return;
        }
        TableCell oldTc = gridView.Rows[sRow].Cells[cols];
        for (int i = 1; i &lt; eRow - sRow; i++)
        {
            TableCell tc = gridView.Rows[sRow + i].Cells[cols];
            tc.Visible = false;
            if (oldTc.RowSpan == 0)
            {
                oldTc.RowSpan = 1;
            }
            oldTc.RowSpan++;
            oldTc.VerticalAlign = VerticalAlign.Middle;
        }
    }
    #endregion
}


</pre>
<p><br>
&nbsp;</p>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/10/24 12:59:34 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/8106371">原文链接</a>
            </div>
            <div>
            阅读：2626 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/8106371#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[原]动态添加TemplateField列]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/8102945</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/8102945</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/10/23 15:03:57</pubDate>
        <description><![CDATA[
            
<p><strong>GridViewTextTemplate类</strong>：</p>
<pre class="csharp" name="code">using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI.WebControls;

/// &lt;summary&gt;
///GridViewTextTemplate 的摘要说明
/// &lt;/summary&gt;
public class GridViewTextTemplate : System.Web.UI.ITemplate
{
    private DataControlRowType templateType;

    private string columnName;

    private string cId;


    public GridViewTextTemplate(DataControlRowType type, string colname, string controlId)
    {

        templateType = type;

        columnName = colname;

        cId = controlId;

    }


    public void InstantiateIn(System.Web.UI.Control container)
    {

        // Create the content for the different row types.

        switch (templateType)
        {

            case DataControlRowType.Header:

                // Create the controls and set id properties to put in the header
                Literal myHeadLiteral = new Literal();

                myHeadLiteral.ID = cId;

                myHeadLiteral.Text = &quot;&lt;B&gt;&quot; + columnName + &quot;&lt;/B&gt;&quot;;


                container.Controls.Add(myHeadLiteral);
                break;

            case DataControlRowType.DataRow:

                // Create the controls and set id properties to put in a data row

                TextBox myTextBox = new TextBox();

                myTextBox.ID = cId;

                myTextBox.DataBinding += new EventHandler(this.TextBoxDataBinding);

                myTextBox.Width = 100;
                container.Controls.Add(myTextBox);

                break;

            default:

                // Insert code to handle unexpected values.

                break;

        }

    }


    private void TextBoxDataBinding(Object sender, EventArgs e)
    {

        TextBox myTextBox = (TextBox)sender;

        GridViewRow row = (GridViewRow)myTextBox.NamingContainer;


        myTextBox.Text = System.Web.UI.DataBinder.Eval(row.DataItem, columnName).ToString();

    }

}
</pre>在后台GridView动态添加TemplateField：<pre class="csharp" name="code">
	//parameter_description绑定的数据 textParameterDesc是Text的ID
        TemplateField tField;
        tField = new TemplateField();
        tField.HeaderTemplate = new GridViewTextTemplate(DataControlRowType.Header, &quot;说明&quot;, &quot;textParameterDescHd&quot;);
        tField.ItemTemplate = new GridViewTextTemplate(DataControlRowType.DataRow, &quot;parameter_description&quot;, &quot;textParameterDesc&quot;);
        GridView1.Columns.Add(tField);
</pre>或者：<pre class="csharp" name="code">GridView1.Columns.Add(new TemplateField() { HeaderTemplate = new GridViewTextTemplate(DataControlRowType.Header, &quot;序号&quot;, &quot;&quot;), ItemTemplate = new GridViewTextTemplate(DataControlRowType.DataRow, &quot;PlanSN&quot;, &quot;&quot;) });
</pre>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/10/23 15:03:57 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/8102945">原文链接</a>
            </div>
            <div>
            阅读：1997 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/8102945#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[转]js动态生产table、Div、select]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7689870</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7689870</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/6/25 15:50:35</pubDate>
        <description><![CDATA[
            
<p>一种方法：</p>
<pre class="html" name="code">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;
&quot;http://www.w3.org/TR/html4/loose.dtd &quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=gb2312&quot;&gt;
&lt;title&gt;js操作表格&lt;/title&gt;
&lt;script language=&quot;javascript&quot;&gt;
/*生成表格，采用appendChild*/
function init(){ 
     _table=document.getElementById(&quot;table&quot;);
_table.border=&quot;1px&quot;;
_table.width=&quot;800px&quot;;

   for(var i=1;i&lt;10;i++){
   var row=document.createElement(&quot;tr&quot;); 
   row.id=i;
   for(var j=1;j&lt;6;j++){
    var cell=document.createElement(&quot;td&quot;); 
    cell.id=i+&quot;/&quot;+j;
    cell.appendChild(document.createTextNode(&quot;第&quot;+cell.id+&quot;列&quot;)); 
    row.appendChild(cell); 
   }
   document.getElementById(&quot;newbody&quot;).appendChild(row); 
}
} 

function rebulid(){
   var beginRow=document.getElementById(&quot;beginRow&quot;).value;/*开始行*/
var endRow=document.getElementById(&quot;endRow&quot;).value;/*结束行*/

var beginCol=document.getElementById(&quot;beginCol&quot;).value;/*开始列*/
var endCol=document.getElementById(&quot;endCol&quot;).value;/*结束列*/

    var tempCol=beginRow+&quot;/&quot;+beginCol;/*定位要改变属性的列*/
alert(tempCol);
var td=document.getElementById(tempCol);

/*删除要合并的单元格*/
for(var x=beginRow;x&lt;=endRow;x++){
   for(var i=beginCol;i&lt;=endCol;i++){
    if(x==beginRow){
     
    document.getElementById(&quot;table&quot;).rows[x].deleteCell(i+1);
   
    }
    else{
    
       document.getElementById(&quot;table&quot;).rows[x].deleteCell(i);
    
    }
   
   }
}
td.rowSpan=(endRow-beginRow)+1;
}
/*添加行，使用appendChild方法*/
function addRow(){
   var length=document.getElementById(&quot;table&quot;).rows.length;
   /*document.getElementById(&quot;newbody&quot;).insertRow(length);
   document.getElementById(length+1).setAttribute(&quot;id&quot;,length+2);*/
   var tr=document.createElement(&quot;tr&quot;);
   tr.id=length+1;
   var td=document.createElement(&quot;td&quot;);
   for(i=1;i&lt;4;i++){
   td.id=tr.id+&quot;/&quot;+i;
td.appendChild(document.createTextNode(&quot;第&quot;+td.id+&quot;列&quot;));
tr.appendChild(td);
   
   }
document.getElementById(&quot;newbody&quot;).appendChild(tr); 
} 

function addRow_withInsert(){
   var row=document.getElementById(&quot;table&quot;).insertRow(document.getElementById(&quot;table&quot;).rows.length);
var rowCount=document.getElementById(&quot;table&quot;).rows.length;

var countCell=document.getElementById(&quot;table&quot;).rows.item(0).cells.length;
    for(var i=0;i&lt;countCell;i++){
   var cell=row.insertCell(i);

   cell.innerHTML=&quot;新&quot;+(rowCount)+&quot;/&quot;+(i+1)+&quot;列&quot;;
   cell.id=(rowCount)+&quot;/&quot;+(i+1);
   
   }
}

/*删除行，采用deleteRow(row Index)*/
function removeRow(){
/* var row=document.getElementById(&quot;2&quot;); 
   var index=row.rowIndex;
   alert(index);*/
   document.getElementById(&quot;newbody&quot;).deleteRow(document.getElementById(document.getElementById(&quot;table&quot;).rows.length).rowIndex); 
}

/*添加列，采用insertCell(列位置)方法*/
function addCell(){
/*document.getElementById(&quot;table&quot;).rows.item(0).cells.length
用来获得表格的列数
*/
    for(var i=0;i&lt;document.getElementById(&quot;table&quot;).rows.length;i++){
   var cell=document.getElementById(&quot;table&quot;).rows[i].insertCell(2);
   cell.innerHTML=&quot;第&quot;+(i+1)+&quot;/&quot;+3+&quot;列&quot;;
  
}
}
/*删除列，采用deleteCell(列位置)的方法*/
function removeCell(){
for(var i=0;i&lt;document.getElementById(&quot;table&quot;).rows.length;i++){
   document.getElementById(&quot;table&quot;).rows[i].deleteCell(0);
}
}
&lt;/script&gt;
&lt;/head&gt;

&lt;body onLoad=&quot;init();&quot;&gt;

&lt;table id=&quot;table&quot; align=&quot;center&quot;&gt; 
     &lt;tbody id=&quot;newbody&quot;&gt;&lt;/tbody&gt; 

&lt;/table&gt; 
&lt;div&gt;
   &lt;table width=&quot;800px&quot; border=&quot;1px&quot; align=&quot;center&quot;&gt;
   &lt;tr&gt;&lt;td align=&quot;center&quot;&gt;&lt;input type=&quot;button&quot; id=&quot;addRow&quot; name=&quot;addRow&quot; onClick=&quot;addRow();&quot; value=&quot;添加行&quot;/&gt;&lt;/td&gt;&lt;td align=&quot;center&quot;&gt;&lt;input type=&quot;button&quot; id=&quot;delRow&quot; name=&quot;delRow&quot; onClick=&quot;removeRow();&quot; value=&quot;删除行&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;
　　&lt;tr&gt;&lt;td align=&quot;center&quot;&gt;&lt;input type=&quot;button&quot; id=&quot;delCell&quot;　name=&quot;delCell&quot; onClick=&quot;removeCell();&quot; value=&quot;删除列&quot;/&gt;&lt;/td&gt;&lt;td align=&quot;center&quot;&gt;&lt;input type=&quot;button&quot;　id=&quot;addCell&quot; name=&quot;addCell&quot; onClick=&quot; addCell();&quot; value=&quot;添加列&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;
　&lt;tr&gt;&lt;td align=&quot;center&quot; colspan=&quot;2&quot;&gt;&lt;input type=&quot;button&quot; id=&quot;addRows&quot;　name=&quot;addRows&quot; onClick=&quot;addRow_withInsert();&quot; value=&quot;添加行&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div&gt;
   &lt;table width=&quot;800px&quot; border=&quot;1px&quot; align=&quot;center&quot;&gt;
   &lt;tr&gt;&lt;td&gt;从第&lt;input type=&quot;text&quot; id=&quot;beginRow&quot; name=&quot;beginRow&quot; value=&quot;&quot;/&gt;行到&lt;input type=&quot;text&quot; name=&quot;endRow&quot; id=&quot;endRow&quot; value=&quot;&quot;/&gt;行&lt;/td&gt;&lt;td rowspan=&quot;2&quot; id=&quot;test&quot;&gt;&lt;input type=&quot;button&quot; name=&quot;hebing&quot; id=&quot;hebing&quot; value=&quot;合并&quot; onClick=&quot;rebulid();&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;
　　&lt;tr&gt;&lt;td&gt;从第&lt;input type=&quot;text&quot; name=&quot;beginCol&quot; id=&quot;beginCol&quot; value=&quot;&quot;/&gt;列到&lt;input type=&quot;text&quot; name=&quot;endCol&quot; id=&quot;endCol&quot; value=&quot;&quot;/&gt;列&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;

</pre>
<p>第二种：</p>
<pre class="html" name="code">&lt;html&gt;
&lt;head&gt;&lt;title&gt;aa&lt;/title&gt;
&lt;script src=&quot;jquery.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
var abc={'class': 'newDivClass', id: 'newDiv', name: 'newDivName'};
alert(abc[&quot;class&quot;]);
function aaa()//传统的方式来动态添加一个DIV
{
 var newElement = document.createElement('div'); 
     var newText = document.createTextNode('这是新建立 div 中的文字。'); 
     document.getElementById(&quot;mydiv&quot;).appendChild(newElement); //漏了这一句，否则行不通 
     newElement.id = 'newDiv'; 
     newElement.className = 'newDivClass'; 
     newElement.setAttribute('name ','newDivName'); 
     newElement.style.width = '300px'; 
     newElement.style.height = '200px'; 
     newElement.style.margin = '0 auto'; 
     newElement.style.border = '1px solid #DDD'; 
     newElement.appendChild(newText); 
} 
//$(function(){alert(&quot;asdf&quot;);});
var i=0;
function clickme()//动态添加TABLE内容
{
 i++;
 var tbl=document.getElementById(&quot;tb&quot;);
 var row=tbl.insertRow(tbl.rows.length);
 
 var cell1=row.insertCell(row.cells.length);
 var cell2=row.insertCell(row.cells.length);
 var cell3=row.insertCell(row.cells.length);
 var cell4=row.insertCell(row.cells.length);
 cell1.innerHTML=&quot;a&quot;+i;
 cell2.innerHTML=&quot;b&quot;+i;
 cell3.innerHTML=&quot;c&quot;+i;
 cell4.innerHTML=&quot;&lt;a href='javascript:deleteRow(&quot;+(tbl.rows.length-1)+&quot;)'&gt;delete&lt;/a&gt;&quot;;
 
 cell1.setAttribute(&quot;width&quot;,&quot;150px&quot;);
 cell2.setAttribute(&quot;width&quot;,&quot;150px&quot;);
 cell3.setAttribute(&quot;width&quot;,&quot;150px&quot;);
 cell4.setAttribute(&quot;width&quot;,&quot;150px&quot;);
 //row.style.setAttribute(&quot;backgroundColor&quot;,&quot;#e0e0e0&quot;);
 row.style[&quot;backgroundColor&quot;]=&quot;#e0e0e0&quot;; //第二种设置样式的方法
 tbl.style.setAttribute(&quot;backgroundColor&quot;,&quot;olive&quot;);  
 tbl.setAttribute(&quot;width&quot;,&quot;500px&quot;);  
 //alert(row.style[&quot;backgroundColor&quot;]);
}
function leo()//重定下标
{
 var tbl=document.getElementById(&quot;tb&quot;);
 for(var k=0;k&lt;tbl.rows.length;k++)
 {
  tbl.rows[k].cells[3].innerHTML=&quot;&lt;a href='javascript:deleteRow(&quot;+k+&quot;)'&gt;delete&lt;/a&gt;&quot;;
 }
}
function deleteRow(obj)//删除指定的行
{
 var tbl=document.getElementById(&quot;tb&quot;);
 tbl.deleteRow(obj);
 leo();
} 

function clickme2()//用古老的方式向层里添加内容
{
 var my=document.getElementById(&quot;mydiv&quot;);
 //alert(my);
 my.innerHTML=$(&quot;#mydiv&quot;).html()+&quot;&lt;div style='border-bottom:1px solid purple'&gt;zhaosheng&lt;/div&gt;&quot;;
 //my.appendChild(&quot;&lt;div style='border:1px solid purple'&gt;zhaosheng&lt;/div&gt;&quot;);
}
var k=0;
function createSelect()//为SELECT、动态添加项
{ 
 document.getElementById(&quot;sel&quot;).options[document.getElementById(&quot;sel&quot;).options.length] = new Option(&quot;optionName&quot;+k,&quot;optionValue&quot;+k);
 k++;
}
function change(obj)//select change function
{
 alert(obj.value);
}

function common(type,attr,style,html)
{
 var element=document.createElement(type);
 document.body.appendChild(element);
 for(var k in attr)
 {
  element.setAttribute(k,attr[k]);
 }
 for(var k in style)
 {
  element.style[k]=style[k]; 
 }
 element.appendChild(document.createTextNode(html)); 
}
function commontest()
{
 var attr={&quot;name&quot;:&quot;myname&quot;,&quot;id&quot;:&quot;myid&quot;};
 var style={&quot;width&quot;:&quot;500px&quot;,&quot;height&quot;:&quot;400px&quot;,&quot;border&quot;:&quot;1px solid purple&quot;};
 var html=&quot;this is my text&quot;;
 common(&quot;div&quot;,attr,style,html);
}

&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;a href=&quot;javascript:commontest();&quot;&gt;commontest&lt;/a&gt;
&lt;a href=&quot;javascript:aaa();&quot;&gt;aaa&lt;/a&gt;
&lt;a href=&quot;javascript:clickme();&quot;&gt;clickme&lt;/a&gt;
&lt;table id=&quot;tb&quot;&gt;
 &lt;tr&gt;
  &lt;td&gt;id&lt;/td&gt;
  &lt;td&gt;name&lt;/td&gt;
  &lt;td&gt;age&lt;/td&gt;
  &lt;td&gt;operate&lt;/td&gt;
 &lt;/tr&gt;
&lt;/table&gt;
&lt;a href=&quot;javascript:clickme2();&quot;&gt;clickme2&lt;/a&gt;
&lt;div style=&quot;border:1px solid olive;padding:5px 0px 10px 3px&quot; id=&quot;mydiv&quot;&gt;&lt;/div&gt;
&lt;a href=&quot;javascript:createSelect();&quot;&gt;createSelect&lt;/a&gt;
&lt;select  id=&quot;sel&quot; onchange=&quot;javascript:change(this);&quot;&gt;
&lt;/select&gt;
&lt;/body&gt;

&lt;/html&gt;
</pre>
<p>第三种：</p>
<pre class="html" name="code">&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;product_list.aspx.cs&quot; Inherits=&quot;LanChuang.MemWeb.scm.member.center.Product&quot; %&gt;

&lt;html&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;&lt;/title&gt;
    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=gb2312&quot; /&gt;
    &lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;
        &lt;!--

        function insertTable() {
          
                var table = document.all['ListTable'];
               
				//写入行
				var objRow = table.insertRow();
				objRow.height = 22;
				objRow.bgColor = &quot;#ffffff&quot;;
				objRow.align = 'center';

				objRow.onmousedown = function() { GetRow(this); };
				//序号
				var objCel = objRow.insertCell(0);
				objCel.align = 'center';
				objCel.innerHTML = 1;
				objCel.style.setAttribute(&quot;border-bottom&quot;,&quot;#000000 2px solid&quot;);
				objCel.style.setAttribute(&quot;border-right&quot;,&quot;#000000 2px solid&quot;);

				//商品编码
				var objCel = objRow.insertCell(1);
				objCel.align = 'center';
				objCel.innerHTML = &quot;&lt;input type='hidden' name='ProdId' id='ProdId_1'  value='1'/&gt;SP00000781&quot;;

				//商品名称
				var objCel = objRow.insertCell(2);
				objCel.align = 'left';
				objCel.innerHTML = &quot;矿区水&quot;;

				//单位
				var objCel = objRow.insertCell(3);
				objCel.align = 'center';
				objCel.innerHTML = &quot;瓶&quot;;

				//数量
				var objCel = objRow.insertCell(4);
				objCel.align = 'right';
				objCel.innerHTML = &quot;&lt;input name='proNum'  maxlength='12' id='proNum_1' type='text' size='8' class='input2' value='1.00'  isNull='false' dataType='number' onblur='calculateNumber(this)'/&gt;&quot;;

				//库存
				var objCel = objRow.insertCell(5);
				objCel.align = 'right';
				objCel.innerHTML = &quot;100&quot;;
        }
		 function GetRow(src) {
            
           alert(src.rowIndex);
        }
        //--&gt;
        &lt;/script&gt;
&lt;/head&gt;
&lt;body id=&quot;body&quot;&gt;
    &lt;table bordercolor=&quot;#000000&quot; id=&quot;ListTable&quot;  width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; style=&quot;border-right: #000000 1px solid;border-top: #000000 2px solid; border-left: #000000 2px solid; border-bottom: #000000 1px solid&quot;&gt;
		&lt;tr&gt;
			&lt;td align=&quot;center&quot; style=&quot;border-right: #000000 1px solid; border-bottom: #000000 1px solid;&quot; width=&quot;30&quot;&gt;NO&lt;/td&gt;
			&lt;td align=&quot;center&quot; style=&quot;border-right: #000000 1px solid; border-bottom: #000000 1px solid;&quot; width=&quot;100&quot;&gt;商品编码&lt;/td&gt;
			&lt;td align=&quot;center&quot; style=&quot;border-right: #000000 1px solid; border-bottom: #000000 1px solid;&quot;&gt;商品名称&lt;/td&gt;
			&lt;td align=&quot;center&quot; style=&quot;border-right: #000000 1px solid; border-bottom: #000000 1px solid;&quot; width=&quot;100&quot;&gt;单位&lt;/td&gt;
			&lt;td align=&quot;center&quot; style=&quot;border-right: #000000 1px solid; border-bottom: #000000 1px solid;&quot; width=&quot;100&quot;&gt;数量&lt;/td&gt;
			&lt;td align=&quot;center&quot; style=&quot;border-right: #000000 1px solid; border-bottom: #000000 1px solid;&quot; width=&quot;120&quot;&gt;库存&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
	&lt;input type=&quot;button&quot; onclick=&quot;insertTable()&quot; value=&quot;添加&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
<p><br>
<br>
<br>
&nbsp;</p>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/6/25 15:50:35 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7689870">原文链接</a>
            </div>
            <div>
            阅读：1195 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7689870#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[转]软件公司如何接项目]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7673227</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7673227</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/6/18 14:35:36</pubDate>
        <description><![CDATA[
            
<table border="0" cellspacing="0" cellpadding="0" width="520" align="center">
<tbody>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
软件项目的承接是软件企业一种重要的盈利方式，甚至对于很多软件企业来说，项目承接就是他们唯一的盈利手段，所以对于很多软件企业来讲，项目承接的成败，就是企业运营的成败。</td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
　　但无论对于哪类软件企业来讲，项目的承接都不是轻而易举的事情，并且不同的类型，不同特点的软件企业在项目承接上有着巨大的差异，在软件项目承接上的水平，往往就是软件企业经营水平的最直观、最真实的反映。俗话说知己知彼，我们认为，在软件项目承接上最基本的一点，就是对自身企业技术优势，对当前市场状况分析、对目标客户项目意向的理解。在这些条件都满足的情况下，项目承接的成败，就在于自身业务水平的境界了。</td>
</tr>
<tr>
<td height="10" style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
&nbsp;<wbr><wbr></td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px; font-weight:900">
　　项目承接的难点何在？</td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
　　做过项目的人都知道，软件项目的承接确实是一件难事，接一个一万多的项目难度远高于卖出一个一万多的产品，它的难度在于存在太多的不稳定因素，具有太多的特殊情况，要做好一个软件项目，是过五关斩六将的事情，要经得住重重考验，才能最终成功。</td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
　　①、摆脱竞争对手</td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
　　软件行业竞争激烈，往往有人问起一个软件公司，他们的竞争对手是谁，大概少有哪个公司能够回答得出来，因为对手实在太多太多，并且更新换代也太快，好象昨天才说起哪个公司&#20284;乎做得不错，明天一找原来那个公司已经不存在了，所以在软件项目的承接上，没有确切的办法去知道竞争对手是谁，其实往聪明一点的方向想，我们根本不屑于去知道对手是谁，放下多余的思想包袱，才能发挥出自己最好的水平。所以说，摆脱竞争对手，是从思想上摆脱，其实竞争对手很多，但其实最可怕最致命的竞争对手：是自己本身。</td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
　　②、把客户需求跟公司技术连接起来</td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
　　作为一个合&#26684;的项目经理，一定要对自己公司的技术有所了解，对市场的行情有所了解，有了正确的定位，才能对客户的需求作出准确的评估，在项目谈判的过程中，就应该对客户的需求作出调整和引导，尽量让其能跟公司现有的技术力量结合起来。其实客户对于项目的需求并不一定十分有把握，他们都有着共同的愿望就是更轻松更方便地管理好企业，但他们并不会有太多的软件开发经验，不会太清楚如何通过软件技术来实现自己的管理想法，作为项目经理要凭借自己的项目经验为客户提供解决方案。</td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
　　③、给出合理的报价</td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
　　一个合理的报价虽然只是个简单的数字，但它是多么的来之不易，它是多少的磨练，多少的教训，才得出来的一个正确的认识。在当前中国的市场氛围下，贪便宜已经是所有消费者的定向思维了，然而来到了软件市场，白菜价的产品和项目，已经给中国许多的企业上了沉痛的一课，多少客户为了节约成本，千方百计地找到价&#26684;便宜的软件商进行开发，而前赴后继的廉价软件商报出“不可思议”的价&#26684;满足客户的意愿，结果到头来双方都受到了沉重的伤害，对于客户来说，花了几个月跟软件商讨价还价谈功能，到头来得到的却是一个完全不管用的东西，花了时间赔了钱；对于软件商来说，费尽心思用低价&#26684;赶走了竞争对手，却迎了一个挑三拣四的吝啬客户，费尽周折到头来还是杯水车薪，没法满足客户的意思，浪费了几个月的时间，亏掉多少人力成本，最后一无所获。</td>
</tr>
<tr>
<td height="10" style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
&nbsp;<wbr><wbr></td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px; font-weight:900">
　　对客户和项目作归类、定位</td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
　　任何一个成功的项目都是从意向交谈开始，从跟客户的交谈中尽量地了解出客户的准确意思，思考客户想要的是如何的一个产品，复杂的程度多大，客户的要求有多高，客户的性&#26684;如何，接受力的范围等等，这些因素对于软件项目的报价都是密切相关的。如果客户要的是一个小型的软件系统，不太苛求有多全面的功能，只要满足某一方面的需要，并且客户又是一个随和好说话的人，项目可以报一个成本附近的价&#26684;；相反如果客户要求的是一个面面俱到的管理系统，需要有各方面的功能，缺一不可，并且客户又是那种严&#26684;苛刻，绝不变通的人，软件项目的报价就要充分考虑多种不稳定的因素，报一个面面俱到的价&#26684;。</td>
</tr>
<tr>
<td height="10" style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
&nbsp;<wbr><wbr></td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px; font-weight:900">
　　准确的分析，灵活的应变</td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
　　在很多的情况下，客户是拿着一笔预算的费用来跟软件商谈项目的，如果要投入的费用超过了客户的预算范围，客户将不再考虑做该项目，或找其它软件商商谈，所以项目经理跟客户谈项目的过程中要快速地思考客户需求的真正意思，能够通过某种转换和变通，转化成自己公司技术力量可以接受的范围，在与客户的对话当中，灵活的应变是成功的关键之一。当然并不是所有的客户都可以通过变通而满足，遇到客户并不认同项目费用的情况一定要处之泰然，真诚地为客户解释，就算客户说要考虑其它软件商的产品，也要有良好的态度，要为客户提供有帮助的建议，因为很可能客户在其它地方要找不到能够符合自己意思的产品，跑了一圈到头来，客户会想起为他提供帮助最多服务态度最好的一家。</td>
</tr>
<tr>
<td height="10" style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
&nbsp;<wbr><wbr></td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px; font-weight:900">
　　项目过程中的心理辅导</td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
　　如果项目能够成功接下来，那往下的事情就是项目开发与实施的过程了，软件项目的开发一般是较为长久的，而客户等待的耐性，绝对要比开发的时间短上很多，但软件的开发有必不可少的过程，无论技术部怎么加班，总不可能赶得上客户的期望&#20540;，所以在这个漫长的开发过程中，项目经理要适当地与客户保持一种联系和沟通，让客户感觉到，是一直有人在为他做东西，就算跟客户的这些交流对项目的实际进展没有实质性的帮助，但这是一种必要的心理辅导，就象我们进入餐厅点菜，谁都希望点完后菜能马上上来，但实际上这是并不可能的事情，然而服务周到的餐厅会为客人提供一些打发时间的服务，例如帮每位客人整理好餐具，倒上茶，问问客人要什么饮料，倒完饮料后，又送上热毛巾给客人擦手等等。</td>
</tr>
<tr>
<td height="10" style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
&nbsp;<wbr><wbr></td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px; font-weight:900">
　　项目完成后的收获总结</td>
</tr>
<tr>
<td style="line-height:24px; font-family:Arial,Helvetica,sans-serif; color:rgb(51,51,51); font-size:12px">
　　每个项目完成后，都需要对项目过程中的收获进行总结，吸收业务经验和技术经验，并从项目产品的身上提炼出有价&#20540;的功能，有价&#20540;的管理思想，为以后的软件项目承接和以后管理产品的开发作积累。</td>
</tr>
</tbody>
</table>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/6/18 14:35:36 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7673227">原文链接</a>
            </div>
            <div>
            阅读：1875 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7673227#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[原]SSRS里面的if else表达式 和决策函数]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7663553</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7663553</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/6/14 16:22:34</pubDate>
        <description><![CDATA[
            
<div class="subsection">
<ul>
<li>
<p><span id="mt74" class="sentence"><span><span class="input">Iif</span></span> 函数可根据表达式的计算结果（True 或 False）返回两个&#20540;中的一个。</span><span id="mt75" class="sentence">下面的表达式使用
<span><span class="input">Iif</span></span> 函数在<span class="code">LineTotal</span> 的&#20540;超过 100 时返回布尔&#20540;
<span><span class="input">True</span></span>。</span><span id="mt76" class="sentence">否则，它将返回
<span><span class="input">False</span></span>：</span></p>
<div class="codeSnippetContainer">
<div class="codeSnippetContainerTabs"></div>
<div class="codeSnippetContainerCodeContainer">
<div class="codeSnippetToolBar">
<div class="codeSnippetToolBarText"><pre class="csharp" name="code">=IIF(Fields!LineTotal.Value &gt; 100, True, False)
</pre><br>
</div>
</div>
</div>
</div>
</li><li>
<p><span id="mt77" class="sentence">使用多个 <span><span class="input">IIF</span></span> 函数（也称为“嵌套 IIF”）可以根据<span class="code">PctComplete</span> 的&#20540;返回三个&#20540;中的一个。</span>
<span id="mt78" class="sentence">下面的表达式可放置在文本框的填充颜色中，从而根据文本框中的&#20540;更改背景色。</span> </p>
<div class="codeSnippetContainer">
<div class="codeSnippetContainerTabs"></div>
<div class="codeSnippetContainerCodeContainer">
<div class="codeSnippetToolBar">
<div class="codeSnippetToolBarText"><pre class="csharp" name="code">=IIF(Fields!PctComplete.Value &gt;= 10, &quot;Green&quot;, IIF(Fields!PctComplete.Value &gt;= 1, &quot;Blue&quot;, &quot;Red&quot;))
</pre><br>
</div>
</div>
</div>
</div>
<p><span id="mt79" class="sentence">&#20540;大于或等于 10 时，显示绿色背景；介于 1 和 9 之间时，显示蓝色背景；小于 1 时，显示红色背景。</span></p>
</li><li>
<p><span id="mt80" class="sentence">还有另一种方法可以实现相同功能，即使用 <span><span class="input">Switch</span></span> 函数。</span><span id="mt81" class="sentence">如果您要测试三个或更多条件，<span><span class="input">Switch</span></span> 函数将非常有用。</span><span id="mt82" class="sentence"><span><span class="input">Switch</span></span>
 函数可返回与序列中计算结果为 True 的第一个表达式相关联的&#20540;：</span></p>
<div class="codeSnippetContainer">
<div class="codeSnippetContainerTabs"></div>
<div class="codeSnippetContainerCodeContainer">
<div class="codeSnippetToolBar">
<div class="codeSnippetToolBarText"><pre class="csharp" name="code">=Switch(Fields!PctComplete.Value &gt;= 10, &quot;Green&quot;, Fields!PctComplete.Value &gt;= 1, &quot;Blue&quot;, Fields!PctComplete.Value = 1, &quot;Yellow&quot;, Fields!PctComplete.Value &lt;= 0, &quot;Red&quot;,)
</pre><br>
</div>
</div>
</div>
</div>
<p><span id="mt83" class="sentence">&#20540;大于或等于 10 时，显示绿色背景；介于 1 和 9 之间时，显示蓝色背景；等于 1 时显示黄色背景；小于或等于 0 时，显示红色背景。</span></p>
</li><li>
<p><span id="mt84" class="sentence">测试 <span class="code">ImportantDate</span> 字段的&#20540;，如果该&#20540;大于一周，则返回“Red”；否则返回“Blue”。</span><span id="mt85" class="sentence">此表达式可用于控制报表项中的文本框的 Color 属性：</span>
</p>
<div class="codeSnippetContainer">
<div class="codeSnippetContainerTabs"></div>
<div class="codeSnippetContainerCodeContainer">
<div class="codeSnippetToolBar"><span id="mt86" class="sentence"></span><pre class="csharp" name="code">=IIF(DateDiff(&quot;d&quot;,Fields!ImportantDate.Value, Now())&gt;7,&quot;Red&quot;,&quot;Blue&quot;)

</pre><br>
</div>
</div>
</div>
</li><li>
<div class="codeSnippetContainer">
<div class="codeSnippetContainerCodeContainer">
<div class="codeSnippetToolBar"><span class="sentence">测试 <span class="code">PhoneNumber</span> 字段的&#20540;，如果为<span><span class="input">null</span></span>（在 Visual Basic 中为
<span><span class="input">Nothing</span></span>），则返回“无&#20540;”；否则返回电话号码&#20540;。</span><span id="mt87" class="sentence">此表达式可用于控制报表项中的文本框的&#20540;。</span>
</div>
</div>
</div>
</li><li>
<div class="codeSnippetContainer">
<div class="codeSnippetContainerCodeContainer">
<div class="codeSnippetToolBar"><pre class="csharp" name="code">=IIF(Fields!PhoneNumber.Value Is Nothing,&quot;No Value&quot;,Fields!PhoneNumber.Value)
</pre><br>
</div>
</div>
</div>
</li><li>
<p><span id="mt88" class="sentence">测试 <span class="code">Department</span> 字段的&#20540;，然后返回子报表名称或<span><span class="input">null</span></span>（在 Visual Basic 中为
<span><span class="input">Nothing</span></span>）。</span><span id="mt89" class="sentence">此表达式可用于条件性钻取子报表。</span>
</p>
<div class="codeSnippetContainer">
<div class="codeSnippetContainerTabs"></div>
<div class="codeSnippetContainerCodeContainer">
<div class="codeSnippetToolBar">
<div class="codeSnippetToolBarText"><pre class="csharp" name="code">=IIF(Fields!Department.Value = &quot;Development&quot;, &quot;EmployeeReport&quot;, Nothing)
</pre><br>
</div>
</div>
</div>
</div>
</li><li>
<p><span id="mt90" class="sentence">测试字段&#20540;是否为空。</span> <span id="mt91" class="sentence">
此表达式可用于控制图像报表项的 <span><span class="input">Hidden</span></span> 属性。</span> <span id="mt92" class="sentence">
在下面的示例中，字段 [LargePhoto] 指定的图像仅当字段&#20540;非空时才会显示。</span> </p>
<div class="codeSnippetContainer">
<div class="codeSnippetContainerTabs"></div>
<div class="codeSnippetContainerCodeContainer">
<div class="codeSnippetToolBar">
<div class="codeSnippetToolBarText"><pre class="csharp" name="code">=IIF(IsNothing(Fields!LargePhoto.Value),True,False)
</pre><br>
</div>
</div>
</div>
</div>
</li></ul>
</div>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/6/14 16:22:34 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7663553">原文链接</a>
            </div>
            <div>
            阅读：1092 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7663553#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[转]Reporting Services 在WIN7和2008下出现“授予的权限不足，无法执行此操作。 (rsAccessDenied)”的解决办]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7663523</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7663523</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/6/14 16:15:41</pubDate>
        <description><![CDATA[
            
<p>最近刚刚接触Sql server的Reporting Services，使用它做报表。做好之后在浏览器下浏览时出现了一个错误：“为用户“Caishy-PC\Caishy”授予的权限不足，无法执行此操作。 (rsAccessDenied)”。</p>
<p>在谷歌上搜索此问题的解决办法，发现都是说要在IIS下设置ReportServer应用程序允许匿名访问，但是神奇的事情发生了，在我的IIS里根本就没有ReportServer应用，难道是我安装服务时出现了错误？但明明上述的错误像是RS回应的，若沒有Reports Web Application，看到的应是HTTP 404而不是上述错误。</p>
<p>原来，SSRS 2008已经不再IIS了，详见<a href="http://www.dotblogs.com.tw/angi/archive/2008/10/31/5833.aspx">http://www.dotblogs.com.tw/angi/archive/2008/10/31/5833.aspx</a>。</p>
<p>由于我的操作系统是win7开启了UAC，看來都是权限惹的祸，使用Admin身份打开浏览器，再一刷新，哈哈问题解决了…</p>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/6/14 16:15:41 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7663523">原文链接</a>
            </div>
            <div>
            阅读：4070 评论：1 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7663523#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[转]WPF、WCF、WF打造Hello World程序]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7600844</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7600844</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/5/25 10:15:05</pubDate>
        <description><![CDATA[
            
<div id="cnblogs_post_body">
<div class="clear"></div>
<div class="postBody">
<div id="cnblogs_post_body">
<h1 class="postTitle"><a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/jiekk/archive/2011/02/22/1961810.html"><span style="font-size:24px">WCF,WPF,WF是什么东西</span></a></h1>
<div class="clear"></div>
<div class="postBody">
<div id="cnblogs_post_body">
<p><span style="font-size:16px">WPF的全称是Windows Presentation Foundation，是微软新发布的Vista操作系统的三大核心开发库之一，其主要负责的是图形显示，所以叫Presentation（呈现）。<br>
<br>
作为新的图形引擎，WPF是基于DirectX的，当然增加了很多新的功能。其2D和3D引擎的强大看看Vista的界面就明白了，再加上其对Aero图形引擎的支持，更加让你刚到神奇。顺便提一下，Aero是专门为3D桌面开发的引擎，可以让桌面实现神奇的3D翻转，这绝对是操作系统有史以来的一次神奇尝试，虽然对硬件配置的要求也是惊人的，此前已有相关报道称，Vista对显卡十分挑剔就是出于运行Aero的考虑。<br>
<br>
Windows通信基础（Windows Communication Foundation，WCF）是基于Windows平台下开发和部署服务的软件开发包（Software Development Kit，SDK）。WCF为服务提供了运行时环境（Runtime Environment），使得开发者能够将CLR类型公开为服务，又能够以CLR类型的方式使用服务。理论上讲，创建服务并不一定需要WCF，但实际上，使用WCF却可以使得创建服务的任务事半功倍。WCF是微软对一系列产业标准定义的实现，包括服务交互、类型转换、封送（Marshaling）以及各种协议的管理。</span></p>
<p><span style="font-size:16px">Windows Workflow Foundation(WF):工作流引擎，基于工作流的开发使程序的业务逻辑与代码相分离，从而可以大大提高软件开发的效率。<br>
Windows Communication Foundation(WCF): 用于实现应用程序间(包含不同语言开发的程序)通信的技术，WCF构建在SOAP协议之上。<br>
Windows Presentation Foundation(WPF):集成WebForm与WinForm于一体的界面开发方案</span></p>
</div>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size:24px">WPF、WCF、WF打造Hello World程序 </span></p>
</div>
</div>
<p>英文版：<a href="http://www.codeproject.com/KB/WF/wcf-wpf-wf-hello-world.aspx" target="_blank">http://www.codeproject.com/KB/WF/wcf-wpf-wf-hello-world.aspx</a></p>
<p><strong style="font-size:18pt">分析篇：</strong><span style="font-size:18pt">&nbsp;</span></p>
<p>&nbsp;&nbsp; &nbsp;Hello World程序作为所有编程语言的起始阶段，Hello World占据着无法改变的地位。本例子很简单，用了WPF、WCF、WF三种还算比较新的技术。这个例子有三个项目：&nbsp;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; <strong>1、WPFProject：</strong>WPF应用程序</p>
<p>&nbsp;&nbsp;&nbsp; <strong>2、WCFProject：</strong>WCF服务</p>
<p>&nbsp;&nbsp;&nbsp; <strong>3、WFProject：</strong>WF流程定义</p>
<p>&nbsp;&nbsp;&nbsp; 执行顺序是WPFProject程序去启动WFProject项目的工作流，WFProject项目去调用WCFProject的WCF服务。接着WCFProject服务将'Hello World'这行编程界最经典的话返回给WFProject，WFProject由将将'Hello World'返回给WPFProject的UI。执行顺序如下图：</p>
<p><img alt="" src="http://my.csdn.net/uploads/201205/25/1337911765_3687.png"></p>
<p><strong style="font-size:18pt">实现篇：</strong></p>
<p>&nbsp;&nbsp;&nbsp; 新建一个WpfApplication、一个ConsoleApplication、一个workflow的ActivityLibrary，共三个项目，命名分别为：WPFProject、WCFProject、WFProject，解决方案如下图：</p>
<p>&nbsp;</p>
<p>&nbsp;<img alt="" src="http://my.csdn.net/uploads/201205/25/1337911773_2077.png"></p>
<p>&nbsp;&nbsp;&nbsp; 我们就在这些由VS模板生成的代码实现这个Hello world程序，我们尽量地利用这些生成好的代码。</p>
<p><strong>最不熟悉WCF：</strong></p>
<p>&nbsp;&nbsp;&nbsp; 引用System.ServiceModel.dll</p>
<p>&nbsp;&nbsp;&nbsp; 添加接口IService1：</p>
<div class="cnblogs_code">
<div><pre class="csharp" name="code">   [ServiceContract]
     public interface IService1
     {
        [OperationContract]
        string GetData();
     }</pre>&nbsp;&nbsp; 添加类Service1：<br>
<pre class="csharp" name="code">Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--&gt;1     public class Service1 : IService1
     {
         public string GetData()
         {
             return string.Format(&quot;Hello World&quot;);
         }
     }</pre><br>
<p>&nbsp;&nbsp;&nbsp; App.config配置：</p>
<pre class="csharp" name="code">Code highlighting produced by Actipro CodeHighlighter (freeware)http://www.CodeHighlighter.com/--&gt; 1 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
 &lt;configuration&gt;
     &lt;system.serviceModel&gt;
         &lt;services&gt;
             &lt;service name=&quot;WCFProject.Service1&quot; behaviorConfiguration=&quot;metadata&quot;&gt;
                 &lt;host&gt;
                     &lt;baseAddresses&gt;
                         &lt;add baseAddress=&quot;http://localhost:8001/Service1&quot;/&gt;
                     &lt;/baseAddresses&gt;
                 &lt;/host&gt;
                 &lt;!--The BasicHttpBinding is used because the Workflow uses a generated ASP.Net proxy to communicate with this service--&gt;
                 &lt;endpoint binding=&quot;basicHttpBinding&quot; contract=&quot;WCFProject.IService1&quot;/&gt;
             &lt;/service&gt;
         &lt;/services&gt;
         &lt;behaviors&gt;
             &lt;serviceBehaviors&gt;
                 &lt;behavior name=&quot;metadata&quot;&gt;
                     &lt;!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment --&gt;
                     &lt;serviceMetadata httpGetEnabled=&quot;true&quot;/&gt;
                     &lt;!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information --&gt;
                     &lt;serviceDebug includeExceptionDetailInFaults=&quot;false&quot;/&gt;
                 &lt;/behavior&gt;
             &lt;/serviceBehaviors&gt;
         &lt;/behaviors&gt;
         &lt;serviceHostingEnvironment multipleSiteBindingsEnabled=&quot;true&quot; /&gt;
     &lt;/system.serviceModel&gt;
 &lt;/configuration&gt;</pre>
<p><br>
&nbsp;</p>
&nbsp;&nbsp; 在Program.cs添加启动WCF服务代码：</div>
<div><pre class="csharp" name="code">Code highlighting produced by Actipro CodeHighlighter (freeware)http://www.CodeHighlighter.com/--&gt;1             using (ServiceHost host = new ServiceHost(typeof(Service1)))
             {
                 host.Open();
                 Console.WriteLine(&quot;The service is ready.&quot;);
                 Console.WriteLine(&quot;Press &lt;ENTER&gt; to terminate service.&quot;);
 
                 Console.ReadLine();
             }</pre></div>
<div>以上实现了一个简单的WCF服务，这样WCFProject就完成了。
<p><strong>最熟悉的WF：</strong></p>
<p>&nbsp;&nbsp;&nbsp; 在Activity1上托一个Sequence，再在Sequence托一个Send活动调用上面定义好的WCF服务。</p>
<p>&nbsp;&nbsp;&nbsp; 添加一个存储返回&#20540;的returnValue输出参数。</p>
<p>&nbsp;&nbsp;&nbsp; Send活动需要知道WCF服务的ABC。故做如下设置。</p>
<p><strong>1、OperateName</strong>：GetData（与上面WCF方法名字一致）</p>
<p><strong>2、EndPoint</strong>设置为EndPoint</p>
<p><strong>3、Bingding</strong>设置为basichttpBingding。</p>
<p><strong>4、EndPointAddress</strong>设置为New Uri(&quot;<span style="color:#0000ff">http://localhost:8001/Service1</span>&quot;)，与在WCFProject的app.config的地址相同</p>
<p><strong>5、ServiceContractName</strong>设置为WCF服务的接口名字IService1。</p>
<p>&nbsp;&nbsp;&nbsp; 右击Send活动，选择Create ReceivReply，这样就创建了一个ReceivReply，它需要设置一个属性：点击Content设置如下：</p>
<p>&nbsp;<img alt="" src="http://img.my.csdn.net/uploads/201205/25/1337911781_9916.png"></p>
<p>最后流程如下图所示：</p>
<p>&nbsp;<img alt="" src="http://img.my.csdn.net/uploads/201205/25/1337911777_9733.png"></p>
<p>这样我们完成了Workflow的项目。</p>
<p><strong>最后的WPF</strong></p>
<p>&nbsp;&nbsp;&nbsp; 由于WPFProject与WFProject是直接引用的关系，故在WPFProject直接引用WFProject的dll，如下图</p>
<p>&nbsp;<img alt="" src="http://img.my.csdn.net/uploads/201205/25/1337911770_3859.png"></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; 由于要启动WF，故还需添加工作流的System.Activities.dll引用。</p>
<p>&nbsp;&nbsp;&nbsp; 在MainWindow窗体中拖一个按钮，将文本改成：“Invoke Workflow”，在click事件中添加下面代码：</p>
<pre class="csharp" name="code">            IDictionary&lt;string, object&gt; results = WorkflowInvoker.Invoke(new Activity1());
            MessageBox.Show(results[&quot;returnValue&quot;].ToString());</pre><pre class="csharp" name="code">&nbsp;</pre>
<p>&nbsp;&nbsp;&nbsp; 这样WPFProject 也完成了。</p>
<p><strong style="font-size:18pt">调试与结果：</strong></p>
<p>&nbsp;&nbsp;&nbsp; 启动WCPProject，如下图：</p>
<p>&nbsp;<img alt="" src="http://img.my.csdn.net/uploads/201205/25/1337911788_6322.png"></p>
<p>&nbsp;&nbsp;&nbsp; 启动WPFProject。点击Invoke Workflow，结果如下图：</p>
<img alt="" src="http://img.my.csdn.net/uploads/201205/25/1337911761_9788.png"></div>
<div>
<p><strong style="font-size:18pt">总结：</strong></p>
<p><strong><span style="font-size:24px">&nbsp;&nbsp;&nbsp; </span></strong>结合了WPF、WCF、WF实现了Hello world程序。</p>
<p><strong>&nbsp;&nbsp;&nbsp;&nbsp; 这篇文章用最简单Hello World程序教你使用了三种最新技术。是不是&#20540;得你推荐一下，谢谢。：）</strong></p>
<p><strong style="font-size:18pt">代码</strong><span style="font-size:18pt">：<a href="http://download.csdn.net/detail/adsdassadfasdfasdf/4328426">点击打开链接</a></span>&nbsp;</p>
<div id="MySignature">
<p>作者：<a href="http://zhuqil.cnblogs.com/" target="_blank"><span style="color:#9f8248">朱祁林</span></a><br>
出处：<a href="http://zhuqil.cnblogs.com/" target="_blank"><span style="color:#9f8248">http://zhuqil.cnblogs.com</span></a><br>
</p>
</div>
</div>
</div>
</div>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/5/25 10:15:05 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7600844">原文链接</a>
            </div>
            <div>
            阅读：1496 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7600844#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[原]整理几个有想法的面试题]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7553028</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7553028</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/5/10 10:40:55</pubDate>
        <description><![CDATA[
            
<div>
<p>bolg地址：<a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7553028">http://blog.csdn.net/adsdassadfasdfasdf/article/details/7553028</a></p>
<p>1.&nbsp;</p>
<p>阶乘，指从<span style="font-family:Calibri">1</span><span style="font-family:宋体">乘以</span><span style="font-family:Calibri">2</span><span style="font-family:宋体">乘以</span><span style="font-family:Calibri">3</span><span style="font-family:宋体">乘以</span><span style="font-family:Calibri">4</span><span style="font-family:宋体">一直乘到所要求的数。</span></p>
<p>例如所要求的数是<span style="font-family:Calibri">4</span><span style="font-family:宋体">，则阶乘式是</span><span style="font-family:Calibri">1</span><span style="font-family:宋体">×</span><span style="font-family:Calibri">2</span><span style="font-family:宋体">×</span><span style="font-family:Calibri">3</span><span style="font-family:宋体">×</span><span style="font-family:Calibri">4</span><span style="font-family:宋体">，得到的积是</span><span style="font-family:Calibri">24</span><span style="font-family:宋体">，</span><span style="font-family:Calibri">24</span><span style="font-family:宋体">就是</span><span style="font-family:Calibri">4</span><span style="font-family:宋体">的阶乘。&nbsp;例如所要求的数是</span><span style="font-family:Calibri">6</span><span style="font-family:宋体">，则阶乘式是</span><span style="font-family:Calibri">1</span><span style="font-family:宋体">×</span><span style="font-family:Calibri">2</span><span style="font-family:宋体">×</span><span style="font-family:Calibri">3</span><span style="font-family:宋体">×……×</span><span style="font-family:Calibri">6</span><span style="font-family:宋体">，得到的积是</span><span style="font-family:Calibri">720</span><span style="font-family:宋体">，</span><span style="font-family:Calibri">720</span><span style="font-family:宋体">就是</span><span style="font-family:Calibri">6</span><span style="font-family:宋体">的阶乘。例如所要求的数是</span><span style="font-family:Calibri">n</span><span style="font-family:宋体">，则阶乘式是</span><span style="font-family:Calibri">1</span><span style="font-family:宋体">×</span><span style="font-family:Calibri">2</span><span style="font-family:宋体">×</span><span style="font-family:Calibri">3</span><span style="font-family:宋体">×……×</span><span style="font-family:Calibri">n</span><span style="font-family:宋体">，设得到的积是</span><span style="font-family:Calibri">x</span><span style="font-family:宋体">，</span><span style="font-family:Calibri">x</span><span style="font-family:宋体">就是</span><span style="font-family:Calibri">n</span><span style="font-family:宋体">的阶乘。</span></p>
<p>任何大于<span style="font-family:Calibri">1</span><span style="font-family:宋体">的自然数</span><span style="font-family:Calibri">n</span><span style="font-family:宋体">阶乘表示方法：</span></p>
<p>n!=1<span style="font-family:宋体">×</span><span style="font-family:Calibri">2</span><span style="font-family:宋体">×</span><span style="font-family:Calibri">3</span><span style="font-family:宋体">×……×</span><span style="font-family:Calibri">n</span><span style="font-family:宋体">　　或　　</span><span style="font-family:Calibri">n!=n</span><span style="font-family:宋体">×</span><span style="font-family:Calibri">(n-1)!&nbsp;</span><span style="font-family:宋体">注：</span><span style="font-family:Calibri">0!=1</span></p>
<p>1）&nbsp;请编写一个函数，能够计算<span style="font-family:Calibri">10</span><span style="font-family:宋体">以内数的阶乘，尽量采用递归算法。（</span>10!=3628800）。</p>
<p><span style="background:rgb(245,245,245)"><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;jiecheng(int&nbsp;n)</span></span></p>
<p><span style="background:rgb(245,245,245)"><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></span><span style="background:rgb(245,245,245)"><br>
</span><span style="background:rgb(245,245,245)"><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(n&nbsp;==&nbsp;1)</span></span><span style="background:rgb(245,245,245)"><br>
</span><span style="background:rgb(245,245,245)"><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;</span></span><span style="background:rgb(245,245,245)"><br>
</span><span style="background:rgb(245,245,245)"><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(n&nbsp;==&nbsp;2)</span></span><span style="background:rgb(245,245,245)"><br>
</span><span style="background:rgb(245,245,245)"><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;2;</span></span><span style="background:rgb(245,245,245)"><br>
</span><span style="background:rgb(245,245,245)"><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span></span><span style="background:rgb(245,245,245)"><br>
</span><span style="background:rgb(245,245,245)"><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;n&nbsp;*&nbsp;jiecheng(n&nbsp;-&nbsp;1);</span></span></p>
<p><span style="background:rgb(245,245,245)"><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></p>
<p>2.&nbsp;请编程实现：</p>
<p><span style="color:#00ff">public</span>&nbsp;<span style="color:#00ff">static</span>&nbsp;<span style="color:#00ff">void</span>&nbsp;main()</p>
<p>{</p>
<p><span style="color:#00ff">int</span>[]&nbsp;a&nbsp;=&nbsp;{&nbsp;1,&nbsp;3,&nbsp;5,&nbsp;7,&nbsp;9&nbsp;};</p>
<p></p>
<p><span style="color:#2b91af">Console</span>.WriteLine(Combine(a));&nbsp;<span style="color:#0800">//<span style="font-family:宋体">期待的结果，输出字符串</span><span style="font-family:Consolas">&quot;1,3,5,7,9&quot;</span></span></p>
<p>}</p>
<p></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;</span><span style="color:#808080">&lt;summary&gt;</span></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;请编程实现此方法。将输入的整型数组，合并转换为逗号分隔的字符串。</span></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;例如输入参数为整型数组<span style="font-family:Consolas">{9</span><span style="font-family:宋体">，</span><span style="font-family:Consolas">7</span><span style="font-family:宋体">，</span><span style="font-family:Consolas">2}</span><span style="font-family:宋体">，那么输出结果为字符串</span><span style="font-family:Consolas">&quot;9,7,2&quot;</span><span style="font-family:宋体">。</span></span></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;</span><span style="color:#808080">&lt;/summary&gt;</span></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;</span><span style="color:#808080">&lt;param&nbsp;name=&quot;data&quot;&gt;&lt;/param&gt;</span></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;</span><span style="color:#808080">&lt;returns&gt;&lt;/returns&gt;</span></p>
<p></p>
<p>请认真考虑输入参数的各种边界情况！</p>
<p><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;string&nbsp;Combine(int[]&nbsp;data)</span></p>
<p><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
<p><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;str&nbsp;=&nbsp;&quot;&quot;;</span></p>
<p><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(int&nbsp;s&nbsp;in&nbsp;data)</span></p>
<p><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
<p><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;&#43;=&nbsp;s.ToString()&nbsp;&#43;&nbsp;&quot;,&quot;;</span></p>
<p><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
<p><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;str;</span></p>
<p><span style="color:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
<p></p>
<p>3.&nbsp;简答题：</p>
<p></p>
<p>A．&nbsp;数据表<span style="font-family:Calibri">T</span><span style="font-family:宋体">用来记录用户登录、注销信息，其中只有</span><span style="font-family:Calibri">4</span><span style="font-family:宋体">个记录：</span></p>
<table align="center" style="width:610px; height:169px">
<tbody>
<tr>
<td valign="center">
<p><span style="color:#000000">user（用户名）</span></p>
</td>
<td valign="center">
<p><span style="color:#000000">operate（操作）</span></p>
</td>
<td valign="center">
<p><span style="color:#000000">time（时间）</span></p>
</td>
</tr>
<tr>
<td valign="center">
<p><span style="color:#000000">LiMing</span></p>
</td>
<td valign="center">
<p><span style="color:#000000">Login</span></p>
</td>
<td valign="center">
<p><span style="color:#000000">2010/10/24&nbsp;8:03</span></p>
</td>
</tr>
<tr>
<td valign="center">
<p><span style="color:#000000">WangYi</span></p>
</td>
<td valign="center">
<p><span style="color:#000000">Login</span></p>
</td>
<td valign="center">
<p><span style="color:#000000">2010/10/24&nbsp;8:14</span></p>
</td>
</tr>
<tr>
<td valign="center">
<p><span style="color:#000000">WangYi</span></p>
</td>
<td valign="center">
<p><span style="color:#000000">Logout</span></p>
</td>
<td valign="center">
<p><span style="color:#000000">2010/10/24&nbsp;16:14</span></p>
</td>
</tr>
<tr>
<td valign="center">
<p><span style="color:#000000">LiMing</span></p>
</td>
<td valign="center">
<p><span style="color:#000000">Logout</span></p>
</td>
<td valign="center">
<p><span style="color:#000000">2010/10/24&nbsp;16:44</span></p>
</td>
</tr>
</tbody>
</table>
<p>请写出一个<span style="font-family:Calibri">SQL</span><span style="font-family:宋体">查询语句，返回用户在线时间情况的结果集：</span></p>
<table align="center" style="width:506px; height:67px">
<tbody>
<tr>
<td valign="center">
<p><span style="color:#000000">LiMing</span></p>
</td>
<td valign="center">
<p><span style="color:#000000">8:13</span></p>
</td>
</tr>
<tr>
<td valign="center">
<p><span style="color:#000000">WangYi</span></p>
</td>
<td valign="center">
<p><span style="color:#000000">8:46</span></p>
</td>
</tr>
</tbody>
</table>
<p></p>
<p><span style="color:#00ff">create</span>&nbsp;<span style="color:#00ff">table</span>&nbsp;<span style="color:#08080">tb</span><span style="color:#00ff">&nbsp;</span><span style="color:#808080">(</span>&nbsp;<span style="color:#08080">[user]</span>&nbsp;<span style="color:#00ff">varchar</span><span style="color:#808080">(</span>20<span style="color:#808080">),</span>&nbsp;<span style="color:#08080">operate</span>&nbsp;<span style="color:#00ff">varchar</span><span style="color:#808080">(</span>20<span style="color:#808080">),</span>&nbsp;<span style="color:#08080">[time]</span>&nbsp;<span style="color:#00ff">datetime</span><span style="color:#808080">)</span>&nbsp;</p>
<p><span style="color:#00ff">insert</span>&nbsp;<span style="color:#00ff">into</span>&nbsp;<span style="color:#08080">tb</span>&nbsp;<span style="color:#00ff">select</span>&nbsp;<span style="color:#ff00">'LiMing'</span><span style="color:#808080">,</span>&nbsp;<span style="color:#ff00">'Login'</span><span style="color:#808080">,</span>&nbsp;<span style="color:#ff00">'2010/10/24&nbsp;8:03'</span>&nbsp;</p>
<p><span style="color:#00ff">union</span>&nbsp;<span style="color:#808080">all</span>&nbsp;</p>
<p><span style="color:#00ff">select</span>&nbsp;<span style="color:#ff00">'WangYi'</span><span style="color:#808080">,</span>&nbsp;<span style="color:#ff00">'Login'</span><span style="color:#808080">,</span>&nbsp;<span style="color:#ff00">'2010/10/24&nbsp;8:14'</span>&nbsp;</p>
<p><span style="color:#00ff">union</span>&nbsp;<span style="color:#808080">all</span>&nbsp;</p>
<p><span style="color:#00ff">select</span>&nbsp;<span style="color:#ff00">'WangYi'</span><span style="color:#808080">,</span>&nbsp;<span style="color:#ff00">'Logout'</span><span style="color:#808080">,</span>&nbsp;<span style="color:#ff00">'2010/10/24&nbsp;16:14'</span>&nbsp;</p>
<p><span style="color:#00ff">union</span>&nbsp;<span style="color:#808080">all</span>&nbsp;</p>
<p><span style="color:#00ff">select</span>&nbsp;<span style="color:#ff00">'LiMing'</span><span style="color:#808080">,</span>&nbsp;<span style="color:#ff00">'Logout'</span><span style="color:#808080">,</span>&nbsp;<span style="color:#ff00">'2010/10/24&nbsp;16:44'</span>&nbsp;</p>
<p></p>
<p><span style="color:#00ff">select</span>&nbsp;<span style="color:#08080">a</span><span style="color:#808080">.</span><span style="color:#08080">[user]</span>&nbsp;<span style="color:#808080">,</span>&nbsp;<span style="color:#ff0ff">cast</span><span style="color:#808080">(</span><span style="color:#ff0ff">DATEdiff</span><span style="color:#808080">(</span><span style="color:#08080">MI</span><span style="color:#808080">,</span>&nbsp;<span style="color:#08080">b</span><span style="color:#808080">.</span><span style="color:#08080">[time]</span>&nbsp;<span style="color:#808080">,</span><span style="color:#08080">a</span><span style="color:#808080">.</span><span style="color:#08080">[time]</span>&nbsp;<span style="color:#808080">)/</span>&nbsp;60&nbsp;<span style="color:#00ff">as</span>&nbsp;<span style="color:#00ff">varchar</span><span style="color:#808080">)</span>&nbsp;<span style="color:#808080">&#43;</span>&nbsp;<span style="color:#ff00">':'</span>&nbsp;<span style="color:#808080">&#43;</span>&nbsp;<span style="color:#ff0ff">cast</span><span style="color:#808080">(</span><span style="color:#ff0ff">DATEdiff</span><span style="color:#808080">(</span><span style="color:#08080">MI</span><span style="color:#808080">,</span>&nbsp;<span style="color:#08080">b</span><span style="color:#808080">.</span><span style="color:#08080">[time]</span>&nbsp;<span style="color:#808080">,</span><span style="color:#08080">a</span><span style="color:#808080">.</span><span style="color:#08080">[time]</span>&nbsp;<span style="color:#808080">)%</span>60&nbsp;<span style="color:#00ff">as</span>&nbsp;<span style="color:#00ff">varchar</span><span style="color:#808080">)</span>&nbsp;<span style="color:#00ff">AS</span>&nbsp;<span style="color:#08080">在线时间</span>&nbsp;</p>
<p><span style="color:#00ff">from&nbsp;</span><span style="color:#808080">(</span>&nbsp;<span style="color:#00ff">select</span>&nbsp;<span style="color:#808080">*</span>&nbsp;<span style="color:#00ff">from</span>&nbsp;<span style="color:#08080">tb</span>&nbsp;<span style="color:#00ff">where</span>&nbsp;<span style="color:#08080">operate</span>&nbsp;<span style="color:#808080">=</span><span style="color:#ff00">'Logout'</span><span style="color:#808080">)</span>&nbsp;<span style="color:#08080">a</span><span style="color:#808080">,</span>&nbsp;</p>
<p><span style="color:#808080">(</span><span style="color:#00ff">select</span>&nbsp;<span style="color:#808080">*</span>&nbsp;<span style="color:#00ff">from</span>&nbsp;<span style="color:#08080">tb</span>&nbsp;<span style="color:#00ff">where</span>&nbsp;<span style="color:#08080">operate</span>&nbsp;<span style="color:#808080">=</span><span style="color:#ff00">'Login'</span><span style="color:#808080">)</span>&nbsp;<span style="color:#08080">b</span>&nbsp;</p>
<p><span style="color:#00ff">where</span>&nbsp;<span style="color:#08080">a</span><span style="color:#808080">.</span><span style="color:#08080">[user]</span>&nbsp;<span style="color:#808080">=</span><span style="color:#08080">b</span><span style="color:#808080">.</span><span style="color:#08080">[user]</span>&nbsp;</p>
<p></p>
<p>4.&nbsp;请编程实现：</p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;</span><span style="color:#808080">&lt;summary&gt;</span></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;</span><span style="color:#0800">UpdateData1<span style="font-family:宋体">和</span><span style="font-family:Consolas">UpdateData2</span><span style="font-family:宋体">是两个含有更新数据库操作方法，</span></span></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;</span><span style="color:#0800">我们希望这两个操作能够在一个事物<span style="font-family:Consolas">(Transaction)</span><span style="font-family:宋体">中</span></span><span style="color:#0800">。</span><span style="color:#0800">如果成功，就全部提交，</span><span style="color:#0800">&nbsp;</span></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;</span><span style="color:#0800">如果失败，就全部回滚。</span></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;</span><span style="color:#0800">请设计<span style="font-family:Consolas">main</span><span style="font-family:宋体">方法中</span></span><span style="color:#0800">调用</span><span style="color:#0800">UpdateData1<span style="font-family:宋体">和</span><span style="font-family:Consolas">UpdateData2</span><span style="font-family:宋体">的写法。</span></span></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;</span><span style="color:#0800">UpdateData1<span style="font-family:宋体">和</span><span style="font-family:Consolas">UpdateData2</span><span style="font-family:宋体">的参数可以自己设计。</span></span></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;</span><span style="color:#0800">另外，请简要回答，&nbsp;</span></p>
<p><span style="color:#808080">///</span><span style="color:#808080">&nbsp;</span><span style="color:#0800">如果<span style="font-family:Consolas">UpdateData1</span><span style="font-family:宋体">和</span><span style="font-family:Consolas">UpdateData2</span><span style="font-family:宋体">需要操作的数据库不是一个数据库怎么处理。</span></span></p>
<p><span style="color:#808080">///</span><span style="color:#0800">&nbsp;</span><span style="color:#808080">&lt;/summary&gt;</span></p>
<p><span style="color:#00ff">public</span>&nbsp;<span style="color:#00ff">static</span>&nbsp;<span style="color:#00ff">void</span>&nbsp;main()</p>
<p>{</p>
<p>……</p>
<p>UpdateData1(…);</p>
<p>UpdateData2(…);</p>
<p>……</p>
<p>}</p>
<p></p>
<p><span style="color:#00ff">private</span>&nbsp;<span style="color:#00ff">static</span>&nbsp;<span style="color:#00ff">string</span>&nbsp;UpdateData1(<span style="color:#00ff">…</span>)</p>
<p>{</p>
<p>……</p>
<p>}</p>
<p></p>
<p><span style="color:#00ff">private</span>&nbsp;<span style="color:#00ff">static</span>&nbsp;<span style="color:#00ff">string</span>&nbsp;UpdateData2(<span style="color:#00ff">…</span>)</p>
<p>{</p>
<p>……</p>
<p>}</p>
<p>解答：</p>
<p style="background:rgb(255,255,255)">public&nbsp;static&nbsp;void&nbsp;main()</p>
<p style="background:rgb(255,255,255)">{</p>
<p style="background:rgb(255,255,255)">string&nbsp;conString&nbsp;=&nbsp;&quot;data&nbsp;source=127.0.0.1;database=codematic;user&nbsp;id=sa;</p>
<p style="background:rgb(255,255,255)">password=&quot;;</p>
<p style="background:rgb(255,255,255)">SqlConnection&nbsp;myConnection&nbsp;=&nbsp;new&nbsp;SqlConnection(conString);</p>
<p style="background:rgb(255,255,255)">myConnection.Open();</p>
<p style="background:rgb(255,255,255)"></p>
<p style="background:rgb(255,255,255)">//<span style="font-family:宋体">启动一个事务</span></p>
<p style="background:rgb(255,255,255)">SqlTransaction&nbsp;myTrans&nbsp;=&nbsp;myConnection.BeginTransaction();</p>
<p style="background:rgb(255,255,255)">//<span style="font-family:宋体">为事务创建一个命令</span></p>
<p style="background:rgb(255,255,255)">SqlCommand&nbsp;myCommand&nbsp;=&nbsp;new&nbsp;SqlCommand();</p>
<p style="background:rgb(255,255,255)">myCommand.Connection&nbsp;=&nbsp;myConnection;//<span style="font-family:宋体">字符串连接</span></p>
<p style="background:rgb(255,255,255)">myCommand.Transaction&nbsp;=&nbsp;myTrans;</p>
<p style="background:rgb(255,255,255)">try</p>
<p style="background:rgb(255,255,255)">{</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;&nbsp;myCommand.CommandText&nbsp;=&nbsp;UpdateData1();</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;&nbsp;myCommand.ExecuteNonQuery();</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;&nbsp;myCommand.CommandText&nbsp;=&nbsp;UpdateData1();</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;&nbsp;myCommand.ExecuteNonQuery();</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;&nbsp;myTrans.Commit();//<span style="font-family:宋体">提交</span></p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;&nbsp;Response.Write(&quot;<span style="font-family:宋体">两条数据更新成功</span><span style="font-family:Calibri">&quot;);</span></p>
<p style="background:rgb(255,255,255)">}</p>
<p style="background:rgb(255,255,255)">catch&nbsp;(Exception&nbsp;ex)</p>
<p style="background:rgb(255,255,255)">{</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;&nbsp;myTrans.Rollback();//<span style="font-family:宋体">遇到错误，回滚</span></p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;&nbsp;Response.Write(ex.ToString());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p style="background:rgb(255,255,255)">}</p>
<p style="background:rgb(255,255,255)">finally</p>
<p style="background:rgb(255,255,255)">{</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;&nbsp;myConnection.Close();</p>
<p style="background:rgb(255,255,255)">}</p>
<p style="background:rgb(255,255,255)">}</p>
<p style="background:rgb(255,255,255)"></p>
<p style="background:rgb(255,255,255)">private&nbsp;static&nbsp;string&nbsp;UpdateData1()</p>
<p style="background:rgb(255,255,255)">{</p>
<p style="background:rgb(255,255,255)">Return&nbsp;&quot;update&nbsp;a&nbsp;set&nbsp;Name='测试1'&nbsp;where&nbsp;Id=1&quot;;</p>
<p style="background:rgb(255,255,255)">}</p>
<p style="background:rgb(255,255,255)"></p>
<p style="background:rgb(255,255,255)">private&nbsp;static&nbsp;string&nbsp;UpdateData2()</p>
<p style="background:rgb(255,255,255)">{</p>
<p style="background:rgb(255,255,255)">Return&nbsp;&quot;update&nbsp;b&nbsp;set&nbsp;Name='测试2'&nbsp;where&nbsp;Id=1&quot;;</p>
<p style="background:rgb(255,255,255)">}</p>
<p>如果不在一个数据库里面可以用两个SqlTransaction&nbsp;分别为&nbsp;sqlTran1和sqlTran2</p>
<p style="background:rgb(255,255,255)">定义一个变量<span style="font-family:Calibri">int&nbsp;num</span><span style="font-family:宋体">；执行</span>sqlTran1，如果成功num<span style="font-family:宋体">就加</span><span style="font-family:Calibri">1</span><span style="font-family:宋体">，执行</span>sqlTran2<span style="font-family:宋体">，成功</span><span style="font-family:Calibri">num</span><span style="font-family:宋体">再加</span><span style="font-family:Calibri">1</span><span style="font-family:宋体">，</span></p>
<p style="background:rgb(255,255,255)">最后判断<span style="font-family:Calibri">num==2&nbsp;</span><span style="font-family:宋体">两个事务都提交，如果！</span><span style="font-family:Calibri">=2</span><span style="font-family:宋体">两个事务都回滚。</span></p>
<p>代码：</p>
<p style="background:rgb(255,255,255)">public&nbsp;void&nbsp;TransactionDebug()<br>
&nbsp;&nbsp;{</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;string&nbsp;sql1&nbsp;=&nbsp;@&quot;Data&nbsp;Source=XXXXXX;Initial&nbsp;Catalog=stuDB;Integrated&nbsp;Security=True&quot;;<br>
&nbsp;&nbsp;&nbsp;string&nbsp;sql2&nbsp;=&nbsp;@&quot;Data&nbsp;Source=XXXXXX;Initial&nbsp;Catalog=Northwind;Integrated&nbsp;Security=True&quot;;</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;SqlConnection&nbsp;conn1&nbsp;=&nbsp;new&nbsp;SqlConnection(sql1);<br>
&nbsp;&nbsp;&nbsp;SqlConnection&nbsp;conn2&nbsp;=&nbsp;new&nbsp;SqlConnection(sql2);</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;string&nbsp;sqlUpdate1&nbsp;=&nbsp;&quot;UPDATE&nbsp;stuInfo&nbsp;SET&nbsp;stuAddress='<span style="font-family:宋体">江南</span><span style="font-family:Calibri">'&nbsp;WHERE&nbsp;stuNO='s25301'&quot;;</span><br>
&nbsp;&nbsp;&nbsp;string&nbsp;sqlUpdate2&nbsp;=&nbsp;&quot;UPDATE&nbsp;Products&nbsp;SET&nbsp;ProductName='Chian'&nbsp;WHERE&nbsp;ProductID=1&quot;;</p>
<p style="background:rgb(255,255,255)"><br>
&nbsp;&nbsp;&nbsp;SqlCommand&nbsp;sc1&nbsp;=&nbsp;new&nbsp;SqlCommand(sqlUpdate1,&nbsp;conn1);<br>
&nbsp;&nbsp;&nbsp;SqlCommand&nbsp;sc2&nbsp;=&nbsp;new&nbsp;SqlCommand(sqlUpdate2,&nbsp;conn2);</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;conn1.Open();<br>
&nbsp;&nbsp;&nbsp;SqlTransaction&nbsp;sqlTran1&nbsp;=&nbsp;conn1.BeginTransaction();<br>
&nbsp;&nbsp;&nbsp;conn2.Open();<br>
&nbsp;&nbsp;&nbsp;SqlTransaction&nbsp;sqlTran2&nbsp;=&nbsp;conn2.BeginTransaction();</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;int&nbsp;effectrow=0;</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;using(TransactionScope&nbsp;tranScope&nbsp;=&nbsp;new&nbsp;TransactionScope())<br>
&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;try<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sc1.Transaction&nbsp;=&nbsp;sqlTran1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;effectrow&nbsp;&#43;=&nbsp;sc1.ExecuteNonQuery();</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sc2.Transaction&nbsp;=&nbsp;sqlTran2;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;effectrow&nbsp;&#43;=&nbsp;sc2.ExecuteNonQuery();<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;catch(SqlException&nbsp;ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlTran1.Rollback();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlTran2.Rollback();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn1.Close();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn2.Close();</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;ex;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;if(effectrow&nbsp;==&nbsp;2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlTran1.Commit();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlTran2.Commit();<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;else<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlTran1.Rollback();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlTran2.Rollback();<br>
&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p style="background:rgb(255,255,255)">&nbsp;&nbsp;&nbsp;&nbsp;conn1.Close();<br>
&nbsp;&nbsp;&nbsp;&nbsp;conn2.Close();<br>
&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;}</p>
<p></p>
<p></p>
<p></p>
<p></p>
<p>5.&nbsp;请简答关于<span style="font-family:Calibri">SQL&nbsp;Server</span><span style="font-family:宋体">的概念题：</span></p>
<p>a)&nbsp;在查询和更新数据时，会涉及到那几种类型的锁。</p>
<p><span style="color:#00ff">独占和更新</span></p>
<p>6.&nbsp;请解释下面<span style="font-family:Calibri">Javascript</span><span style="font-family:宋体">代码的区别：</span></p>
<p><span style="color:#00ff">var&nbsp;</span>a&nbsp;=&nbsp;<span style="color:#00ff">new&nbsp;Object();</span></p>
<p><span style="color:#808080">//</span><span style="color:#0800">&nbsp;</span><span style="color:#0800">下面两句话是否有区别</span></p>
<p>a.companyName&nbsp;=&nbsp;“Microsoft”;</p>
<p>a[“companyName”]&nbsp;=&nbsp;“Microsoft”;</p>
<p><span style="color:#808080">//</span><span style="color:#808080">&nbsp;</span><span style="color:#0800">请简述下面两种写法的本质，涉及到<span style="font-family:Consolas">javascipt</span><span style="font-family:宋体">语法的原理</span></span></p>
<p><span style="color:#00ff">var&nbsp;</span>company&nbsp;=&nbsp;<span style="color:#00ff">function()&nbsp;{};</span></p>
<p>company.get_name&nbsp;=&nbsp;<span style="color:#00ff">function()&nbsp;{</span></p>
<p><span style="color:#00ff">return&nbsp;</span>“Microsoft”;</p>
<p><span style="color:#00ff">}</span></p>
<p><span style="color:#00ff">var&nbsp;</span>company&nbsp;=&nbsp;<span style="color:#00ff">function()&nbsp;{};</span></p>
<p>company.prototype.get_name&nbsp;=&nbsp;<span style="color:#00ff">function()&nbsp;{</span></p>
<p><span style="color:#00ff">return&nbsp;</span>“Microsoft”;</p>
<p><span style="color:#00ff">}</span></p>
<p></p>
<p>解答：</p>
<p><span style="color:#00ff">var</span>&nbsp;<span style="color:#000000">a&nbsp;=</span>&nbsp;<span style="color:#00ff">new</span>&nbsp;<span style="color:#000000">Object();&nbsp;</span></p>
<p><span style="color:#000000">a.companyName&nbsp;=</span>&nbsp;<span style="color:#000000">“Microsoft”;</span><span style="color:#0800">//<span style="font-family:宋体">给</span><span style="font-family:Calibri">a</span><span style="font-family:宋体">对象增加</span><span style="font-family:Calibri">companyName</span><span style="font-family:宋体">属性</span></span></p>
<p><span style="color:#000000">a[“companyName”]&nbsp;=</span>&nbsp;<span style="color:#000000">“Microsoft”;&nbsp;</span><span style="color:#0800">//<span style="font-family:宋体">和上边一句话是一样的&nbsp;相当于</span><span style="font-family:Calibri">a.companyName</span></span></p>
<p><span style="color:#0800">//</span>&nbsp;<span style="color:#0800">对象访问或增加属性的方式有两种&nbsp;对象<span style="font-family:Calibri">.</span><span style="font-family:宋体">属性和对象</span><span style="font-family:Calibri">[</span><span style="font-family:宋体">属性</span><span style="font-family:Calibri">]</span></span>&nbsp;</p>
<p><span style="color:#00ff">var</span>&nbsp;<span style="color:#000000">company&nbsp;=</span>&nbsp;<span style="color:#00ff">function</span><span style="color:#000000">()&nbsp;{};&nbsp;</span><span style="color:#0800">//function<span style="font-family:宋体">也是对象</span></span></p>
<p><span style="color:#000000">company.get_name&nbsp;=</span>&nbsp;<span style="color:#00ff">function</span><span style="color:#000000">()&nbsp;{&nbsp;</span></p>
<p><span style="color:#0800">//<span style="font-family:宋体">所以可以对</span><span style="font-family:Calibri">function</span><span style="font-family:宋体">也增加属性</span></span></p>
<p><span style="color:#00ff">return</span>&nbsp;<span style="color:#000000">“Microsoft”;&nbsp;</span></p>
<p><span style="color:#000000">}&nbsp;</span></p>
<p><span style="color:#00ff">var</span>&nbsp;<span style="color:#000000">company&nbsp;=</span>&nbsp;<span style="color:#00ff">function</span><span style="color:#000000">()&nbsp;{};&nbsp;</span></p>
<p><span style="color:#0800">//<span style="font-family:宋体">既然</span><span style="font-family:Calibri">function</span><span style="font-family:宋体">是对象&nbsp;其自然也具有</span><span style="font-family:Calibri">prototype</span><span style="font-family:宋体">属性&nbsp;即原型</span></span></p>
<p><span style="color:#000000">company.prototype.get_name&nbsp;=</span>&nbsp;<span style="color:#00ff">function</span><span style="color:#000000">()&nbsp;{&nbsp;</span></p>
<p><span style="color:#00ff">return</span>&nbsp;<span style="color:#000000">“Microsoft”;&nbsp;</span></p>
<p><span style="color:#000000">}</span></p>
<p style="background:rgb(255,255,255)"><span style="color:#0800">var&nbsp;c&nbsp;=&nbsp;new&nbsp;company();</span><span style="color:#0800"><br>
</span><span style="color:#0800">alert(c.get_name());</span><span style="color:#0800"><br>
</span><span style="color:#0800">前者报错，后者可运行，关于原型链的问题，请<span style="font-family:Calibri">Google</span><span style="font-family:宋体">搜索</span><span style="font-family:Calibri">“js&nbsp;</span><span style="font-family:宋体">原型链</span><span style="font-family:Calibri">”</span><span style="font-family:宋体">进行有条理地学习</span></span><span style="background:rgb(255,255,255)"><br>
</span><span style="color:#0800">prototype</span><span style="color:#0800">它是一个给类的对象添加方法的方法</span></p>
</div>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/5/10 10:40:55 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7553028">原文链接</a>
            </div>
            <div>
            阅读：2360 评论：3 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7553028#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[原]百度地图车辆运动轨迹]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549787</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549787</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/5/9 14:17:24</pubDate>
        <description><![CDATA[
            
<p>先看效果：</p>
<p>bolg地址：<a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549787">http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549787</a></p>
<p><img alt="" src="http://my.csdn.net/uploads/201205/09/1336543597_1069.png"></p>
<p>&nbsp;</p>
<p><img alt="" src="http://my.csdn.net/uploads/201205/09/1336543612_9419.png"></p>
<p>&nbsp;</p>
<p><img alt="" src="http://my.csdn.net/uploads/201205/09/1336543632_9509.png"></p>
<p>&nbsp;</p>
<p><img alt="" src="http://my.csdn.net/uploads/201205/09/1336543658_5220.png"></p>
<p>下面是代码：</p>
<p>页面代码：</p>
<pre class="html" name="code">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=7&quot; /&gt;
&lt;title&gt;回放目标轨迹&lt;/title&gt;
&lt;style type=&quot;text/css&quot;&gt;
*{font-size:12px;}
body,html{margin:0px;padding:0px;overflow:hidden;}
#tip{position:absolute;z-index:100000;width:auto;padding:5px;color:#039;font-weight:bold;background:#FFF;display:none;}
&lt;/style&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;api-v=1.2&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;goome.maps.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;WdatePicker.js-v=1.0.1.1&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;cn.js-v=1.0.1.1&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;jquery-1.3.2.min.js.gzjs&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;underscore.js-v=1.0.1.1&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;popupmarker.js-v=1.0.1.1&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;core.js-v=1.0.1.1&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;playback.js-v=1.0.1.1&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
function restFrame(){
	var w = document.documentElement.clientWidth;
	var h = document.documentElement.clientHeight;
	var topMenuHeight = 32;//顶部菜单区域的整体高度
	var divCanvas = document.getElementById(&quot;map&quot;);
	divCanvas.style.height= (h- topMenuHeight)+&quot;px&quot;;
	divCanvas.style.width= w+&quot;px&quot;;
}
//,&quot;http://his-dx.vehicling.net/&quot;
var PlayBack = new PlayBack(&quot;map&quot;,65979,&quot;GT02&quot;,65);
function init(){
	restFrame();
	PlayBack.createMap(&quot;cn&quot;);
}
document.onmousemove = mouseCoords;

//getMaxDate生成客户端本地时间
function getMaxDate(){
	var t = new Date();
	var maxDate = [t.getFullYear(), t.getMonth()+1, t.getDate()].join('-');
	maxDate += ' ' + t.toLocaleTimeString();
	return maxDate; 
}
//getMinDate生成客户端本地时间
function getMinDate(){
	var t = new Date();
	t.setMonth(t.getMonth() - 2);//最小时间少2个月
	var maxDate = [t.getFullYear(), t.getMonth()+1, t.getDate()].join('-');
	maxDate += ' ' + t.toLocaleTimeString();
	return maxDate; 
}
&lt;/script&gt;
&lt;/head&gt;
&lt;body onResize=&quot;restFrame();&quot; onLoad=&quot;init();&quot;&gt;
&lt;span id=&quot;tip&quot;&gt;正在加载数据,请耐心等待.......&lt;/span&gt;
&lt;div style=&quot;font-size:12px;height:30px;text-align:center;background:#C5CFD6;border-bottom:1px solid #999;&quot;&gt;
	武汉的士 从：
    &lt;input type=&quot;text&quot; name=&quot;from&quot; value=&quot;2012-05-08 16:05:52&quot; id=&quot;from&quot; readonly onClick=&quot;WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss',maxDate: getMaxDate

(),minDate:getMinDate()})&quot; class=&quot;Wdate&quot; /&gt;
	到：
    &lt;input type=&quot;text&quot; name=&quot;to&quot; value=&quot;2012-05-08 17:05:52&quot; id=&quot;to&quot; readonly onClick=&quot;WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss',maxDate: getMaxDate

(),minDate:getMinDate()})&quot; class=&quot;Wdate&quot; /&gt;
	频    率：
    &lt;select name=&quot;freq&quot; id=&quot;freq&quot; onchange=&quot;PlayBack.Frequency = this.value&quot;&gt;
        &lt;option value=&quot;10000&quot;&gt;正常-10&lt;/option&gt;
        &lt;option value=&quot;5000&quot;&gt;2倍正常-5&lt;/option&gt;
        &lt;option value=&quot;3000&quot;&gt;快-3&lt;/option&gt;
        &lt;option value=&quot;1000&quot;&gt;比较快-1&lt;/option&gt;
        &lt;option value=&quot;500&quot; &gt;很快-0.5&lt;/option&gt;
        &lt;option value=&quot;100&quot;&gt;非常快-0.1&lt;/option&gt;
        &lt;option value=&quot;10&quot; selected&gt;快得不得了&lt;/option&gt;
    &lt;/select&gt;
	秒
    &lt;input id=&quot;PLAY&quot; onClick=&quot;PlayBack.getDataFrist(document.getElementById('from').value,document.getElementById('to').value,document.getElementById('freq').value)&quot; 

type=&quot;button&quot; value=&quot;开始回放&quot; /&gt;
    &lt;input id=&quot;STOP&quot; onClick=&quot;PlayBack.stopPlay()&quot; type=&quot;button&quot; value=&quot;停止播放&quot; style=&quot;display:none;&quot;/&gt;
    &lt;input id=&quot;mdTime&quot; type=&quot;hidden&quot; value=&quot;&quot;/&gt;
&lt;/div&gt;
&lt;div id=&quot;map&quot;&gt;&lt;/div&gt;
&lt;/body&gt;     
&lt;/html&gt;</pre>
<p><br>
主要js：</p>
<p>playback.js-v=1.0.1.1</p>
<pre class="html" name="code">// JavaScript Document
var map = &quot;&quot;;
var _isBMap_ = typeof BMap !== &quot;undefined&quot;;
var PlayBack = function(mapId,user_id,productType,sudu, url){
	this.container = mapId;
	this.user_id = user_id;
	this.map = null;
	this.productType = productType;
	this.overSpeed = sudu&lt;60?80:sudu;
	this.AJAX_URL = url || &quot;&quot;;
	this.REQUESR_URL = &quot;http://his.10086care.com/GetDataService?method=getHistoryMByMUtc&quot;;//调用别的网站的webservice以获取坐标
	this.MAP_CENTER_LAT = 22.573978188551297;
	this.MAP_CENTER_LNG = 113.92078757286072;
	this.DEFAULT_DAYS = 6*24*60*60;
	this.RECORDS_LENGTH = 1000;
	this.MARKERS_OBJ = {};
	this.STATIC_MARKER = [];
	this.mapType =(typeof BMap == 'undefined')?&quot;GOOGLE&quot;:&quot;BAIDU&quot;;//默认地图类型
	this.DEFAULT_ZOOM = 5;
	this.DISTANCE = 0;
	this.POLY_LINE_MARKER = [];
	this.DATA_REQUEST = true;
	this.FROM_TIME = null;
	this.TO_TIME = null;
	this.NEXT_TIME = null;
	this.LAST_DATA = [];
	this.PRE_DATE_TIMR = null;
	this.LAST_DATA_ = [];
	this.PRE_DATE_TIMR_ = null;
	this.RUN_TIME = 0;
	this.STOP_TIME = 0;
	this.EXCURSION_COUNT = 0;
	this.FRIST_LOAD = true;
	this.TIMER = &quot;-1&quot;;
	this.HISTORY_PLAY_FLAG = true;
	this.Frequency = null;
	this.BUTTONS_ID = [&quot;PLAY&quot;,&quot;STOP&quot;];
	this.PLAY_OVER = false ;
	this.CROSS_DATA_1 = null;
	this.CROSS_DATA_2 = null;
	this.GL = false;//最后一点是否被过滤掉
	this.needGetData = false; 
};
PlayBack.prototype.createMap = function(lang){
	this.lang = lang;
	this.map = new goome.maps.Map({id:&quot;map&quot;,lang:lang,lat:this.MAP_CENTER_LAT,lng:this.MAP_CENTER_LNG,zoom:this.DEFAULT_ZOOM});
	goome.maps.event.addListener(this.map,&quot;mousemove&quot;,PlayBack.mapMouseMove);
};
PlayBack.prototype.getDataFrist = function(from,to,q){//第一次取GPS数据
	this.buttonAttribute(this.BUTTONS_ID[0],true,true);
	if(from==&quot;&quot;||to==&quot;&quot;) return;//开始和结束日期都不能为空
	var FROM_TIME = new Date(from.replace(/-/g, &quot;/&quot;));
	var TO_TIME = new Date(to.replace(/-/g, &quot;/&quot;));
	PlayBack.RUN_TIME = 0; //每次播放重置停留时间
	
	var timeDiff = (TO_TIME - FROM_TIME) / 1000;
	if(timeDiff &lt; 0){
		alert(lg.distime);
		this.buttonAttribute(this.BUTTONS_ID[0],false,true);
		return;
	}
	if(this.FRIST_LOAD){//第一次回放
		this.FROM_TIME = from;
		this.TO_TIME = to;
		this.NEXT_TIME = from;
	}else{//不是第一次
		PlayBack.HISTORY_PLAY_FLAG = true;
		if(getTimeDiff(to,this.TO_TIME)&gt;10||!PlayBack.PLAY_OVER){//如果修改了结束时间大于之前的结束时间并且不是第一次播放,并且结束时间大于之前的结束时间
			PlayBack.DATA_REQUEST = true;
		}else{
			PlayBack.DATA_REQUEST = false;
		}
		if(this.FROM_TIME!=from){//开始时间发生了变化,则删除上次播放的信息,重新播放
			clearTimeout(this.TIMER);
			this.GL = false;
			this.clearOverLayer();
			this.POLY_LINE_MARKER = [];
			this.FRIST_LOAD = true;
			this.DISTANCE = 0;
			this.FROM_TIME = from;
			this.NEXT_TIME = from;
			this.TO_TIME = to;
		}else{
			if(getTimeDiff(to,this.TO_TIME)&lt;=10&amp;&amp;PlayBack.PLAY_OVER){//播放结束
				alert(lg.playOverTip[0] + PlayBack.FROM_TIME +lg.playOverTip[1] + PlayBack.TO_TIME);
				this.buttonAttribute(this.BUTTONS_ID[0],false,true);
				return;
			}
		}
	}
	this.Frequency = q||100;
	if(!this.FRIST_LOAD&amp;&amp;!PlayBack.PLAY_OVER){//上次数据还没播放完毕
		this.TO_TIME = to;
		PlayBack.buttonAttribute(PlayBack.BUTTONS_ID[0],false,false);
	}else{		
		this.TO_TIME = to;
		this.PLAY_OVER = false;
		this.ajaxRequest();
	}
};
PlayBack.prototype.getDataCallBack = function(msg){//第一次取完数据回调
	document.getElementById('tip').style.display = &quot;none&quot;;
	PlayBack.buttonAttribute(PlayBack.BUTTONS_ID[0],false,true);
	if(!msg){
		alert(lg.playOverTip[0] + PlayBack.FROM_TIME +lg.playOverTip[1] + PlayBack.TO_TIME);
		var text = PlayBack.getTxtByCount();
		if(PlayBack.MARKERS_OBJ.update) PlayBack.MARKERS_OBJ.update({text:text});
		PlayBack.buttonAttribute(PlayBack.BUTTONS_ID[0],false,true);
		PlayBack.PLAY_OVER = true ;
		return;
	}
	PlayBack.buttonAttribute(PlayBack.BUTTONS_ID[0],true,false);
	if(msg){
		PlayBack.GL = false;
		var poly = [];
		var pArray = [];//点数组
		if(!PlayBack.FRIST_LOAD&amp;&amp;PlayBack.LAST_DATA.length&gt;0){//如果不是第一次请求数据,则把上次线条的最后一个点也加上
			poly = [new goome.maps.LatLng(PlayBack.LAST_DATA[1], PlayBack.LAST_DATA[0])];
		}
		var tem = msg.split(&quot;;&quot;);
		if(PlayBack.FRIST_LOAD){
			PlayBack.LAST_DATA_ = tem[0].split(&quot;,&quot;);
			PlayBack.PRE_DATE_TIMR_ = PlayBack.LAST_DATA_[2];
		} 
		var dateLen = tem.length-1;
		for(var i=0;i&lt;dateLen;i++){
			var flag = true;
			var rs = tem[i].split(&quot;,&quot;);			
			var _diffTime = getTimeDiff(utcToLocal(rs[2]),utcToLocal(PlayBack.LAST_DATA_[2]));//当前点和上一个正常点之间的差,经过过滤之后的点
			var _dis_time = getTimeDiff(utcToLocal(rs[2]),utcToLocal(PlayBack.PRE_DATE_TIMR_));//当前点和最近的上一个点之间的时间差
			PlayBack.LAST_DATA_ = rs;
			PlayBack.PRE_DATE_TIMR_ = rs[2];
			if((PlayBack.productType.indexOf(&quot;GT02&quot;)&gt;-1||PlayBack.productType==&quot;LY-H810&quot;)){//&amp;&amp;i&lt;(tem.length-2)//PlayBack.productType==&quot;GT02&quot;||PlayBack.productType==&quot;GT02+&quot;||PlayBack.productType==&quot;GT02A&quot;gt02和gt02+ 和 gt02A过滤漂移点
				//英文版b/s和c/s版过滤时间间隔从30秒提高到300秒,中文版过滤间隔时间超过30S的数据
				if(_dis_time &gt; (PlayBack.lang == &quot;en&quot; ? 300 : 30 )){
					PlayBack.EXCURSION_COUNT ++;
					rs = [PlayBack.LAST_DATA_[0],PlayBack.LAST_DATA_[1],rs[2],0];
					if(i==(dateLen-1))PlayBack.GL = true;//表示最后一个点被过滤掉了
					continue;
				}
				if(rs[3] &lt; 5){//过滤速度小于5的数据。
					PlayBack.EXCURSION_COUNT ++;
					rs = [PlayBack.LAST_DATA_[0],PlayBack.LAST_DATA_[1],rs[2],0];
					if(i==(dateLen-1))PlayBack.GL = true;//表示最后一个点被过滤掉了
					continue;
				}
				if(rs[3] &lt; 10 &amp;&amp; PlayBack.EXCURSION_COUNT &gt; 5&amp;&amp;rs[3] &gt;= 5 ){
					PlayBack.EXCURSION_COUNT ++;
					rs = [PlayBack.LAST_DATA_[0],PlayBack.LAST_DATA_[1],rs[2],0];
					if(i==(dateLen-1))PlayBack.GL = true;//表示最后一个点被过滤掉了
					continue;
				}
				if(rs[3] &gt;= 10 &amp;&amp; rs[3] &lt; 15 &amp;&amp; PlayBack.EXCURSION_COUNT &gt; 8 &amp;&amp; PlayBack.LAST_DATA_[3] &lt; 5){
					PlayBack.EXCURSION_COUNT ++;
					rs = [PlayBack.LAST_DATA_[0],PlayBack.LAST_DATA_[1],rs[2],0];
					if(i==(dateLen-1))PlayBack.GL = true;//表示最后一个点被过滤掉了
					continue;
				}
				PlayBack.EXCURSION_COUNT = 0;
				poly.push(new goome.maps.LatLng(rs[1], rs[0]));
				pArray.push(rs);
			}else{
				poly.push(new goome.maps.LatLng(rs[1], rs[0]));
				pArray.push(rs);
			}
		}
		if((tem.length-1) == PlayBack.RECORDS_LENGTH){
			PlayBack.NEXT_TIME = tem[tem.length-2].split(&quot;,&quot;)[2].split(&quot;.&quot;)[0];
			PlayBack.DATA_REQUEST = true;
			PlayBack.needGetData = true;
		}else{
			PlayBack.needGetData = false; //返回数据小于1000条将不需要再取数据
			PlayBack.DATA_REQUEST = false;
			//在轨迹播放完毕的情况下避免请求的最后一个点被过滤导致位置不准
			if(PlayBack.GL){//如果最后请求的数据点被过滤掉了
				poly.push(new goome.maps.LatLng(PlayBack.LAST_DATA_[1], PlayBack.LAST_DATA_[0]));
				pArray.push(PlayBack.LAST_DATA_);
			}
		}
		var flightPath = new goome.maps.Polyline({path:poly,strokeColor:&quot;#00FF00&quot;,strokeOpacity:0.9,strokeWeight:5}); 
		flightPath.setMap(PlayBack.map);
		PlayBack.POLY_LINE_MARKER.push(flightPath);
		PlayBack.playMarker(pArray);
	}
};

PlayBack.prototype.playMarker = function(array){//实现Marker播放功能
	if(PlayBack.FRIST_LOAD){
		var txt = &quot;&quot;;
		if(array.length==0){
			PlayBack.FRIST_LOAD = false;
			PlayBack.LAST_DATA = PlayBack.LAST_DATA_;
			PlayBack.PRE_DATE_TIMR = PlayBack.PRE_DATE_TIMR_;
			txt = PlayBack.getTxtByRecord(PlayBack.LAST_DATA);
			PlayBack.ajaxRequest();
		}else{
			PlayBack.LAST_DATA = array[0];
			PlayBack.PRE_DATE_TIMR = array[0][2];
			txt = PlayBack.getTxtByRecord(array[0]);
		}
		var point = new goome.maps.LatLng(PlayBack.LAST_DATA[1],PlayBack.LAST_DATA[0]);
		PlayBack.map.setCenter(point);
		PlayBack.map.setZoom(13);
		PlayBack.MARKERS_OBJ = new PopupMarker({position:point,map:PlayBack.map,icon:&quot;green.gif&quot;,text:txt,showpop:true});
		PlayBack.POLY_LINE_MARKER.push(PlayBack.MARKERS_OBJ);
		if(array.length==0)return;
	}
	var i = 0;		
	var paly = function() {
		if(PlayBack.HISTORY_PLAY_FLAG) {
			if(i&lt;array.length) {	
				if(array[i][3]&gt;PlayBack.overSpeed){
					var color = &quot;#FF00FF&quot;;
					if(array[i][3]&gt;1.5*PlayBack.overSpeed)color = &quot;#FF0000&quot;;
					var points = [new goome.maps.LatLng(array[i][1], array[i][0]),new goome.maps.LatLng(PlayBack.LAST_DATA[1], PlayBack.LAST_DATA[0])];
					var FP = new goome.maps.Polyline({path:points,strokeColor:color,strokeOpacity:0.9,strokeWeight:5});    
					FP.setMap(PlayBack.map);
					PlayBack.POLY_LINE_MARKER.push(FP);
				}
				PlayBack.play(array[i]);
				i++;			
				PlayBack.TIMER = setTimeout(paly,PlayBack.Frequency);
			}else{
				if(PlayBack.DATA_REQUEST &amp;&amp; PlayBack.needGetData){
					PlayBack.ajaxRequest();
				}else{
					alert(lg.playOverTip[0] + PlayBack.FROM_TIME +lg.playOverTip[1] + PlayBack.TO_TIME);
					var text = PlayBack.getTxtByCount();
					PlayBack.MARKERS_OBJ.update({text:text});
					PlayBack.buttonAttribute(PlayBack.BUTTONS_ID[0],false,true);
					PlayBack.PLAY_OVER = true ;
					PlayBack.NEXT_TIME = PlayBack.TO_TIME.split(&quot;.&quot;)[0];
				}
			}
		} else {
			PlayBack.TIMER = setTimeout(paly,PlayBack.Frequency);
		}
	};
	if(PlayBack.FRIST_LOAD){
		PlayBack.FRIST_LOAD = false;
		setTimeout(paly,1000);
	}else{
		paly();
	}
};
PlayBack.prototype.ajaxRequest = function(){
	var mdTime = document.getElementById('mdTime').value;
	PlayBack.NEXT_TIME = (PlayBack.NEXT_TIME &lt; mdTime ? mdTime : PlayBack.NEXT_TIME);
	var parms = &quot;&amp;userID=&quot;+PlayBack.user_id+&quot;&amp;mapType=&quot;+PlayBack.mapType+&quot;&amp;pwd=123456&amp;from=&quot;+localToUtc(PlayBack.NEXT_TIME)+&quot;&amp;to=&quot;+localToUtc(PlayBack.TO_TIME)+&quot;&amp;t=&quot;+new Date().getTime();
	var loadDiv = document.getElementById('tip');
	loadDiv.style.display = &quot;block&quot;;
	loadDiv.style.top = (document.documentElement.clientHeight -20)/2+&quot;px&quot;;
	loadDiv.style.left = (document.documentElement.clientWidth -150)/2+&quot;px&quot;;
	_.ajax.jsonp( PlayBack.AJAX_URL + PlayBack.REQUESR_URL + parms+&quot;&amp;callback=PlayBack.getDataCallBack&quot;);
};
PlayBack.prototype.getTxtByRecord = function(record){//生成弹出窗口的文字
	var html=[];
	html.push('&lt;font&gt;');
	html.push('&lt;span style=&quot;font-weight:bold;&quot;&gt;'+lg.speed+':&lt;/span&gt;'+record[3]+lg.kPerH+'&lt;br/&gt;');
	html.push('&lt;span style=&quot;font-weight:bold;&quot;&gt;'+lg.movement+':&lt;/span&gt;'+formatKm2M(PlayBack.DISTANCE)+'&lt;br/&gt;');
	html.push('&lt;span style=&quot;font-weight:bold;&quot;&gt;'+lg.sign+':&lt;/span&gt;'+utcToLocal(record[2])+'&lt;br/&gt;');
	if(PlayBack.STOP_TIME&gt;0){
		html.push('&lt;span style=&quot;font-weight:bold;&quot;&gt;'+lg.idle+':&lt;/span&gt;'+exchangeTime(PlayBack.STOP_TIME)+'&lt;br/&gt;');
	}
	html.push('&lt;/font&gt;');
	return html.join(&quot;&quot;);
};
PlayBack.prototype.getTxtByCount = function(){//生成弹出窗口的文字
	var total = getTimeDiff(PlayBack.TO_TIME,PlayBack.FROM_TIME);
	var html=[];
	html.push('&lt;font&gt;');
	html.push('&lt;span style=&quot;font-weight:bold;&quot;&gt;'+lg.totalTime+':&lt;/span&gt;'+exchangeTime(total)+'&lt;br/&gt;');
	html.push('&lt;span style=&quot;font-weight:bold;&quot;&gt;'+lg.movement+':&lt;/span&gt;'+formatKm2M(PlayBack.DISTANCE)+'&lt;br/&gt;');
	html.push('&lt;span style=&quot;font-weight:bold;&quot;&gt;'+lg.duration+':&lt;/span&gt;'+(exchangeTime(PlayBack.RUN_TIME)||0)+'&lt;br/&gt;');
	html.push('&lt;span style=&quot;font-weight:bold;&quot;&gt;'+lg.idle+':&lt;/span&gt;'+exchangeTime(total-PlayBack.RUN_TIME)+'&lt;br/&gt;');
	html.push('&lt;/font&gt;');
	return html.join(&quot;&quot;);
};
PlayBack.prototype.filterExcursion = function(array){//过滤漂移数据
	PlayBack.EXCURSION_COUNT ++;
	array[3] = 0;
	var text = PlayBack.getTxtByRecord(array);
	PlayBack.MARKERS_OBJ.update({text:text});
};
PlayBack.prototype.play = function(array){
	array[2] = utcToLocal(array[2]);
	var _diffTime = getTimeDiff(array[2],utcToLocal(PlayBack.LAST_DATA[2]));//当前点和上一个正常点之间的差,经过过滤之后的点
	var _dis_time = getTimeDiff(array[2],utcToLocal(PlayBack.PRE_DATE_TIMR));//当前点和最近的上一个点之间的时间差
	PlayBack.PRE_DATE_TIMR = array[2];
	if(_diffTime&gt;600){//大于600秒就画出静止点
		PlayBack.createStaticMarker(array[2],_diffTime);
	}
	var latlng = new goome.maps.LatLng(array[1],array[0]);
	PlayBack.DISTANCE = distance(PlayBack.LAST_DATA[1],PlayBack.LAST_DATA[0],array[1],array[0],PlayBack.DISTANCE);
	var text = PlayBack.getTxtByRecord(array);
	PlayBack.MARKERS_OBJ.update({position:latlng,text:text});
	var bound = PlayBack.map.getBounds();
	if(!bound.contains(latlng)){//如果监控车俩没有在地图范围内就重设地图中心
		if(_isBMap_){
			PlayBack.map.setCenter(latlng);
		}else{
			PlayBack.map.panTo(latlng);
		}
	}
	if(array[3]&gt;0){
		if(_diffTime&gt;180){//考虑在速度比较慢的情况下,会隔点传.
			PlayBack.STOP_TIME +=_diffTime;
		}else{//运行时间
			PlayBack.RUN_TIME +=_diffTime;
		}
		PlayBack.LAST_DATA = array;
	}
};
PlayBack.prototype.createStaticMarker = function(stime,dis_time){
	var txt = lg.idle+&quot;：&quot;+exchangeTime(dis_time)+&quot;&lt;br&gt;&quot;+lg.start+PlayBack.LAST_DATA[2]+&quot;&lt;br&gt;&quot;+lg.end+stime;
	var point = new goome.maps.LatLng(PlayBack.LAST_DATA[1],PlayBack.LAST_DATA[0]);
	var marker = new PopupMarker({position:point,map:PlayBack.map,icon:&quot;gray.gif&quot;,text:txt,showpop:false});
	PlayBack.STATIC_MARKER.push(marker);
};
PlayBack.prototype.stopPlay = function(){
	PlayBack.buttonAttribute(PlayBack.BUTTONS_ID[1],true,false);
	PlayBack.HISTORY_PLAY_FLAG = false;
};
PlayBack.prototype.clearOverLayer = function(){//重新播放,清楚地图上所有的线条和图标
	for(var i=0;i&lt;PlayBack.POLY_LINE_MARKER.length;i++){
		PlayBack.POLY_LINE_MARKER[i].setMap(null);
	}
	for(var j=0;j&lt;PlayBack.STATIC_MARKER.length;j++){
		PlayBack.STATIC_MARKER[j].setMap(null);
	}
};
PlayBack.prototype.buttonAttribute = function(id,bool,show){
	for(var i=0;i&lt;this.BUTTONS_ID.length;i++){
		if(this.BUTTONS_ID[i]==id){
			document.getElementById(this.BUTTONS_ID[i]).disabled = bool;
			if(show)
				document.getElementById(this.BUTTONS_ID[i]).style.display = &quot;&quot;;
			else 
				document.getElementById(this.BUTTONS_ID[i]).style.display = &quot;none&quot;;
		}else{
			if(!show) document.getElementById(this.BUTTONS_ID[i]).style.display = &quot;&quot;;
			else document.getElementById(this.BUTTONS_ID[i]).style.display = &quot;none&quot;;
			document.getElementById(this.BUTTONS_ID[i]).disabled = false;
		}
	}
};
PlayBack.prototype.mapMouseMove=function(event){
	var latlng=event.latLng;
	var markpoint=this.fromLatLngToDivPixel(latlng);
	for(var i=0;i&lt;PlayBack.STATIC_MARKER.length;i++){
		var point=this.fromLatLngToDivPixel(PlayBack.STATIC_MARKER[i].latlng());
		if(point.x&lt;(markpoint.x+7)&amp;&amp;point.x&gt;(markpoint.x-7)&amp;&amp;point.y&lt;(markpoint.y+15)&amp;&amp;point.y&gt;(markpoint.y-5)){
			PlayBack.STATIC_MARKER[i].show();
			return;
		}else{
			PlayBack.STATIC_MARKER[i].hide();
		}
	}
};</pre>
<p><br>
api-v=1.2</p>
<pre class="javascript" name="code">document.write('&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://api.map.baidu.com/res/12/bmap.css&quot;/&gt;');   document.write('&lt;script type=&quot;text/javascript&quot; src=&quot;http://api.map.baidu.com/getscript?v=1.2&amp;key=&amp;services=&amp;t=11111111&quot;&gt;&lt;/script&gt;');</pre>
<p><br>
goome.maps.js</p>
<pre class="javascript" name="code">(function(window){window.goome=window.goome||{};goome.maps=goome.maps||{};goome.maps.event={};var isBMap,mapperKey,tempMaps;if(typeof BMap!=&quot;undefined&quot;){tempMaps=BMap;goome.maps.event={};isBMap=true;mapperKey=&quot;baidu&quot;}else{if(typeof google!=&quot;undefined&quot;&amp;&amp;google.maps){tempMaps=google.maps;isBMap=false;mapperKey=&quot;google&quot;}}goome.maps.event.addListener=function(map,name,handler){var self=map._source||map;if(self.addEventListener){self.addEventListener(name,function(event){event.latLng=new goome.maps.LatLng(event.point);handler.call(map,event)})}else{google.maps.event.addListener(self,name,function(event){event.latLng=new goome.maps.LatLng(event.latLng);handler.call(map,event)})}};var objectMapping={Map:{google:&quot;Map&quot;,baidu:&quot;Map&quot;},LatLng:{google:&quot;LatLng&quot;,baidu:&quot;Point&quot;},Point:{google:&quot;Point&quot;,baidu:&quot;Pixel&quot;},Size:{google:&quot;Size&quot;,baidu:&quot;Size&quot;},LatLngBounds:{google:&quot;LatLngBounds&quot;,baidu:&quot;Bounds&quot;},InfoWindow:{google:&quot;InfoWindow&quot;,baidu:&quot;InfoWindow&quot;},OverlayView:{google:&quot;OverlayView&quot;,baidu:&quot;Overlay&quot;},Circle:{google:&quot;Circle&quot;,baidu:&quot;Circle&quot;},Polyline:{google:&quot;Polyline&quot;,baidu:&quot;Polyline&quot;},Marker:{google:&quot;Marker&quot;,baidu:&quot;Marker&quot;}};for(var key in objectMapping){goome.maps[key]=eval(key)}function OverlayView(){}OverlayView.prototype.setMap=function(map){if(this._source.setMap){this._source.setMap(map?(map._source||map):null)}else{if(map){map=map._source||map;if(map.addOverlay){map.addOverlay(this._source)}}else{map=this._source.getMap();if(map){map.removeOverlay(this._source)}}}};OverlayView.prototype.getMap=function(){var map=this._source.getMap();return map?new goome.maps.Map(map):null};for(var key in {Circle:&quot;&quot;,Polyline:&quot;&quot;,Marker:&quot;&quot;}){goome.maps[key].prototype.setMap=goome.maps.OverlayView.prototype.setMap;goome.maps[key].prototype.getMap=goome.maps.OverlayView.prototype.getMap}function Map(options){if(this===window){throw Error(&quot;use constructor to create a map instance&quot;)}if(options&amp;&amp;options.setZoom){this._source=options;return}if(typeof options!=&quot;object&quot;||!options.id){throw Error(&quot;Map:parameter type error or required property missed&quot;)}var defaults={lang:&quot;cn&quot;,sandbox:false,lat:{google:36.87962060502676,baidu:36.62060502676},lng:{google:111.6015625,baidu:108.6015625},zoom:{google:14,baidu:13}};var sandbox=options.sandbox||defaults.sandbox,lang=options.lang||defaults.lang,node=(typeof options.id===&quot;string&quot;)?document.getElementById(options.id):options.id;var map;if(isBMap){map=new BMap.Map(node,{zoomLevelMin:5,zoomLevelMax:17});map.centerAndZoom(options.center||new BMap.Point(defaults.lng.baidu,defaults.lat.baidu),options.zoom||defaults.zoom.baidu);map.enableScrollWheelZoom();map.enableKeyboard();map.addControl(new BMap.NavigationControl());map.addControl(new BMap.ScaleControl());map.addControl(new BMap.OverviewMapControl());map.addControl(new BMap.MapTypeControl({type:BMAP_MAPTYPE_CONTROL_HORIZONTAL,mapTypes:[BMAP_NORMAL_MAP,BMAP_SATELLITE_MAP,BMAP_HYBRID_MAP]}))}else{var opts={zoom:options.zoom||defaults.zoom.google,scaleControl:true,center:options.center||new google.maps.LatLng(defaults.lat.google,defaults.lng.google),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE]}};if(lang==&quot;cn&quot;){opts.mapTypeId=google.maps.MapTypeId.ROADMAP;map=new google.maps.Map(node,opts)}else{map=new google.maps.Map(node,opts)}if(typeof overlay===&quot;undefined&quot;){overlay=new google.maps.OverlayView();overlay.draw=function(){};overlay.setMap(map)}else{if(sandbox){var ol=new google.maps.OverlayView();ol.draw=function(){};ol.setMap(map);sandbox.overlay=ol}}}this._source=map}Map.prototype.getDiv=function(){return this._source.getDiv?this._source.getDiv():this._source.getContainer()};Map.prototype.setZoom=function(m){this._source.setZoom(m)};Map.prototype.getZoom=function(){return this._source.getZoom()};Map.prototype.panBy=function(x,y){this._source.panBy(x,y)};Map.prototype.getMapTypeId=function(){return this._source.getMapTypeId?this._source.getMapTypeId():this._source.getMapType()};Map.prototype.getBounds=function(){return new goome.maps.LatLngBounds(this._source.getBounds())};Map.prototype.getCenter=function(){return new goome.maps.LatLng(this._source.getCenter())};Map.prototype.setCenter=function(latlng){this._source.setCenter(latlng._source||latlng)};Map.prototype.panTo=function(latlng){this._source.panTo(latlng._source||latlng)};Map.prototype.fromLatLngToDivPixel=function(latlng){if(this._source.pointToOverlayPixel){return new goome.maps.Point(this._source.pointToOverlayPixel(latlng._source||latlng))}else{return new goome.maps.Point(overlay.getProjection().fromLatLngToDivPixel(latlng._source||latlng))}};function LatLng(lat,lng){if(arguments.length!==1){var k=objectMapping.LatLng[mapperKey];this._source=isBMap?(new tempMaps[k](lng,lat)):(new tempMaps[k](lat,lng))}else{this._source=lat}}LatLng.prototype.equals=function(latlng){return this._source.equals(latlng._source||latlng)};LatLng.prototype.lat=function(){return(typeof this._source.lat===&quot;function&quot;)?this._source.lat():this._source.lat};LatLng.prototype.lng=function(){return(typeof this._source.lng===&quot;function&quot;)?this._source.lng():this._source.lng};function Size(w,h){if(arguments.length===1){this._source=w}else{this._source=new tempMaps[objectMapping.Size[mapperKey]](w,h)}this.width=this._source.width;this.height=this._source.height}Size.prototype.equals=function(size){return this._source.equals(size._source||size)};function LatLngBounds(sw,ne){if(arguments.length===1){this._source=sw}else{this._source=new tempMaps[objectMapping.LatLngBounds[mapperKey]](sw._source,ne._source)}}LatLngBounds.prototype.contains=function(latlng){if(this._source.contains){return this._source.contains(latlng._source||latlng)}else{if(this._source.containsPoint){return this._source.containsPoint(latlng._source||latlng)}}};LatLngBounds.prototype.getCenter=function(){return new goome.maps.LatLng(this._source.getCenter())};LatLngBounds.prototype.getNorthEast=function(){return new goome.maps.LatLng(this._source.getNorthEast())};LatLngBounds.prototype.getSouthWest=function(){return new goome.maps.LatLng(this._source.getSouthWest())};function Point(x,y){if(arguments.length===2){this._source=new tempMaps[objectMapping.Point[mapperKey]](x,y)}else{this._source=x}this.x=this._source.x;this.y=this._source.y}Point.prototype.equals=function(point){if(point._source){return this._source.equals(point.source)}else{return this._source.equals(point)}};function Circle(opts){if(opts&amp;&amp;opts.getMap){this._source=opts;return}if(!opts.radius||!opts.center){throw Error(&quot;Circle:required options property missed!&quot;)}opts.center=opts.center._source||opts.center;var circle;if(isBMap){circle=new tempMaps[objectMapping.Circle[mapperKey]](opts.center,opts.radius,opts)}else{circle=new tempMaps[objectMapping.Circle[mapperKey]](opts)}if(opts.map){opts.map=opts.map._source||opts.map;if(opts.map.addOverlay){opts.map.addOverlay(circle)}}this._source=circle}Circle.prototype.getBounds=function(){return new goome.maps.LatLngBounds(this._source.getBounds())};Circle.prototype.getCenter=function(){return new goome.maps.LatLng(this._source.getCenter())};Circle.prototype.setCenter=function(latlng){this._source.setCenter(latlng._source||latlng)};Circle.prototype.getRadius=function(){return this._source.getRadius()};Circle.prototype.setRadius=function(radius){this._source.setRadius(radius)};Circle.prototype.setOptions=function(opts){var props={strokeColor:&quot;StrokeColor&quot;,strokeOpacity:&quot;StrokeOpacity&quot;,strokeWeight:&quot;StrokeWeight&quot;,fillColor:&quot;FillColor&quot;,fillOpacity:&quot;FillOpacity&quot;};if(this._source.setOptions){this._source.setOptions(opts)}else{for(var key in opts){if(props.hasOwnProperty(key)){this._source[&quot;set&quot;+props[key]](opts[key])}}}};function Polyline(opts){if(opts&amp;&amp;opts.setMap){this._source=opts;return}if(!opts.path){opts.path=[]}var apiPath=[],polyline;for(var index in opts.path){var item=opts.path[index];apiPath.push(item._source||item)}opts.path=apiPath;if(isBMap){polyline=new tempMaps[objectMapping.Polyline[mapperKey]](opts.path,opts)}else{if(opts.map&amp;&amp;opts.map._source){opts.map=opts.map._source}polyline=new tempMaps[objectMapping.Polyline[mapperKey]](opts)}if(opts.map){var m=opts.map._source||opts.map;if(m.addOverlay){m.addOverlay(polyline)}}this._source=polyline}Polyline.prototype.setOptions=function(opts){var props={strokeColor:&quot;StrokeColor&quot;,strokeOpacity:&quot;StrokeOpacity&quot;,strokeWeight:&quot;StrokeWeight&quot;,path:&quot;path&quot;};if(this._source.setOptions){this._source.setOptions(opts)}else{for(var key in opts){if(props.hasOwnProperty(key)){this._source[&quot;set&quot;+props[key]](opts[key])}}}};Polyline.prototype.getPath=function(){if(this._source.setOptions){var arr=[],gRet=this._source.getPath(),len=gRet.getLength(),i=0;for(;i&lt;len;i++){arr.push(new goome.maps.LatLng(gRet.getAt(i)))}return arr}var ret=[];var result=this._source.getPath();for(var index in result){ret.push(new goome.maps.LatLng(result[index]))}return ret};Polyline.prototype.setPath=function(latlngs){if(latlngs.length&lt;1){return}if(latlngs[0]._source){var origin=[];for(var index in latlngs){origin.push(latlngs[index]._source)}this._source.setPath(origin)}else{this._source.setPath(latlngs)}};Polyline.prototype.addPath=function(latlng,map){var path=this._source.getPath();path.push(latlng&amp;&amp;latlng._source);if(isBMap){this._source.setPath(path);(map&amp;&amp;map._source||this._source.getMap()).addOverlay(this._source)}};Polyline.prototype.clear=function(){if(isBMap){var map=this._source.getMap();if(!map){return}this._source.setPath([]);map.addOverlay(this._source)}else{var path=this._source.getPath();while(path.length){path.removeAt(0)}}};function Marker(opts,size,anchor){if(typeof opts===&quot;object&quot;&amp;&amp;opts.getMap){this._source=opts;return}if(!opts.position){throw Error(&quot;Marker:required options property missed!&quot;)}var position=opts.position._source||opts.position,marker;if(isBMap){if(opts.icon){var param;if(anchor&amp;&amp;anchor.width&amp;&amp;anchor.height){param={anchor:new BMap.Size(anchor.width,anchor.height)}}if(size&amp;&amp;size.width&amp;&amp;size.height){opts.icon=new BMap.Icon(opts.icon,new BMap.Size(size.width,size.height),param)}else{throw Error(&quot;Marker:parameter size with props width and height missed&quot;)}}marker=new tempMaps[objectMapping.Marker[mapperKey]](position,opts);if(opts.map){var map=opts.map._source||opts.map;map.addOverlay(marker)}}else{opts.position=position;if(opts.map){opts.map=opts.map._source||opts.map}marker=new tempMaps[objectMapping.Marker[mapperKey]](opts)}this._source=marker}Marker.prototype.getPosition=function(){return new goome.maps.LatLng(this._source.getPosition())};Marker.prototype.setPosition=function(latlng){this._source.setPosition(latlng._source||latlng)};Marker.prototype.getPosition=function(){return new goome.maps.LatLng(this._source.getPosition())};Marker.prototype.setTitle=function(title){this._source.setTitle(title)};Marker.prototype.getTitle=function(){return this._source.getTitle()};Marker.prototype.setIcon=function(url,size){if(isBMap&amp;&amp;arguments.length!=2){throw Error(&quot;Marker:parameter size:{width,height} for baidu map is missed&quot;)}if(this._source.setOptions){this._source.setIcon(url)}else{if(size&amp;&amp;size.width&amp;&amp;size.height){this._source.setIcon(new BMap.Icon(url,new BMap.Size(size.width,size.height)))}else{throw Error(&quot;Marker:required parameter size:property -width and height}&quot;)}}};Marker.prototype.getIcon=function(){var icon=this._source.getIcon();return typeof icon===&quot;string&quot;?icon:icon.imageUrl};Marker.prototype.setDraggable=function(flag){if(this._source.setDraggable){this._source.setDraggable(flag)}else{if(this._source.enableDragging){flag?this._source.enableDragging():this._source.disableDragging()}}};Marker.prototype.setVisible=function(flag){if(this._source.setVisible){this._source.setVisible(flag)}else{if(this._source.show){flag?this._source.show():this._source.hide()}}};Marker.prototype.setZIndex=function(index){this._source.setZIndex(index)};Marker.prototype.setOptions=function(opts){if(this._source.setOptions){this._source.setOptions(opts)}else{throw Error(&quot;Marker:not supported method - setOptions,use setter method directly&quot;)}};function InfoWindow(opts){if(opts&amp;&amp;opts.setContent){this._source=opts;return}if(!opts.hasOwnProperty(&quot;content&quot;)){throw Error(&quot;InfoWindow:options required property missed!&quot;)}if(isBMap){this._source=new tempMaps[objectMapping.InfoWindow[mapperKey]](opts.content,opts)}else{this._source=new tempMaps[objectMapping.InfoWindow[mapperKey]](opts)}}InfoWindow.prototype.open=function(map,marker){marker=marker._source||marker;map=map._source||map;if(this._source.open){this._source.open(map,marker)}else{if(marker.openInfoWindow){marker.openInfoWindow(this._source)}}};InfoWindow.prototype.close=function(){if(this._source.close){this._source.close()}else{if(this._source.hide){this._source.hide()}}};InfoWindow.prototype.getContent=function(){this._source.getContent()};InfoWindow.prototype.getPosition=function(){return new goome.maps.LatLng(this._source.getPosition())};InfoWindow.prototype.setContent=function(node){this._source.setContent(node)};InfoWindow.prototype.setZIndex=function(index){this._source.setZIndex(index)};InfoWindow.prototype.setPosition=function(latlng){this._source.setPosition(latlng._source||latlng)};InfoWindow.prototype.setOptions=function(opts){if(this._source.setOptions){this._source.setOptions(opts)}else{throw Error(&quot;InfoWindow:not supported method - setOptions,use setter method directly&quot;)}}})(window);</pre>
<p><br>
cn.js-v=1.0.1.1</p>
<p>&nbsp;</p>
<pre class="javascript" name="code">var lg={
downMsg:'&lt;br/&gt;&lt;br/&gt;&lt;h1&gt;帮助&lt;/h1&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;您可以通过“下载轨迹数据”功能，下载指定设备某一日期内的移动痕迹。&lt;br/&gt;&lt;br/&gt;步骤：&lt;br/&gt;1.选择需要下载的指定设备。&lt;br/&gt; 2.输入需要下载的具体日期。&lt;br/&gt; 3.单击“下载KML轨迹文件”按钮。&lt;br/&gt;&lt;br/&gt;&lt;span style=&quot;color:red;&quot;&gt;注意：如果单击“下载”按钮， 出现“没有找到有效的轨迹数据!”提示信息，表示当前没有你需要&lt;br/&gt;下载的数据。 &lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;下载的轨迹文件的格式是Google KML格式，如:“文件名.kml”。安装 Google Earth后。双击KML&lt;br/&gt;文件，会通过Google Earth工具打开。&lt;BR/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;KML轨迹文件&quot;会将设备的移动痕迹以红线动态的描绘在Google地图上。&lt;br/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br/&gt;&lt;br/&gt;附注:下载 Google Earth 请点击&nbsp;&lt;a href=&quot;http://dl.google.com/earth/client/ge4/release_4_3/googleearth-win-plus-4.3.7284.3916.exe&quot;&gt;&lt;font color=&quot;blue&quot;&gt;这里&lt;/font&gt;&lt;/a&gt; &lt;br/&gt;',
startPk:&quot;开始回放&quot;,stop:&quot;停止&quot;,bTime:[&quot;对不起！本系统暂不提供时间段跨度超过&quot;,&quot;天以上的统计数据查询！请将查询时间段跨度改为不超过&quot;],playOverTip:[&quot;轨迹回放完毕!!时间从 &quot;,&quot;到&quot;],totalTime:&quot;总时间&quot;,duration:&quot;运行&quot;,kPerH:&quot;公里/小时&quot;,
//globe
lang:&quot;cn&quot;,googleKey:&quot;http://ditu.google.cn/&quot;,
lng:&quot;经度&quot;,lat:&quot;纬度&quot;,latlng:&quot;经纬度&quot;,
snew:&quot;新货&quot;,skt:&quot;开通&quot;,sbk:&quot;退货&quot;,swx:&quot;维修&quot;,stj:&quot;停机&quot;,//销售状态
sdw:&quot;定位状态&quot;,sdw0:&quot;未定位&quot;,sdw1:&quot;已定位&quot;,p:&quot;位置:&quot;,//定位状态
srun0:&quot;未上线&quot;,srun1:&quot;离线&quot;,srun2:&quot;静止&quot;,srun3:&quot;行驶&quot;,srun4:&quot;快速行驶&quot;,srun5:&quot;超速行驶&quot;,srun6:&quot;全部&quot;,//运行状态
date:&quot;日期&quot;,time:&quot;时间&quot;,y:&quot;年&quot;,d:&quot;天&quot;,h:&quot;小时&quot;,m:&quot;分&quot;,s:&quot;秒&quot;,due:&quot;到期时间&quot;,serviceYear:&quot;服务年限&quot;,saleTime:&quot;销售时间&quot;,factoryTime:&quot;出厂日期&quot;,activeTime:&quot;开通日期&quot;,dwtime:&quot;定位时间&quot;,heartTime:&quot;心跳时间&quot;,sendtime:&quot;发送时间&quot;,utime:&quot;信号时间&quot;,
update0:&quot;关闭更新&quot;,update1:&quot;打开更新&quot;,view:&quot;全景&quot;,target:&quot;目标&quot;,
mi:&quot;米&quot;,km:&quot;公里&quot;,

on:&quot;开启&quot;,off:&quot;熄火&quot;,
msgtit0:&quot;提示&quot;,msgtit1:&quot;成功&quot;,msgtit2:&quot;失败&quot;,//弹出窗口提示信息标题

//loading 信息
updateSuc:&quot;数据更新成功....&quot;,subvali:&quot;正在验证.....请等待...&quot;,loadfali:&quot;数据加载失败...请重试&quot;,fload:&quot;正在加载数据....请稍候&quot;,leadin:&quot;正在提交数据.....请等待...&quot;,inputName:&quot;请输入您要统计设备的设备名称!&quot;,

//tips
ctimetip:&quot;查询的时间跨度不能大于 &quot;,msgcon0:&quot;请选择&quot;,msgcon1:&quot;IMEI号输入有误,请输入6位以上数字!!&quot;,msgcon2:&quot;请输入要搜索的设备名&quot;,
nodata:&quot;没有查询到数据&quot;,distime:&quot;开始时间不能大于结束时间&quot;,terror:&quot;时间输入有误&quot;,//提示信息内容
imeivali:&quot;IMEI号必须是15个字符长度的数字组成&quot;,imeitip:'IMEI号必须为15个字符长度的数字,导入多个IMEI号用&quot;,&quot;号分隔',saleImeiTip:&quot;IMEI号必须是由5-20个字符长度的数字组成&quot;,
passvali:&quot;俩次输入的密码不一致,请重新输入&quot;,selUTip:&quot;选择客户&quot;,fsuc:&quot;以下设备导入成功&quot;,pexist:&quot;以下设备已经存在&quot;,lfaluler:&quot;IMEI号导入失败....&quot;,
companyNameTip:&quot;客户名称必须不能为空白字符&quot;,addUsuc:&quot;客户添加&lt;font color=red&gt;成功&lt;/font&gt;&quot;,logNameVali:&quot;登陆名的第一个字符不能为数字&quot;,delSelfTip:&quot;你无权删除你自己的账号&quot;,delUTip:&quot;您确定要删除该用户吗？&quot;,selectTarget:&quot;请选择设备&quot;,selectCustom:&quot;请选择客户&quot;,
resetpwdtip:&quot;你确定要重置密码吗？&quot;,resetpwdfail:&quot;重置密码失败,请重试.....&quot;,userExist:&quot;该登陆名已经存在!请选择其他用户名!&quot;,addFali:&quot;数据添加失败&quot;,resetpwdsuc:&quot;您现在的密码是&quot;,
SimNumTip:&quot;SIM卡号必须为长度小于20位的数字&quot;,carNumExistTip:&quot;您输入的车牌号码在系统中已存在，请重新输入&quot;,stattip:&quot;请选择里程统计的日期&quot;,carNumFormatTip:&quot;车牌号格式错误&quot;,dealedtip:&quot;请不要重复处理&quot;,
sucpwdtip:&quot;密码已更新&quot;,falipwdtip:&quot;密码更新失败!!&quot;,sendzltip:&quot;发指令前请再次确认登陆密码&quot;,dealedsuc:&quot;报警处理成功&quot;,maptip:&quot;Google map暂不支持当前浏览器！&quot;,zoomMax:&quot;已经到达最大缩放级别了&quot;,

proaccount:&quot;设备登陆号&quot;,
product:&quot;产品&quot;,client:&quot;客户&quot;,type:&quot;类型&quot;,sclient:&quot;选中客户&quot;,pro:&quot;设备&quot;,name:&quot;名称&quot;,status:&quot;状态&quot;,speed:&quot;速度&quot;,account:&quot;设备短号&quot;,pimei:&quot;IMEI号&quot;,
list:&quot;列表&quot;,allp:&quot;所有设备&quot;,hidn:&quot;隐藏设备名&quot;,shown:&quot;显示设备名&quot;,number:&quot;号码&quot;,

//button
promanage:&quot;设备管理&quot;,add:&quot;新增&quot;,manage:&quot;管理&quot;,search:&quot;查询&quot;,resetPwd:&quot;重置密码&quot;,updatepwd:&quot;修改密码&quot;,leadin:&quot;导入&quot;,delall:&quot;删除所有&quot;,del:&quot;删除&quot;,areaPlayBack:&quot;区域回放&quot;,active:&quot;销售开通&quot;,
statLC:&quot;里程统计&quot;,statCS:&quot;超速统计&quot;,downgj:&quot;下载轨迹&quot;,runct:&quot;运行统计&quot;,pback:&quot;回 放&quot;,track:&quot;跟 踪&quot;,searchw:&quot;查询报警记录&quot;,zl:&quot;指令&quot;,cutyd:&quot;远程断油电&quot;,repyd:&quot;远程恢复油电&quot;,checkp:&quot;查询定位&quot;,checkr:&quot;查询指令记录&quot;,simei:&quot;按IMEI号搜&quot;,sname:&quot;按设备名搜&quot;,addCustom:&quot;新增客户&quot;,
ok:&quot;确定&quot;,sub:&quot;提交&quot;,cancel:&quot;取消&quot;,rset:&quot;重置&quot;,rload:&quot;重载&quot;,searchpro:&quot;设备查询&quot;,searchIMEI:&quot;搜 索&quot;,sale:&quot;销售&quot;,enlarge:&quot;放大地图&quot;,clos:&quot;关闭&quot;,more:&quot;更多...&quot;,

//array
hangxiang: [ &quot;正北向&quot;, &quot;北向&quot;, &quot;东北向偏北&quot;, &quot;东北向&quot;, &quot;东北向偏东&quot;, &quot;正东向&quot;, &quot;东向&quot;,&quot;东南向偏东&quot;, &quot;东南向&quot;, &quot;东南向偏南&quot;, &quot;正南向&quot;, &quot;南向&quot;, &quot;西南向偏南&quot;, &quot;西南向&quot;, &quot;西南向偏西&quot;,&quot;正西向&quot;, &quot;西向&quot;, &quot;西北向偏西&quot;, &quot;西北向&quot;, &quot;西北向偏北&quot; ],
wtype: [&quot;正常&quot;,&quot;震动报警&quot;,&quot;断电报警&quot;,&quot;强行关机报警&quot;,&quot;SOS求救&quot;,&quot;超速报警&quot;,&quot;超速报警&quot;,&quot;超速报警&quot;,&quot;超速报警&quot;,&quot;超速报警&quot;],
backMess :{SEND_SUCCESS:&quot;指令下发成功&quot;,SEND_FAIL:&quot;指令下发失败&quot;,PWD_ERROR:&quot;密码错误&quot;,NOT_CUSTOMER:&quot;客户不存在&quot;,USER_LEAVE:&quot;设备离线,不能发指令&quot;},
cmdType :{DWXX:'定位指令',DYD:'断油电指令',HFYD:'恢复油电指令'},
statusType :['网页发出指令','网关收到指令','网关判断不满足发送指令条件','设备不在线','网关发送指令','终端响应指令'],
warnData :[['所有报警', 'ALL'],['震动报警', '1'], ['断电报警', '2'],['低电报警', '3'], ['SOS求救', '4'], ['超速报警', '5']],
warnDealWith :['未处理','已处理'],gradeDate :[['经销商', '4'], ['最终客户', '8']],

//words
stip:&quot;设备IMEI号/设备名&quot;,logName:&quot;登陆名&quot;,warn:&quot;报警&quot;,cmd:&quot;指令&quot;,response:&quot;响应&quot;,mess:&quot;信息&quot;,idle:&quot;停留&quot;,sign:&quot;信号&quot;,
start:&quot; 开 始：&quot;,end:&quot; 结 束：&quot;,sarea:&quot;经过区域设备&quot;,atit:&quot;区域设置&quot;,map:&quot;地图&quot;,
owner:&quot;所属客户&quot;,platf:&quot;平台费&quot;,oney:&quot;一年期&quot;,threey:&quot;三年期&quot;,otherp:&quot;外挂平台&quot;,remark:&quot;备注信息&quot;,pwd:&quot;密码&quot;,opwd:&quot;旧密码&quot;,npwd:&quot;新密码&quot;,rpwd:&quot;确认密码&quot;,cfirm:&quot;确认&quot;,
course:&quot;航向&quot;,operate:&quot;操作&quot;,warntit:&quot;报警信息报表&quot;,leadout:&quot; 导出 &quot;,stattime:&quot;&nbsp;&nbsp;统计日期&nbsp;&nbsp;&quot;,tmovement:&quot;总里程(单位:Km)&quot;,toverspeed:&quot;总超速次数&quot;, mileagetit:&quot;里程统计报表&quot;,dealed:&quot;处理&quot;,movement:&quot;里程&quot;,
viewpos:&quot;查看位置&quot;,timelywarntit:&quot;报警信息&quot;,icon:&quot;选择图标&quot;,format:&quot;格式&quot;,phone:&quot;联系电话&quot;,contact:&quot;联系人&quot;,address:&quot;地址&quot;,oSpeed:&quot;超速&quot;,updateMsg:&quot;更新信息&quot;,
adduwait:&quot;添加客户信息&quot;,addutit:&quot;新增客户&quot;,cardNum:&quot;卡号&quot;,carNum:&quot;车牌号&quot;,pCompany:&quot;所属客户&quot;,updateUTit:&quot;更新客户信息&quot;,grate:&quot;级别&quot;,companyName:&quot;客户名称&quot;,SuperCustom:&quot;上级客户&quot;,tagInfo:&quot;设备信息&quot;,tagName:&quot;设备名&quot;,cmdDetail:&quot;指令详细信息&quot;,inputTip:&quot;请输入设备名/IMEI号&quot;
}</pre>
<p><br>
underscore.js-v=1.0.1.1</p>
<p>/*<br>
&nbsp;* 通用脚本库<br>
&nbsp;* 引入目的：解决内存泄漏问题，提升脚本执行性能。<br>
&nbsp;*/<br>
function _(id){<br>
&nbsp;return document.getElementById(id);<br>
}<br>
/*<br>
&nbsp;* @description 跨浏览器getElementsByClassName实现<br>
&nbsp;* @param searchClass&nbsp; '{tag}.{className}'<br>
&nbsp;* @param node 共搜索的的目标父节点<br>
&nbsp;*/<br>
_._ = function (searchClass, node) {<br>
&nbsp;var result = [], sc = searchClass.split('.'), tag;<br>
&nbsp;if(sc.length ===2){<br>
&nbsp;&nbsp;searchClass = sc[1];<br>
&nbsp;&nbsp;tag = sc[0]||'*';<br>
&nbsp;}else{<br>
&nbsp;&nbsp;return null;<br>
&nbsp;}<br>
&nbsp;if(document.getElementsByClassName){<br>
&nbsp;&nbsp;var nodes =&nbsp; (node || document).getElementsByClassName(searchClass);<br>
&nbsp;&nbsp;for(var i=0 ;node = nodes[i&#43;&#43;];){<br>
&nbsp;&nbsp;&nbsp;if(tag !== &quot;*&quot; &amp;&amp; node.tagName === tag.toUpperCase()){<br>
&nbsp;&nbsp;&nbsp;&nbsp;result.push(node);<br>
&nbsp;&nbsp;&nbsp;}else{<br>
&nbsp;&nbsp;&nbsp;&nbsp;result.push(node);<br>
&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp; }else{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( node == null )<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; node = document;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var els = node.getElementsByTagName(tag);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var elsLen = els.length;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var pattern = new RegExp(&quot;(^|\\s)&quot;&#43;searchClass&#43;&quot;(<a href="file://\\s|$">\\s|$</a>)&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i = 0, j = 0; i &lt; elsLen; i&#43;&#43;) {<br>
&nbsp;&nbsp;&nbsp;if ( pattern.test(els[i].className) ) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;result[j] = els[i];<br>
&nbsp;&nbsp;&nbsp;&nbsp;j&#43;&#43;;<br>
&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; }<br>
&nbsp;return result;<br>
};<br>
/*<br>
&nbsp;* @description 判断是否是IE，如果是返回具体版本号<br>
&nbsp;* @return IE的版本号，W3C系列返回undefined<br>
&nbsp;* */<br>
_.isIE = (function(){<br>
&nbsp;&nbsp;&nbsp; var undef, v = 3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; div = document.createElement('div'),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; all = div.getElementsByTagName('i');<br>
&nbsp;&nbsp;&nbsp; while (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; div.innerHTML = '&lt;!--[if gt IE ' &#43; (&#43;&#43;v) &#43; ']&gt;&lt;i&gt;&lt;/i&gt;&lt;![endif]--&gt;',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; all[0]<br>
&nbsp;&nbsp;&nbsp; );<br>
&nbsp;&nbsp;&nbsp; return v &gt; 4 ? v : undef;<br>
}());<br>
/*<br>
&nbsp;* @description 判断是否是数组<br>
&nbsp;*/<br>
_.isArray = function(o){<br>
&nbsp;return Object.prototype.toString.call(o) === '[object Array]';<br>
};<br>
/*<br>
&nbsp;* @description 批量设置样式表<br>
&nbsp;* @param el HTML节点<br>
&nbsp;* @param cssText style样式<br>
&nbsp;* @param overWrite 是否重写现有节点style属性，默认为false<br>
&nbsp;*/<br>
_.css = function (el,cssText,overWrite){<br>
&nbsp;if(el&amp;&amp;el.style){<br>
&nbsp;&nbsp;if(overWrite)<br>
&nbsp;&nbsp;&nbsp;el.style.cssText = cssText;<br>
&nbsp;&nbsp;else<br>
&nbsp;&nbsp;&nbsp;el.style.cssText &#43;= ';'&#43; cssText;<br>
&nbsp;}<br>
};<br>
/*<br>
&nbsp;* @description 动态插入样式表到head<br>
&nbsp;* @param cssText css<br>
&nbsp;* @param id style节点id<br>
&nbsp;*/<br>
_.css.append = function(cssText,id){<br>
&nbsp;var css = document.createElement('style') ,head = document.head || document.getElementsByTagName(&quot;head&quot;)[0];<br>
&nbsp;if(id){<br>
&nbsp;&nbsp;css.setAttribute('id',id);<br>
&nbsp;}<br>
&nbsp;&nbsp;&nbsp; css.setAttribute('type', 'text/css');<br>
&nbsp;//IE<br>
&nbsp;&nbsp;&nbsp; if(css.styleSheet) { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; css.styleSheet.cssText = cssText;<br>
&nbsp;&nbsp;&nbsp; } else { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; css.appendChild(document.createTextNode(cssText));<br>
&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; head.appendChild(css);<br>
};<br>
/*<br>
&nbsp;* @description 切换样式表，移除所有包含此样式的元素；给当前节点加上此样式<br>
&nbsp;* @param node 当前节点<br>
&nbsp;* @param clas 样式表<br>
&nbsp;* @param context 移除样式表元素的父节点<br>
&nbsp;*/<br>
_.css.toggle = function(node,cls,context){<br>
&nbsp;context = context || document.body;<br>
&nbsp;var clsArr = cls.split('.');<br>
&nbsp;if(clsArr.length !=2)return;<br>
&nbsp;var tag = clsArr[0], className = clsArr[1];<br>
&nbsp;var olds = _._(cls,context), len = olds.length, i = 0;<br>
&nbsp;for(;i&lt;len;i&#43;&#43;){<br>
&nbsp;&nbsp;olds[i].className = olds[i].className.replace(className,'');<br>
&nbsp;}<br>
&nbsp;var current = node.className;<br>
&nbsp;if(current.indexOf(className)== -1){<br>
&nbsp;&nbsp;node.className = current&#43; ' ' &#43; className;<br>
&nbsp;}<br>
};<br>
_.dom = function(){};<br>
/**<br>
&nbsp;* @description 调用此方法来保证插入节点后再设置节点的innerHTML，避免在IE中的内存泄漏<br>
&nbsp;*/<br>
_.dom.append = function(parent,tagName){<br>
&nbsp;var node = document.createElement(tagName);<br>
&nbsp;parent.appendChild(node);<br>
&nbsp;return node;<br>
};<br>
/*<br>
&nbsp;* @description 采用ext的处理方式，也可以对删除的元素使用outerHTML=''，但是此方法不通用，某些元素的outerHTML属性只读<br>
&nbsp;* @param n 要删除的HTML节点<br>
&nbsp;*/<br>
_.dom.remove = function(n){<br>
&nbsp;var d;<br>
&nbsp;if(_.isIE){<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(n &amp;&amp; n.tagName != 'BODY'){<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; d = d || document.createElement('div');<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; d.appendChild(n);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; d.innerHTML = '';<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;}else{<br>
&nbsp;&nbsp;&nbsp;&nbsp; if(n &amp;&amp; n.parentNode &amp;&amp; n.tagName != 'BODY'){<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; n.parentNode.removeChild(n);<br>
&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;}<br>
};<br>
/*<br>
&nbsp;* @description 移除要删除节点的所有事件，防止IE内存泄漏<br>
&nbsp;* @param d 要删除的节点<br>
&nbsp;*/<br>
_.dom.purdge = function(d){<br>
&nbsp;&nbsp;&nbsp; var a = d.attributes, i, l, n;<br>
&nbsp;&nbsp;&nbsp; if (a) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; l = a.length;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i = 0; i &lt; l; i &#43;= 1) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; n = a[i].name;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (typeof d[n] === 'function') {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; d[n] = null;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; a = d.childNodes;<br>
&nbsp;&nbsp;&nbsp; if (a) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; l = a.length;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i = 0; i &lt; l; i &#43;= 1) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _.dom.purdge(d.childNodes[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; }<br>
};<br>
_.ajax = function(){};<br>
/******** JSONP轮询内存泄漏 ********<br>
&nbsp;* 为IE添加重用的动态script标签，标准浏览器无法重用script标签<br>
&nbsp;* 重用的script标签可能被占用，也可能请求时发送网络错误，因此需要添加额外的处理机制；<br>
&nbsp;* W3C浏览器JSONP没有内存泄漏，所以onload完成后直接删除即可。<br>
&nbsp;*/<br>
//TODO:为标准浏览器添加onerror统计超时请求，<br>
(function(){<br>
&nbsp;&nbsp;&nbsp; //存储超时或异常的JSONP请求<br>
&nbsp;&nbsp;&nbsp; _.ajax.TIMEOUT_REQUEST = [];<br>
&nbsp;if(_.isIE){<br>
&nbsp;&nbsp;//JSONP重用标签的id<br>
&nbsp;&nbsp;_.ajax.SCRIPT_ID = 'ie_script_for_jsonp';<br>
&nbsp;&nbsp;//重用标签是否被JSONP请求占用<br>
&nbsp;&nbsp;_.ajax.SCRIPT_USED = false;<br>
&nbsp;&nbsp;//被占用时JSONP请求等待的时间<br>
&nbsp;&nbsp;_.ajax.WAIT_TIME = 100;<br>
&nbsp;&nbsp;//超时设定<br>
&nbsp;&nbsp;_.ajax.TIMEOUT = 1500;</p>
<p>&nbsp;&nbsp;//上次JSONP请求的时间<br>
&nbsp;&nbsp;_.ajax.LAST_USED_TIME = 0;<br>
&nbsp;&nbsp;var script = document.createElement('script'), head = document.head || document.getElementsByTagName('head')[0];<br>
&nbsp;&nbsp;script.setAttribute('id',_.ajax.SCRIPT_ID);<br>
&nbsp;&nbsp;script.onreadystatechange = function(){<br>
&nbsp;&nbsp;&nbsp;if (this.readyState == &quot;loaded&quot; || this.readyState == &quot;complete&quot;){<br>
&nbsp;&nbsp;&nbsp;&nbsp;_.ajax.SCRIPT_USED = false;<br>
&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;};<br>
&nbsp;&nbsp;head.appendChild(script);<br>
&nbsp;}<br>
})();<br>
/*<br>
&nbsp;* @description 轮询JSONP请求调用，IE浏览器采用重用Script节点方式。<br>
&nbsp;* @param url 手动加上callback参数，自动追加了时间戳<br>
&nbsp;*/<br>
_.ajax.jsonp = function(url){<br>
&nbsp;var script, now = new Date().getTime(), <br>
&nbsp;&nbsp;requestUrl = url &#43; (url.indexOf('?')&gt;-1?'&amp;timestamp=':'?timestamp=') &#43; now,<br>
&nbsp;&nbsp;head = document.head || document.getElementsByTagName('head')[0];<br>
&nbsp;if(_.isIE){<br>
&nbsp;&nbsp;script = document.getElementById(_.ajax.SCRIPT_ID);<br>
&nbsp;&nbsp;//节点被占用<br>
&nbsp;&nbsp;if(_.ajax.SCRIPT_USED){<br>
&nbsp;&nbsp;&nbsp;if(_.ajax.LAST_USED_TIME === 0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;_.ajax.LAST_USED_TIME = now;<br>
&nbsp;&nbsp;&nbsp;//已经超时<br>
&nbsp;&nbsp;&nbsp;if((now - _.ajax.LAST_USED_TIME) &gt; _.ajax.TIMEOUT){<br>
&nbsp;&nbsp;&nbsp;&nbsp;_.ajax.LAST_USED_TIME = now;<br>
&nbsp;&nbsp;&nbsp;&nbsp;if(_.ajax.TIMEOUT_REQUEST.length&gt;=1000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_.ajax.TIMEOUT_REQUEST.length = 0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;_.ajax.TIMEOUT_REQUEST.push(script.src.split('&amp;timestamp=')[0]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;script.src = requestUrl;<br>
&nbsp;&nbsp;&nbsp;//没有超时则等待<br>
&nbsp;&nbsp;&nbsp;}else{<br>
&nbsp;&nbsp;&nbsp;&nbsp;setTimeout(function(){_.ajax.jsonp(url);},_.ajax.WAIT_TIME);<br>
&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;}else{<br>
&nbsp;&nbsp;&nbsp;_.ajax.SCRIPT_USED = true;<br>
&nbsp;&nbsp;&nbsp;_.ajax.LAST_USED_TIME = now;<br>
&nbsp;&nbsp;&nbsp;script.src = requestUrl;<br>
&nbsp;&nbsp;}<br>
&nbsp;}else{<br>
&nbsp;&nbsp;script = document.createElement('script');<br>
&nbsp;&nbsp;head.appendChild(script);<br>
&nbsp;&nbsp;script.onload =&nbsp;function(){<br>
&nbsp;&nbsp;&nbsp;this.onload = null;<br>
&nbsp;&nbsp;&nbsp;this.parentNode.removeChild(this);<br>
&nbsp;&nbsp;};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; script.onerror = function(){<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _.ajax.TIMEOUT_REQUEST.push(this.src);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br>
&nbsp;&nbsp;script.src = requestUrl;<br>
&nbsp;}<br>
};<br>
/*<br>
&nbsp;* @description 获取远程脚本，只适合加载一次的脚本，轮询请使用_.ajax.jsonp。JSONP请求默认加上时间戳；普通AJAX不加时间戳<br>
&nbsp;* @param callback JSONP加载脚本的回调函数<br>
&nbsp;* */<br>
_.ajax.getScript = function(url,callback){<br>
&nbsp;var script, head = document.head || document.getElementsByTagName('head')[0], now = new Date().getTime();<br>
&nbsp;script = _.dom.append(head,'script');<br>
&nbsp;if(callback){<br>
&nbsp;&nbsp;if(url.indexOf(&quot;?&quot;)&gt;-1){<br>
&nbsp;&nbsp;&nbsp;url = &quot;&amp;callback=&quot; &#43; callback ;<br>
&nbsp;&nbsp;}else{<br>
&nbsp;&nbsp;&nbsp;url = &quot;?callback=&quot; &#43; callback ;<br>
&nbsp;&nbsp;}<br>
&nbsp;}<br>
&nbsp;//如果是JSONP<br>
&nbsp;if(url.indexOf('callback=')&gt;0){<br>
&nbsp;&nbsp;url &#43;= &quot;&amp;timestamp=&quot; &#43; now;<br>
&nbsp;}<br>
&nbsp;script.src = url;<br>
};<br>
/*<br>
&nbsp;* @description 获取多个远程脚本文件，只适合加载一次。轮询请使用_.ajax.jsonp<br>
&nbsp;* */<br>
_.ajax.getScripts = function(urlArray){<br>
&nbsp;if(_.isArray(urlArray)){<br>
&nbsp;&nbsp;for(var index in urlArray){<br>
&nbsp;&nbsp;&nbsp;_.ajax.getScript(urlArray[index]);<br>
&nbsp;&nbsp;}<br>
&nbsp;}<br>
};<br>
/*<br>
&nbsp;* @description 类继承，子类持有父类原型<br>
&nbsp;* @param child 子类<br>
&nbsp;* @param parent 父类<br>
&nbsp;*/<br>
_.extend =&nbsp; function(child,parent) {<br>
&nbsp;var F = function() {};<br>
&nbsp;F.prototype = parent.prototype;<br>
&nbsp;child.prototype = new F();<br>
&nbsp;child.prototype.constructor = child;<br>
&nbsp;//hold parent prototype ref<br>
&nbsp;child.pp = parent.prototype;<br>
};<br>
/*<br>
&nbsp;* @description 复写子类的方法，如果父类有该方法，增强匿名函数的参数与父类函数参数顺序一致。如果增强函数有返回&#20540;，则默认返回。<br>
&nbsp;* @param className 类名<br>
&nbsp;* @param methodName 要复写的方法名称<br>
&nbsp;* @param extraFunc 额外执行的函数，上下文环境为className的实例<br>
&nbsp;*/<br>
_.extendM = function(className,methodName,extraFunc){<br>
&nbsp;//如果有父类且父类有同名的方法<br>
&nbsp;if(className.pp &amp;&amp; className.pp[methodName]){<br>
&nbsp;&nbsp;className.prototype[methodName] = function(){<br>
&nbsp;&nbsp;&nbsp;var result = extraFunc.apply(this,arguments);<br>
&nbsp;&nbsp;&nbsp;className.pp[methodName].apply(this,arguments);<br>
&nbsp;&nbsp;&nbsp;return result;<br>
&nbsp;&nbsp;};<br>
&nbsp;}<br>
&nbsp;else{<br>
&nbsp;&nbsp;className.prototype[methodName] = function(){<br>
&nbsp;&nbsp;&nbsp;return extraFunc.apply(this,arguments);<br>
&nbsp;&nbsp;};<br>
&nbsp;}<br>
};<br>
_.trim = function(text){<br>
&nbsp;if(String.prototype.trim){<br>
&nbsp;&nbsp;return text == null ?&quot;&quot; :String.prototype.trim.call(text);<br>
&nbsp;}else{<br>
&nbsp;&nbsp;return text == null ?&quot;&quot; :text.toString().replace( /^\s&#43;/, &quot;&quot; ).replace(&nbsp; /\s&#43;$/, &quot;&quot; );<br>
&nbsp;}<br>
};<br>
/*<br>
&nbsp;* @description from jquery.cookie.js<br>
&nbsp;* @param options {expires,path,domain,secure}<br>
&nbsp;*/<br>
_.cookie = function(name,value,options){<br>
&nbsp; if (typeof value != 'undefined') { // name and value given, set cookie<br>
&nbsp;&nbsp;&nbsp;&nbsp; options = options || {};<br>
&nbsp;&nbsp;&nbsp;&nbsp; if (value === null) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = '';<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; options.expires = -1;<br>
&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp; var expires = '';<br>
&nbsp;&nbsp;&nbsp;&nbsp; if (options.expires &amp;&amp; (typeof options.expires == 'number' || options.expires.toUTCString)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var date;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (typeof options.expires == 'number') {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; date = new Date();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; date.setTime(date.getTime() &#43; (options.expires * 24 * 60 * 60 * 1000));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; date = options.expires;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; expires = '; expires=' &#43; date.toUTCString(); // use expires attribute, max-age is not supported by IE<br>
&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp; var path = options.path ? '; path=' &#43; options.path : '';<br>
&nbsp;&nbsp;&nbsp;&nbsp; var domain = options.domain ? '; domain=' &#43; options.domain : '';<br>
&nbsp;&nbsp;&nbsp;&nbsp; var secure = options.secure ? '; secure' : '';<br>
&nbsp;&nbsp;&nbsp;&nbsp; document.cookie = [name, '=', encodeURIComponent(value), expires, path, domain, secure].join('');<br>
&nbsp;} else { // only name given, get cookie<br>
&nbsp;&nbsp;&nbsp;&nbsp; var cookieValue = '';<br>
&nbsp;&nbsp;&nbsp;&nbsp; if (document.cookie &amp;&amp; document.cookie != '') {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var cookies = document.cookie.split(';');<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (var i = 0; i &lt; cookies.length; i&#43;&#43;) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var cookie = _.trim(cookies[i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Does this cookie string begin with the name we want?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (cookie.substring(0, name.length &#43; 1) == (name &#43; '=')) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cookieValue = decodeURIComponent(cookie.substring(name.length &#43; 1));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp; return cookieValue;<br>
&nbsp;}<br>
};</p>
<p>popupmarker.js-v=1.0.1.1</p>
<pre class="javascript" name="code">PopupMarker.IS_BAIDU_MAP = typeof BMap !=='undefined';
PopupMarker.YPOS = 0;
PopupMarker.LEFT_TOP_HEIGHT = 7;
PopupMarker.YPOS2 = PopupMarker.YPOS + PopupMarker.LEFT_TOP_HEIGHT;
PopupMarker.POPUP_TBL = {
		leftTop : {&quot;left&quot; : 0,&quot;top&quot; : PopupMarker.YPOS,&quot;width&quot; : 19,&quot;height&quot; : PopupMarker.LEFT_TOP_HEIGHT},
		leftTopFill : {&quot;left&quot; : 16,&quot;top&quot; : 3,&quot;width&quot; : 4,&quot;height&quot; : 4},
		rightTop : {&quot;left&quot; : 19,&quot;top&quot; : PopupMarker.YPOS,&quot;width&quot; : 10,&quot;height&quot; : PopupMarker.LEFT_TOP_HEIGHT},
		rightTopImg : {&quot;left&quot; : -125,&quot;top&quot; : 0,&quot;width&quot; : 10,&quot;height&quot; : PopupMarker.LEFT_TOP_HEIGHT},
		centerTopFill : {&quot;left&quot; : 19,&quot;top&quot; : PopupMarker.YPOS,&quot;width&quot; : 0,&quot;height&quot; : PopupMarker.LEFT_TOP_HEIGHT},
		leftBody : {&quot;left&quot; : 11,&quot;top&quot; : PopupMarker.YPOS2,&quot;width&quot; : 8,&quot;height&quot; : 0},
		centerBodyFill : {&quot;left&quot; : 19,&quot;top&quot; : PopupMarker.YPOS2,&quot;width&quot; : 40,&quot;height&quot; : 15},
		rightBody : {&quot;left&quot; : 19,&quot;top&quot; : PopupMarker.YPOS2,&quot;width&quot; : 9,&quot;height&quot; : 0},
		leftBottom : {&quot;left&quot; : 0,&quot;top&quot; : PopupMarker.YPOS2,&quot;width&quot; : 20,&quot;height&quot; : 21},
		leftBottomImg : {&quot;left&quot; : 0,&quot;top&quot; : -13,&quot;width&quot; : 20,&quot;height&quot; : 21},
		leftBottomFill : {&quot;left&quot; : 16,&quot;top&quot; : 0,&quot;width&quot; : 4,&quot;height&quot; : 6},
		rightBottom : {&quot;left&quot; : 19,&quot;top&quot; : PopupMarker.YPOS2,&quot;width&quot; : 10,&quot;height&quot; : PopupMarker.LEFT_TOP_HEIGHT},
		rightBottomImg : {&quot;left&quot; : -125,&quot;top&quot; : -13,&quot;width&quot; : 10,&quot;height&quot; : PopupMarker.LEFT_TOP_HEIGHT},
		centerBottomFill : {&quot;left&quot; : 19,&quot;top&quot; : (PopupMarker.YPOS2 + (_.isIE ? -1 : 0)),&quot;width&quot; : 0,&quot;height&quot; : (6 + (_.isIE ? 1 : 0))}
};
PopupMarker.prototype =PopupMarker.IS_BAIDU_MAP?(new BMap.Overlay()):(new google.maps.OverlayView());
/*
 * @decription setMap填充覆盖物到地图放在最后一步，百度似乎有点问题
 * @param opts {map:goome.maps.Map,position:goome.maps.LatLng,text:string}
 */
function PopupMarker(opts) {
    this.ICON_WIDTH = opts.ICON_WIDTH||12;
    this.ICON_HEIGHT =opts.ICON_HEIGHT|| 20;
    this.map_ = opts.map;
    this.latlng_ = opts.position;
    this.icon_ = opts.icon;
    this.text_ = opts.text || &quot;&quot;;
    this.showpop = opts.showpop || false;
    this.popupImgSrc_ = &quot;images/1280.png&quot;;
    //是否已经执行过updatePopLayerText，在此函数结束时设置为true
    this.updatedPop = false;
	if(document.getElementById('dummyTextNode')) {
		this.dummyTextNode = document.getElementById('dummyTextNode');
	}
	else{
		var dummyTextNode = document.createElement(&quot;span&quot;);
		dummyTextNode.id = 'dummyTextNode';
		dummyTextNode.style.display = 'none';
		this.map_.getDiv().appendChild(dummyTextNode);
		this.dummyTextNode = dummyTextNode;
		dummyTextNode =null;
	}
	this.setMap(PopupMarker.IS_BAIDU_MAP?this.map_:this.map_._source);
};
//百度需要额外推荐一些方法
if(PopupMarker.IS_BAIDU_MAP){
	PopupMarker.prototype.initialize = function(map){
		var spanContainer = document.createElement(&quot;span&quot;);
	    this.container_ = document.createElement(&quot;div&quot;);
	    this.iconContainer = document.createElement(&quot;div&quot;);
	    
	    var panes = this.map_._source.getPanes();
	    panes.floatShadow.appendChild(spanContainer);
		spanContainer.appendChild(this.iconContainer);
		spanContainer.appendChild(this.container_);
		
	    this.iconContainer.style.width = this.ICON_WIDTH + &quot;px&quot;;
	    this.iconContainer.style.height = this.ICON_HEIGHT + &quot;px&quot;;
	    this.iconContainer.innerHTML = &quot;&lt;img src='&quot; + this.icon_ + &quot;'&gt;&quot;;
	    this.iconContainer.style.position = &quot;absolute&quot;;
	    
	    //panes.floatPane.appendChild(this.container_);
	    this.container_.style.position = &quot;absolute&quot;;
	    if (!this.showpop) this.container_.style.visibility = &quot;hidden&quot;;
	    this.makeNormalPopup_();
		return spanContainer;
		//this.onAdd();
	};
	PopupMarker.prototype.setMap = function(obj){
		if(obj==null)
			this.map_._source.removeOverlay(this);
		else{
			obj._source.addOverlay(this);
		}
	};
}
PopupMarker.prototype.onAdd = function() {
    this.container_ = document.createElement(&quot;div&quot;);
    this.iconContainer = document.createElement(&quot;div&quot;);
    var panes = this.getPanes?this.getPanes():this.map_._source.getPanes();
    panes.floatShadow.appendChild(this.iconContainer);
    panes.floatPane.appendChild(this.container_);
    
    this.iconContainer.style.width = this.ICON_WIDTH + &quot;px&quot;;
    this.iconContainer.style.height = this.ICON_HEIGHT + &quot;px&quot;;
    this.iconContainer.innerHTML = &quot;&lt;img src='&quot; + this.icon_ + &quot;'&gt;&quot;;
    this.iconContainer.style.position = &quot;absolute&quot;;

    this.container_.style.position = &quot;absolute&quot;;
    if (!this.showpop) this.container_.style.visibility = &quot;hidden&quot;;
    this.makeNormalPopup_();
};
PopupMarker.prototype.draw = function() {
    this.redrawNormalPopup_(this.text_);
};
PopupMarker.prototype.onRemove = function() {
	_.dom.remove(this.container_);
	_.dom.remove(this.iconContainer);
};

PopupMarker.prototype.makeNormalPopup_ = function() {
	var frag = document.createDocumentFragment();
	//0
    var leftTop_ = this.makeImgDiv_(this.popupImgSrc_, PopupMarker.POPUP_TBL.leftTop);
    leftTop_.appendChild(this.fillDiv_(PopupMarker.POPUP_TBL.leftTopFill));
    frag.appendChild(leftTop_);
	//1
    var leftBody_ = this.fillDiv_(PopupMarker.POPUP_TBL.leftBody);
	_.css(leftBody_ ,'border-width:0 0 0 1px;border-style:none none none solid;border-color:#000');
    frag.appendChild(leftBody_);
	//2
    var leftBottom_ = this.makeImgDiv_(this.popupImgSrc_, PopupMarker.POPUP_TBL.leftBottomImg);
    leftBottom_.appendChild(this.fillDiv_(PopupMarker.POPUP_TBL.leftBottomFill));
	_.css(leftBottom_ ,'left:'+PopupMarker.POPUP_TBL.leftBottom.left +'px;top:'+PopupMarker.POPUP_TBL.leftBottom.top +'px;width:'+PopupMarker.POPUP_TBL.leftBottom.width +'px;height:'+PopupMarker.POPUP_TBL.leftBottom.height +'px;');
    frag.appendChild(leftBottom_);
	//3
    var bodyContainer_ = document.createElement(&quot;div&quot;);
	_.css(bodyContainer_ ,'position:absolute;background-color:#fff;overflow:hidden;left:'+PopupMarker.POPUP_TBL.centerBodyFill.left +'px;top:'+PopupMarker.POPUP_TBL.centerBodyFill.top +'px;width:'+PopupMarker.POPUP_TBL.centerBodyFill.width +'px;height:'+PopupMarker.POPUP_TBL.centerBodyFill.height +'px;');
    frag.appendChild(bodyContainer_);
	//4
    var rightTop_ = this.makeImgDiv_(this.popupImgSrc_, PopupMarker.POPUP_TBL.rightTopImg);
	_.css(rightTop_ ,'left:'+PopupMarker.POPUP_TBL.rightTop.left +'px;top:'+PopupMarker.POPUP_TBL.rightTop.top +'px;width:'+PopupMarker.POPUP_TBL.rightTop.width +'px;height:'+PopupMarker.POPUP_TBL.rightTop.height +'px;');
    frag.appendChild(rightTop_);
	//5
    var rightBottom_ = this.makeImgDiv_(this.popupImgSrc_, PopupMarker.POPUP_TBL.rightBottomImg);
	_.css(rightBottom_ ,'left:'+PopupMarker.POPUP_TBL.rightBottom.left +'px;top:'+PopupMarker.POPUP_TBL.rightBottom.top +'px;width:'+PopupMarker.POPUP_TBL.rightBottom.width +'px;height:'+PopupMarker.POPUP_TBL.rightBottom.height +'px;');
    frag.appendChild(rightBottom_);
	//6
    var rightBody_ = this.fillDiv_(PopupMarker.POPUP_TBL.rightBody);
	_.css(rightBody_ ,'border-width:0 1px 0 0;border-style:none solid none none;border-color:#000');
    frag.appendChild(rightBody_);
	//7
    var centerBottom_ = this.fillDiv_(PopupMarker.POPUP_TBL.centerBottomFill);
	_.css(centerBottom_ ,'border-width:0 0 1px 0;border-style:none none solid none;border-color:#000');
    frag.appendChild(centerBottom_);
	//8
    var centerTop_ = this.fillDiv_(PopupMarker.POPUP_TBL.centerTopFill);
	_.css(centerTop_ ,'border-width:1px 0 0 0;border-style:solid none none none;border-color:#000');
    frag.appendChild(centerTop_);
	
	this.container_.appendChild(frag);
};
PopupMarker.prototype.redrawNormalPopup_ = function(text) {
    if (this.beforeNormalPopupText_ !== text) {
		var bodyContainer_ = this.container_.children[3],
			leftBottom_ = this.container_.children[2],
			leftBody_ = this.container_.children[1],
			rightTop_ = this.container_.children[4],
			rightBottom_ = this.container_.children[5],
			rightBody_ = this.container_.children[6],
			centerBottom_ = this.container_.children[7],
			centerTop_ = this.container_.children[8];
        bodyContainer_.innerHTML = text;
        if (!_.isIE &amp;&amp; text) {
            if (bodyContainer_.firstChild.nodeType === 1) {
                bodyContainer_.firstChild.style.margin = 0;
            }
        }
        var offsetBorder = _.isIE ? 2: 0;
        var cSize = this.getHtmlSize_(text);
        var rightX = PopupMarker.POPUP_TBL.leftTop.width + cSize.width;
        leftBottom_.style.top = (cSize.height + PopupMarker.POPUP_TBL.leftBody.top) + &quot;px&quot;;
        leftBody_.style.height = cSize.height + &quot;px&quot;;
        bodyContainer_.style.width = cSize.width + &quot;px&quot;;
        bodyContainer_.style.height = cSize.height + &quot;px&quot;;
        bodyContainer_.style.top = PopupMarker.POPUP_TBL.leftBody.top;
        rightTop_.style.left = rightX + &quot;px&quot;;
        rightBottom_.style.left = rightTop_.style.left;
        rightBottom_.style.top = leftBottom_.style.top;
        rightBody_.style.left = rightX + &quot;px&quot;;
        rightBody_.style.height = leftBody_.style.height;
        centerBottom_.style.top = leftBottom_.style.top;
        centerBottom_.style.width = cSize.width + &quot;px&quot;;
        centerTop_.style.width = cSize.width + &quot;px&quot;;
        this.size_ = {
            &quot;width&quot;: (rightX + PopupMarker.POPUP_TBL.rightTop.width),
            &quot;height&quot;: (cSize.height + PopupMarker.POPUP_TBL.leftTop.height + PopupMarker.POPUP_TBL.leftBottom.height)
        };
        this.container_.style.width = this.size_.width + &quot;px&quot;;
        this.container_.style.height = this.size_.height + &quot;px&quot;;
    }
    bodyContainer_ = leftBottom_ = leftBody_ = rightTop_ = rightBottom_ = rightBody_ = centerBottom_ = centerTop_ = null;
    this.setPosition(this.latlng_);
    this.beforeNormalPopupText_ = text;
};

/*
 * @description 获得文字内容的基本宽度和高度，如果遇见marker没有正确的显示出来，很有可能是这里出问题了
 * @return goome.maps.Size
 */
PopupMarker.prototype.getHtmlSize_ = function(html) {
    var size = {};
	this.dummyTextNode.innerHTML = html;
	this.dummyTextNode.style.display = '';
	size.width = this.dummyTextNode.offsetWidth;
	size.height = this.dummyTextNode.offsetHeight;
	this.dummyTextNode.style.display = 'none';
    var ret, lines = html.split(/\n/i), totalSize = new goome.maps.Size(1, 1);
    for (var i = 0; i &lt; lines.length; i++) {
        totalSize.width += size.width;
        totalSize.height += size.height;
    }
	return totalSize;
};
PopupMarker.prototype.makeImgDiv_ = function(imgSrc, params) {
    var imgDiv = document.createElement(&quot;div&quot;);
    imgDiv.style.position = &quot;absolute&quot;;
    imgDiv.style.overflow = &quot;hidden&quot;;
    if (params.width) {
        imgDiv.style.width = params.width + &quot;px&quot;;
    }
    if (params.height) {
        imgDiv.style.height = params.height + &quot;px&quot;;
    }
    var img = null;
    if (!_.isIE) {
        img = new Image();
        img.src = imgSrc;

    } else {
        img = document.createElement(&quot;div&quot;);
        if (params.width) {
            img.style.width = params.width + &quot;px&quot;;

        }
        if (params.height) {
            img.style.height = params.height + &quot;px&quot;;
        }
    }
    img.style.position = &quot;relative&quot;;
    img.style.left = params.left + &quot;px&quot;;
    img.style.top = params.top + &quot;px&quot;;
    img.style.filter = &quot;progid:DXImageTransform.Microsoft.AlphaImageLoader(src='&quot; + imgSrc + &quot;')&quot;;
    imgDiv.appendChild(img);
    img = null;
    return imgDiv;
};
PopupMarker.prototype.fillDiv_ = function(params) {
    var bgDiv = document.createElement(&quot;div&quot;);
    bgDiv.style.position = &quot;absolute&quot;;
    bgDiv.style.backgroundColor = &quot;#FFF&quot;;
    bgDiv.style.fontSize = &quot;1px&quot;;
    bgDiv.style.lineHeight = &quot;1px&quot;;
    bgDiv.style.overflow = &quot;hidden&quot;;
    bgDiv.style.left = params.left + &quot;px&quot;;
    bgDiv.style.top = params.top + &quot;px&quot;;
    bgDiv.style.width = params.width + &quot;px&quot;;
    bgDiv.style.height = params.height + &quot;px&quot;;
    return bgDiv;
};
PopupMarker.prototype.hide = function() {
    if (this.container_) {
        this.container_.style.visibility = &quot;hidden&quot;;
    }
};
PopupMarker.prototype.show = function() {
    if (this.container_) {
        this.container_.style.visibility = &quot;visible&quot;;
    }
};
PopupMarker.prototype.toggle = function() {
    if (this.container_) {
        if (this.container_.style.visibility == &quot;hidden&quot;) {
            this.show();
        } else {
            this.hide();
        }
    }
};
PopupMarker.prototype.setPosition = function(latlng) {
	if(!latlng._source){
		throw Error('PopupMarker:use wrapped LatLng');
	}
    var pxPos = this.map_.fromLatLngToDivPixel(latlng);
    this.container_.style.left = pxPos.x + &quot;px&quot;;
    this.container_.style.top = (pxPos.y - this.size_.height) + &quot;px&quot;;
    var icon = this.icon_;
    if(icon.indexOf('east')&gt;-1){
	    this.iconContainer.style.left = (pxPos.x - this.ICON_WIDTH * 0.75) + &quot;px&quot;;	
    }else{
	    this.iconContainer.style.left = (pxPos.x - this.ICON_WIDTH / 2) + &quot;px&quot;;
    }
    this.iconContainer.style.top = (pxPos.y - this.ICON_HEIGHT) + &quot;px&quot;;	
	this.latlng_ = latlng;
};
PopupMarker.prototype.update = function(obj) {
    if ((typeof obj.icon) != &quot;undefined&quot;) {
		if(this.icon_!=obj.icon){
        	this.iconContainer.innerHTML = &quot;&lt;img src='&quot; + obj.icon + &quot;'&gt;&quot;;
			this.icon_ = obj.icon;
		}
    }
    if ((typeof obj.position) != &quot;undefined&quot;) {
        this.latlng_ = obj.position;
        this.setPosition(this.latlng_);
    }
    if ((typeof obj.text) != &quot;undefined&quot;) {
        this.text_ = obj.text;
        this.redrawNormalPopup_(obj.text);

    }
};
PopupMarker.prototype.setZIndex = function(index) {
    this.container_.style.zIndex = index;
    this.iconContainer.style.zIndex = index;
};
PopupMarker.prototype.latlng = function() {
    return this.latlng_;
};
PopupMarker.prototype.hideMarker = function(){
	this.container_.style.visibility = &quot;hidden&quot;;
    this.iconContainer.style.visibility = &quot;hidden&quot;;
};
PopupMarker.prototype.showMarker = function(){
	this.container_.style.visibility = &quot;visible&quot;;
    this.iconContainer.style.visibility = &quot;visible&quot;;
};</pre>
<p><br>
core.js-v=1.0.1.1</p>
<pre class="javascript" name="code">var speedForStill = [4, 10],
    mousePos = {
        x: 0,
        y: 0
    }
//,
//    geocoder = new google.maps.Geocoder();

function parseAddress(weidu, jingdu, arr, name) {
    if (document.getElementById(arr) != null) {
        geocoder.geocode({
            &quot;address&quot;: weidu + &quot;,&quot; + jingdu
        }, function (results, status) {
            _str = &quot; &quot;;
            if (status == google.maps.GeocoderStatus.OK) {
                _str = name + &quot;,&quot; + lg.p + &quot;:&quot; + results[0].formatted_address
            } else {
                _str = lg.isGetting
            }
            document.getElementById(arr).innerHTML = _str
        })
    }
}
function getHangXiang(dusu, sudu) {
    if (sudu &lt; 0 || dusu == &quot;&quot;) return &quot;......&quot;;
    var z = 5,
        fz = 10,
        p = 30;
    var hangxiang = lg.hangxiang;
    var qujian1 = [z, fz, fz, p, 90 - p, 90 - z, 90 - fz, 90 + fz, 90 + p, 180 - p, 180 - z, 180 - fz, 180 + fz, 180 + p, 270 - p, 270 - z, 270 - fz, 270 + fz, 270 + p, 360 - p];
    var qujian2 = [360 - z, 360 - fz, p, 90 - p, 90 - fz, 90 + z, 90 + fz, 90 + p, 180 - p, 180 - fz, 180 + z, 180 + fz, 180 + p, 270 - p, 270 - fz, 270 + z, 270 + fz, 270 + p, 360 - p, 360 - fz];
    for (var i = 0; i &lt; qujian1.length; i++) {
        if (i == 0 || i == 1) {
            if (qujian2[i] &lt;= dusu || dusu &lt;= qujian1[i]) return hangxiang[i]
        } else {
            if (qujian1[i] &lt;= dusu &amp;&amp; dusu &lt;= qujian2[i]) return hangxiang[i]
        }
    }
    return dusu
}
function exchangeTime(msecond) {
    var dd, hh, mm, ss;
    dd = Math.round(msecond / 86400 + 0.5) - 1;
    hh = Math.round((msecond - dd * 86400) / 3600 + 0.5) - 1;
    mm = Math.round((msecond - dd * 86400 - hh * 3600) / 60 + 0.5) - 1;
    ss = Math.round(msecond - dd * 86400 - hh * 3600 - mm * 60);
    var strtip = &quot;&quot;;
    if (dd &gt; 0) strtip = strtip + dd + lg.d;
    if (hh &gt; 0) strtip = strtip + hh + lg.h;
    if (mm &gt; 0) {
        strtip = strtip + mm + lg.m;
        if (dd &gt; 0) return strtip
    }
    if (ss &gt; 0) strtip = strtip + ss + lg.s;
    return strtip
}
function getTimeDiff(serverTime, objTime) {
    var timeDiff = (new Date((serverTime.split(&quot;.&quot;))[0].replace(/-/g, &quot;/&quot;)).getTime() - new Date((objTime.split(&quot;.&quot;))[0].replace(/-/g, &quot;/&quot;)).getTime()) / 1000;
    return timeDiff
}
function getRoom(diff) {
    var room = new Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14);
    var diffArr = new Array(360, 180, 90, 45, 22, 11, 5, 2.5, 1.25, 0.6, 0.3, 0.15, 0.07, 0.03, 0);
    for (var i = 0; i &lt; diffArr.length; i++) {
        if ((diff - diffArr[i]) &gt;= 0) {
            return room[i]
        }
    }
    return 14
}
function getCenterPoint(maxJ, minJ, maxW, minW) {
    if (maxJ == minJ &amp;&amp; maxW == minW) return [maxJ, maxW, 0];
    var diff = maxJ - minJ;
    if (diff &lt; (maxW - minW)) diff = maxW - minW;
    diff = parseInt(10000 * diff) / 10000;
    var centerJ = minJ * 1000000 + 1000000 * (maxJ - minJ) / 2;
    var centerW = minW * 1000000 + 1000000 * (maxW - minW) / 2;
    return [centerJ / 1000000, centerW / 1000000, diff]
}
function mouseCoords(ev) {
    ev = ev || window.event;
    if (ev.pageX || ev.pageY) {
        mousePos = {
            x: ev.pageX + 10,
            y: ev.pageY + 10
        }
    }
    mousePos = {
        x: ev.clientX + document.documentElement.scrollLeft - document.body.clientLeft + 10,
        y: ev.clientY + document.documentElement.scrollTop - document.body.clientTop + 10
    }
}
function getStatic(datetime, servertime, sys_time, heart_time) {
    stopover_time = getTimeDiff(servertime, datetime);
    var heart_time = getTimeDiff(servertime, heart_time);
    var dingwei_time = getTimeDiff(servertime, sys_time);
    if (dingwei_time &lt; heart_time) heart_time = dingwei_time;
    return [heart_time, stopover_time]
}
function dblclickSetRoomCenter(weidu, jingdu, map) {
    var _zoom = map.getZoom();
    if (_zoom &lt; 11) {
        map.setCenter(new google.maps.LatLng(Number(weidu), Number(jingdu)));
        map.setZoom(11)
    } else if (_zoom &gt;= 11 &amp;&amp; _zoom &lt;= 18) {
        map.setCenter(new google.maps.LatLng(Number(weidu), Number(jingdu)));
        map.setZoom(_zoom + 2)
    } else {
        alert(lg.zoomMax)
    }
}
function status_(heart_stime, speed, stopover_time, endServerTimeCount) {
    var speed = Number(speed);
    var _arr = [&quot;white&quot;, lg.srun1, 0, false];
    var oneDay = 60 * 60 * 24;
    var servenDays = -(60 * 60 * 24 * 7);
    var offlineSeconds = 900;
    if (endServerTimeCount &gt; (oneDay * 7)) {
        return [&quot;white&quot;, lg.arrear, 0, false]
    }
    var statusWord = &quot;-1&quot;;
    if (endServerTimeCount &lt;= (oneDay * 7) &amp;&amp; endServerTimeCount &gt; 0) {
        var days = (endServerTimeCount / oneDay) + lg.d;
        statusWord = lg.serviceEnd[0] + days
    }
    if (endServerTimeCount &lt;= 0 &amp;&amp; endServerTimeCount &gt; servenDays) {
        var days = Math.abs(endServerTimeCount) / oneDay;
        statusWord = days + lg.serviceEnd[2];
        if (endServerTimeCount == 0) {
            statusWord = lg.serviceEnd[3]
        }
    }
    if (speed == -9 &amp;&amp; heart_stime &gt; offlineSeconds) {
        if (statusWord == &quot;-1&quot;) return [&quot;white&quot;, lg.srun0, speed, false];
        else return [&quot;white&quot;, statusWord, speed, false]
    }
    if (speed == -9 &amp;&amp; heart_stime &lt;= offlineSeconds) {
        if (statusWord == &quot;-1&quot;) return [&quot;gray&quot;, lg.srun2, 0, true];
        else return [&quot;gray&quot;, statusWord, 0, true]
    }
    if (speed &lt; 0 || heart_stime &gt; offlineSeconds) {
        if (statusWord == &quot;-1&quot;) return [&quot;white&quot;, lg.srun1, 0, false];
        else return [&quot;white&quot;, statusWord, 0, false]
    }
    if ((speed &gt;= 0 &amp;&amp; speed &lt; speedForStill[1]) || 35 &lt; stopover_time) {
        if (statusWord == &quot;-1&quot;) return [&quot;gray&quot;, lg.srun2, 0, true];
        else return [&quot;gray&quot;, statusWord, 0, true]
    }
    if (speed &gt;= speedForStill[1] &amp;&amp; speed &lt;= 80) {
        if (statusWord == &quot;-1&quot;) return [&quot;green&quot;, lg.srun3, speed, true];
        else return [&quot;green&quot;, statusWord, speed, true]
    }
    if (speed &gt; 80 &amp;&amp; speed &lt;= 120) {
        if (statusWord == &quot;-1&quot;) return [&quot;yellow&quot;, lg.srun4, speed, true];
        else return [&quot;yellow&quot;, statusWord, speed, true]
    }
    if (speed &gt; 120) {
        if (statusWord == &quot;-1&quot;) return [&quot;red&quot;, lg.srun5, speed, true];
        else return [&quot;red&quot;, lstatusWord, speed, true]
    }
    return _arr
}
function direction(speed, iconType, hangxiang) {
    var direction = &quot;west&quot;;
    if (iconType.charAt(0) == &quot;2&quot;) {
        var speed = Number(speed);
        var hangxiang = Number(hangxiang);
        if (speed == -1) {
            direction = &quot;west&quot;
        } else {
            if (hangxiang &lt;= 45 || hangxiang &gt; 315) {
                direction = &quot;north&quot;
            } else if (hangxiang &gt; 45 &amp;&amp; hangxiang &lt;= 135) {
                direction = &quot;east&quot;
            } else if (hangxiang &gt; 135 &amp;&amp; hangxiang &lt;= 225) {
                direction = &quot;south&quot;
            } else if (hangxiang &gt; 225 &amp;&amp; hangxiang &lt;= 315) {
                direction = &quot;west&quot;
            }
        }
    }
    return direction
}
function getIconURL(iconType, status, hangxiang) {
    var imgURL = &quot;green_01.gif&quot;;
    if (iconType.charAt(0) == &quot;2&quot;) {
        imgURL = status + &quot;_&quot; + hangxiang + &quot;_&quot; + iconType + &quot;.gif&quot;
    } else {
        imgURL = status + &quot;_&quot; + iconType + &quot;.gif&quot;
    }
    return imgURL
}
function getAccStatus(val, p, record) {
    if ((typeof record) == &quot;undefined&quot; || record.data[&quot;product_type&quot;] == &quot;GT06&quot;) {
        var stem = parseInt(val.substr(0, 2), 16);
        var tem = stem.toString(2);
        if (tem.length &lt; 2 || tem.substr(tem.length - 2, 1) == &quot;0&quot;) {
            return lg.off
        } else {
            return lg.on
        }
    } else {
        return &quot;...&quot;
    }
}
function distance(lat1, lon1, lat2, lon2, len) {
    var R = 6371;
    var dLat = (lat2 - lat1) * Math.PI / 180;
    var dLon = (lon2 - lon1) * Math.PI / 180;
    var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon / 2) * Math.sin(dLon / 2);
    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    var d = R * c;
    return d + len
}
function formatKm2M(v) {
    if (v &gt; 1) return Math.round(v * 1000) / 1000 + lg.km;
    else if (v &lt;= 1) return Math.round(v * 1000) + lg.mi
}
function parseGt06Staust(val) {
    var val = val + &quot;&quot;;
    if ((typeof val) == &quot;undefined&quot;) return lg.sdw0;
    var stem = parseInt(val.substr(0, 2), 16);
    var tem = stem.toString(2);
    if (tem.length &lt; 7 || (tem.length == 7 &amp;&amp; tem.substr(0, 1) == &quot;0&quot;) || (tem.length == 8 &amp;&amp; tem.substr(1, 1) == &quot;0&quot;)) return lg.sdw0;
    else return lg.sdw1
}
//function addMAPabc(map) {
//    var tileSize = new google.maps.Size(256, 256);
//    var getTileUrl = function (tile, zoom) {
//            return &quot; http://emap&quot; + ((tile.x + tile.y) % 4) + &quot;.mapabc.com/mapabc/maptile?v=w2.99&amp;x=&quot; + tile.x + &quot;&amp;y=&quot; + tile.y + &quot;&amp;zoom=&quot; + (17 - zoom)
//        };
//    var imageMapType = new google.maps.ImageMapType({
//        alt: &quot;MAPabc&quot;,
//        isPng: true,
//        maxZoom: 18,
//        minZoom: 1,
//        name: &quot;MAPabc&quot;,
//        tileSize: tileSize,
//        opacity: 1.0,
//        getTileUrl: getTileUrl
//    });
//    map.mapTypes.set('MAPabc', imageMapType)
//}
//function addMarkerLayersTile(map) {
//    var label = new google.maps.ImageMapType({
//        getTileUrl: function (tile, zoom) {
//            var arr = [&quot;mt0&quot;, &quot;mt1&quot;, &quot;mt2&quot;, &quot;mt3&quot;];
//            var _u = arr[Math.floor(Math.random() * arr.length)];
//            return &quot;http://&quot; + _u + &quot;.google.com/vt/imgtp=png32&amp;lyrs=h@140&amp;hl=zh-CN&amp;gl=cn&amp;x=&quot; + (tile.x) + &quot;&amp;y=&quot; + (tile.y) + &quot;&amp;z=&quot; + zoom + &quot;&amp;s=Galil&quot;
//        },
//        tileSize: new google.maps.Size(256, 256),
//        isPng: true
//    });
//    map.overlayMapTypes.insertAt(0, label)
//}
//function addMAPType(map, id, text) {
//    var tileSize = new google.maps.Size(256, 256);
//    var getTileUrl = function (tile, zoom) {
//            var arr = [&quot;mt0&quot;, &quot;mt1&quot;, &quot;mt2&quot;, &quot;mt3&quot;];
//            var _u = arr[Math.floor(Math.random() * arr.length)];
//            return &quot;http://&quot; + _u + &quot;.google.com/vt/lyrs=s@76&amp;gl=cn&amp;x=&quot; + tile.x + &quot;&amp;y=&quot; + tile.y + &quot;&amp;z=&quot; + zoom
//        };
//    var imageMapType = new google.maps.ImageMapType({
//        alt: text,
//        isPng: true,
//        maxZoom: 20,
//        name: text,
//        tileSize: tileSize,
//        opacity: 1.0,
//        getTileUrl: getTileUrl
//    });
//    map.mapTypes.set(id, imageMapType)
//}

//UTC + 时区差 ＝ 本地时间 
//将后台utc时间毫秒转为本地时间
function utcToLocal(utc){
	if(isNaN(Number(utc))) return utc;
	var t = new Date(Number(utc));
	d = [t.getFullYear(), t.getMonth()+1, t.getDate()].join('/');
	var mm = t.getMinutes() , ss = t.getSeconds();
	d += ' ' + ([t.getHours(), mm &gt; 9 ? mm : '0'+mm, ss &gt; 9 ? ss : '0'+ss].join(':'));
	return d;
}

//将本地时间时间转为utc时间毫秒
function localToUtc(local){
	if(!isNaN(Number(local))) return local;
	var l = new Date(local.replace(/\-/g,'/')).getTime();
	return l;	
}</pre>
<p><br>
还有用的WdatePicker.js这个可以在网上下载一个。</p>
<p>jquery-1.3.2.min.js.gzjs也自己下就行。</p>
<p>&nbsp;</p>
<p><strong>webService地址：</strong></p>
<p>例如：</p>
<p><a href="http://his.10086care.com/GetDataService">http://his.10086care.com/GetDataService?method=getHistoryMByMUtc&amp;userID=65979&amp;mapType=BAIDU&amp;pwd=123456&amp;from=1336464352000&amp;to=1336467952000&amp;t=1340069634100&amp;callback=PlayBack</a>.</p>
<p>获取结果如下：</p>
<pre class="plain" name="code">PlayBack.getDataCallBack

(&quot;114.238785,30.612293,1336464358000,1;114.23857,30.612303,1336464377000,19;114.23769,30.612333,1336464387000,33;114.236565,30.612432,1336464397000,40;114.235535,30.61

2494,1336464407000,32;114.23493,30.612513,1336464417000,6;114.23471,30.612463,1336464427000,15;114.23374,30.612494,1336464437000,31;114.232216,30.612543,1336464447000,

50;114.23074,30.612623,1336464457000,55;114.22919,30.612703,1336464468000,40;114.2283,30.612812,1336464478000,24;114.22779,30.613092,1336464488000,32;114.22685,30.6132

22,1336464499000,23;114.22604,30.613354,1336464509000,18;114.225815,30.613443,1336464519000,2;114.22576,30.613493,1336464531000,0;114.225464,30.613523,1336464561000,9;

114.225334,30.613703,1336464571000,10;114.225334,30.614014,1336464581000,16;114.22537,30.614384,1336464591000,17;114.22537,30.614794,1336464641000,19;114.225494,30.615

414,1336464651000,15;114.22556,30.615883,1336464661000,27;114.225624,30.616703,1336464671000,33;114.225426,30.617292,1336464681000,21;114.22462,30.617474,1336464691000

,19;114.224144,30.617502,1336464701000,10;114.22359,30.617523,1336464711000,25;114.22289,30.617582,1336464721000,19;114.221985,30.617672,1336464731000,39;114.2209,30.6

17905,1336464741000,21;114.22073,30.618044,1336464751000,7;114.22074,30.618284,1336464761000,16;114.22093,30.618864,1336464771000,23;114.221,30.619503,1336464781000,27

;114.22115,30.620203,1336464791000,18;114.22109,30.619894,1336464860000,25;114.220955,30.619225,1336464870000,24;114.22086,30.618584,1336464880000,22;114.22072,30.6181

55,1336464890000,2;114.22071,30.617994,1336464900000,7;114.22067,30.617905,1336464910000,9;114.22016,30.618034,1336464920000,17;114.21979,30.618093,1336464930000,0;114

.21951,30.618063,1336464950000,19;114.21884,30.618174,1336464960000,27;114.21804,30.618303,1336464970000,25;114.21724,30.618355,1336464980000,24;114.21645,30.618454,13

36464990000,31;114.21526,30.618574,1336465000000,46;114.21405,30.618685,1336465010000,36;114.21316,30.618744,1336465020000,27;114.21229,30.618864,1336465030000,34;114.

21122,30.619024,1336465040000,30;114.21011,30.619154,1336465050000,45;114.2089,30.619385,1336465060000,31;114.2088,30.620424,1336465070000,47;114.20879,30.621544,13364

65080000,50;114.20878,30.622753,1336465090000,45;114.20876,30.623884,1336465100000,52;114.20871,30.625275,1336465110000,57;114.2087,30.626675,1336465120000,51;114.2085

5,30.627064,1336465130000,14;114.20852,30.626244,1336465140000,38;114.20804,30.625763,1336465150000,14;114.20788,30.625494,1336465160000,13;114.20783,30.625763,1336465

519000,17;114.208,30.625654,1336465678000,4;114.20841,30.625923,1336465688000,26;114.20848,30.626635,1336465698000,31;114.20859,30.626913,1336465708000,16;114.2086,30.

626055,1336465718000,42;114.2086,30.624813,1336465728000,50;114.2086,30.623453,1336465738000,54;114.20861,30.621914,1336465748000,63;114.20862,30.620375,1336465758000,

57;114.20864,30.619314,1336465768000,25;114.20864,30.618284,1336465778000,51;114.20865,30.617033,1336465788000,52;114.20865,30.615993,1336465798000,23;114.208664,30.61

5854,1336465878000,9;114.20871,30.615314,1336465888000,30;114.208664,30.614393,1336465898000,39;114.20846,30.613298,1336465908000,33;114.208374,30.612898,1336465918000

,15;114.20876,30.612518,1336465928000,31;114.20857,30.611898,1336465938000,37;114.2086,30.610678,1336465948000,42;114.20859,30.609957,1336465958000,37;114.20854,30.609

148,1336465968000,12;114.20856,30.609118,1336465985000,0;114.20859,30.609108,1336466127000,7;114.208595,30.608618,1336466137000,29;114.2086,30.607807,1336466147000,25;

114.20803,30.607758,1336466157000,38;114.20677,30.608067,1336466167000,47;114.205605,30.608347,1336466177000,27;114.2051,30.608387,1336466217000,19;114.20449,30.607668

,1336466227000,46;114.20383,30.606667,1336466237000,46;114.20316,30.605818,1336466247000,38;114.20277,30.605228,1336466257000,20;114.20252,30.604858,1336466267000,21;1

14.20214,30.604557,1336466277000,12;114.201546,30.604618,1336466287000,33;114.20039,30.605217,1336466297000,45;114.19941,30.60574,1336466307000,49;114.19844,30.60625,1

336466317000,41;114.197464,30.60672,1336466327000,36;114.196465,30.60724,1336466337000,46;114.19518,30.60792,1336466347000,54;114.19377,30.60862,1336466357000,56;114.1

92444,30.60928,1336466367000,52;114.19122,30.60996,1336466377000,47;114.19071,30.61056,1336466387000,26;114.19094,30.61112,1336466397000,14;114.191345,30.612461,133646

6414000,36;114.19154,30.61347,1336466424000,49;114.19178,30.61477,1336466434000,46;114.19184,30.61524,1336466444000,11;114.19167,30.61527,1336466454000,4;114.19158,30.

61454,1336466464000,45;114.191414,30.61333,1336466474000,46;114.19133,30.61284,1336466478000,47;114.19103,30.6117,1336466488000,48;114.19071,30.61067,1336466498000,31;

114.190605,30.61049,1336466588000,13;114.19069,30.60996,1336466598000,25;114.19158,30.6096,1336466607000,32;114.19267,30.60897,1336466617000,48;114.19404,30.60828,1336

466627000,58;114.19558,30.60745,1336466637000,64;114.19718,30.60666,1336466647000,59;114.19834,30.60601,1336466657000,18;114.198784,30.60574,1336466687000,41;114.19981

4,30.605177,1336466697000,60;114.201416,30.604357,1336466707000,54;114.20241,30.603977,1336466717000,27;114.20303,30.603647,1336466727000,25;114.20354,30.603418,133646

6737000,5;114.203835,30.603317,1336466747000,26;114.20463,30.602888,1336466757000,34;114.20555,30.602438,1336466767000,35;114.206215,30.602077,1336466777000,30;114.207

15,30.601517,1336466787000,48;114.20835,30.600918,1336466797000,48;114.209496,30.600348,1336466807000,19;114.20954,30.600187,1336466837000,12;114.21005,30.599907,13364

66847000,22;114.210815,30.599478,1336466857000,29;114.21185,30.598927,1336466867000,35;114.212944,30.598467,1336466877000,36;114.21417,30.597837,1336466887000,60;114.2

15675,30.597038,1336466897000,49;114.216736,30.596277,1336466907000,41;114.21777,30.595388,1336466917000,58;114.21842,30.594818,1336466927000,21;114.21832,30.593977,13

36466937000,49;114.218056,30.593067,1336466947000,12;114.21802,30.592648,1336467006000,16;114.2181,30.592167,1336467016000,27;114.218895,30.591587,1336467026000,30;114

.21942,30.591017,1336467036000,37;114.21995,30.589888,1336467046000,49;114.220146,30.588587,1336467056000,46;114.220795,30.587818,1336467066000,39;114.22179,30.587168,

1336467076000,40;114.22279,30.586578,1336467086000,48;114.22401,30.585857,1336467096000,46;114.22478,30.585318,1336467106000,24;114.22553,30.584658,1336467116000,47;11

4.226715,30.583868,1336467126000,49;114.227806,30.583027,1336467136000,53;114.22884,30.582127,1336467146000,46;114.229454,30.581547,1336467156000,14;114.22958,30.58137

7,1336467166000,16;114.230255,30.580738,1336467176000,44;114.23145,30.579987,1336467186000,52;114.232765,30.579607,1336467196000,45;114.23405,30.579287,1336467206000,4

9;114.23527,30.579008,1336467216000,46;114.236694,30.578888,1336467226000,46;114.237816,30.578878,1336467236000,38;114.23902,30.578857,1336467246000,39;114.24033,30.57

8957,1336467256000,54;114.24216,30.579088,1336467266000,69;114.2439,30.579157,1336467276000,48;114.24558,30.579138,1336467286000,68;114.24768,30.578838,1336467296000,7

3;114.24959,30.578192,1336467306000,68;114.25086,30.57756,1336467316000,31;114.25144,30.577122,1336467326000,45;114.25255,30.57616,1336467336000,63;114.25415,30.57496,

1336467346000,79;114.255714,30.574001,1336467356000,40;114.2562,30.573671,1336467366000,9;114.25641,30.57353,1336467386000,30;114.25756,30.572851,1336467396000,54;114.

259094,30.57225,1336467406000,50;114.26019,30.57187,1336467416000,37;114.26124,30.57159,1336467426000,40;114.262505,30.571451,1336467436000,42;114.26369,30.571411,1336

467446000,42;114.26528,30.571201,1336467456000,59;114.26713,30.570992,1336467466000,68;114.26882,30.57076,1336467476000,55;114.2702,30.57053,1336467486000,32;114.27075

,30.57043,1336467496000,22;114.27166,30.570261,1336467506000,31;114.272675,30.570002,1336467515000,45;114.273705,30.569632,1336467525000,30;114.274445,30.5695,13364675

35000,32;114.27558,30.569351,1336467545000,40;114.27654,30.569191,1336467555000,31;114.277,30.56909,1336467565000,13;114.27782,30.568472,1336467575000,38;114.27885,30.

568312,1336467585000,24;114.27962,30.568193,1336467595000,31;114.27997,30.568153,1336467605000,0;114.27997,30.568142,1336467635000,5;114.28034,30.568113,1336467645000,

19;114.28102,30.568052,1336467655000,20;114.28176,30.567972,1336467665000,23;114.28231,30.567923,1336467675000,21;114.28274,30.567873,1336467685000,12;114.28318,30.567

812,1336467695000,11;114.28336,30.567793,1336467705000,10;114.28363,30.567772,1336467715000,2;114.28387,30.567753,1336467725000,12;114.28418,30.567722,1336467735000,10

;114.28478,30.567663,1336467745000,14;114.28504,30.567633,1336467755000,8;114.28536,30.567623,1336467765000,10;114.28542,30.567732,1336467835000,14;114.28492,30.567762

,1336467845000,4;114.28457,30.567783,1336467855000,16;114.28397,30.567823,1336467865000,17;114.28352,30.567842,1336467875000,16;114.28317,30.567892,1336467885000,5;114

.28302,30.567883,1336467895000,11;114.282684,30.567923,1336467905000,14;114.28229,30.568003,1336467915000,12;114.28188,30.568073,1336467924000,24;114.28094,30.568172,1

336467934000,27;114.28037,30.568213,1336467944000,8;&quot;)</pre>
<p><br>
分割获取：</p>
<p>var tem = msg.split(&quot;;&quot;);</p>
<p>var rs = tem[i].split(&quot;,&quot;);</p>
<p>1.Y坐标<br>
2.X坐标<br>
3.当前时间（utc时间）<br>
4.行车速度</p>
<p>&nbsp;</p>
<p>地址：<a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549787">http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549787</a></p>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/5/9 14:17:24 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549787">原文链接</a>
            </div>
            <div>
            阅读：39605 评论：64 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549787#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[原]google 地图 V3 运动轨迹]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549718</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549718</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/5/9 13:54:21</pubDate>
        <description><![CDATA[
            
<pre class="html" name="code"><span style="font-size:24px;">不使用坐标</span>：</pre><pre class="html" name="code"><a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549718">地址</a></pre><pre class="html" name="code">&lt;DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;
&lt;head&gt;
    &lt;title&gt;谷歌地图 v3&lt;/title&gt;
    &lt;script src=&quot;http://maps.google.com/maps/api/js?v=3.1&amp;sensor=true&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
    
    &lt;script type=&quot;text/javascript&quot;&gt;
        var map;// 地图对象
        var directionsService = new google.maps.DirectionsService();
        var directionDisplay;
        var path = null,timer = 0,index = 0,marker = null;
        function init() {
            directionsDisplay = new google.maps.DirectionsRenderer();
            var coor = new google.maps.LatLng(39.960872,116.271486);
            map = new google.maps.Map(document.getElementById(&quot;map&quot;), { zoom: 12, center: coor, mapTypeControl: false, mapTypeId: google.maps.MapTypeId.ROADMAP });

            directionsDisplay.setMap(map);

            var request = {
                origin: &quot;北京市南坞&quot;,//起始上班地点
                destination: &quot;北京市人民大学&quot;,//结束上班地点
                optimizeWaypoints: true,
                travelMode: google.maps.DirectionsTravelMode.DRIVING
            };

            // 获取从“北京市南坞”到“北京市人民大学”的线路
            directionsService.route(request, function(response, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(response);
                    path = response.routes[0].overview_path;
                    if (path) {
                        timer = window.setInterval(function() {
                            if (!marker) {
                                marker = new google.maps.Marker({ position: path[index++], map: map });
                            } else {
                                if (index &lt; path.length) {
                                    marker.setPosition(path[index++]);
                                } else {
                                    index = 0;
                                    window.clearInterval(timer);
                                }
                            }
                        }, 30);//30是运动时间
                    }
                }
            });
        }
    &lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
    &lt;div id=&quot;map&quot; style=&quot;width:800px; height:800px;&quot;&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt; 
</pre>
<p>效果：<br>
<img alt="" src="http://my.csdn.net/uploads/201205/09/1336543009_3457.png"></p>
<p><span style="font-size:24px">使用坐标：</span></p>
<p>&nbsp;代码：</p>
<pre class="html" name="code">&lt;DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;
&lt;head&gt;
    &lt;title&gt;谷歌地图 v3&lt;/title&gt;
    &lt;script src=&quot;http://maps.google.com/maps/api/js?v=3.1&amp;sensor=true&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
    
    &lt;script type=&quot;text/javascript&quot;&gt;
        var map;// 地图对象
        var directionsService = new google.maps.DirectionsService();
        var directionDisplay;
        var path = null,timer = 0,index = 0,marker = null;
        function init() {
            directionsDisplay = new google.maps.DirectionsRenderer();
            var coor = new google.maps.LatLng(39.960872,116.271486);
            map = new google.maps.Map(document.getElementById(&quot;map&quot;), { zoom: 12, center: coor, mapTypeControl: false, mapTypeId: google.maps.MapTypeId.ROADMAP });

            directionsDisplay.setMap(map);

            var request = {
                origin: &quot;39.956728,116.275949&quot;,//起始上班地点 (北京市南坞坐标)
                destination: &quot;39.959392,116.299424&quot;,//结束上班地点 （北京市人民大学坐标）
				//waypoint 包括以下字段：
				//•location（必需）指定路标的地址。
				//•stopover（可选）指示此路标是路线上的实际停留点 (true)，还是仅为通过指定位置 (false) 的路线首选项。默认情况下，中途停留为 true。
				waypoints: [     
				{location:&quot;39.961497,116.284018&quot;,stopover:true},
				{location:&quot;39.966464,116.283417&quot;,stopover:true},
				{location:&quot;39.966925,116.28861&quot;,stopover:true},
				{location:&quot;39.966464,116.283417&quot;,stopover:true},
				{location:&quot;39.961497,116.284018&quot;,stopover:false}
				
				],   
                optimizeWaypoints: true,
                travelMode: google.maps.DirectionsTravelMode.DRIVING
            };
			/*
				Google Maps API 需要调用外部服务器，因此，对路线服务的访问是异步的。为此，您需要传递一个回调方法，以在请求完成后执行。此回调方法将会对结果进行处理。请注意，路线服务可能以单独 routes[] 数组的形式传回多个可能的行程。

				要在 V3 中使用路线，请创建一个类型为 DirectionsService 的对象，并调用 DirectionsService.route() 向路线服务发送一条请求，方法是为其传递一个 DirectionsRequest 对象常量，其中包含输入项和一个回调方法，该回调方法将会在收到响应后执行。
				DirectionsRequest 对象常量包含下列字段：
				{   origin: LatLng | String,   destination: LatLng | String,   travelMode: TravelMode,   unitSystem: UnitSystem,   waypoints[]: DirectionsWaypoint,   optimizeWaypoints: Boolean,   provideRouteAlternatives: Boolean,   avoidHighways: Boolean,   avoidTolls: Boolean   region: String }下面对这些字段进行了说明：

				•origin（必需）指定计算路线时所用的起始地点。该值可以指定为 String（如“Chicago, IL”），也可以指定为 LatLng 值。
				•destination（必需）指定计算路线时所用的结束地点。该值可以指定为 String（如“Chicago, IL”），也可以指定为 LatLng 值。
				•travelMode（必需）指定计算路线时所用的交通方式。在下面的出行方式中指定有效值。
				•unitSystem（可选）指定显示结果时使用的单位制。在下面的单位制中指定有效值。

				•waypoints[]（可选）指定 DirectionsWaypoint 数组。路标将通过让路线经过指定地点而改变路线。将路标指定为带有如下字段的一个对象常量：

				◦location 将要进行地址解析的路标地点指定为 LatLng 或 String。
				◦stopover 是一个布尔值，用于指示路标是否为路线上的停留点，这可以将这条路线分为两条路线。
				（有关路标的详细信息，请参见下文的在路线中使用路标。）

				•optimizeWaypoints（可选）指定可以优化使用所提供 waypoints 的路线，以提供尽可能短的路线。如果为 true，路线服务将在 waypoint_order 字段中传回重新排序的 waypoints。（有关详细信息，请参见下文的在路线中使用路标。）
				•provideRouteAlternatives（可选）设置为 true 时，指定路线服务可以在响应中提供多条备选路线。请注意，提供备选路线可能增加服务器的响应时间。
				•avoidHighways（可选）设置为 true 时，表示计算的路线应避开主要公路（如果可能）。•avoidTolls（可选）设置为 true 时，表示计算的路线应避开收费道路（如果可能）。•region（可选）指定区域代码，该区域代码指定为 ccTLD（“顶级域”）双字符值。（有关详细信息，请参见下文的区域偏向。）
				*/
            // 获取从“北京市南坞”到“北京市人民大学”的线路
            directionsService.route(request, function(response, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(response);
                    path = response.routes[0].overview_path;
                    if (path) {
                        timer = window.setInterval(function() {
                            if (!marker) {
                                marker = new google.maps.Marker({ position: path[index++], map: map });
                            } else {
                                if (index &lt; path.length) {
                                    marker.setPosition(path[index++]);
                                } else {
                                    index = 0;
                                    window.clearInterval(timer);
                                }
                            }
                        }, 30);//30是运动时间
                    }
                }
            });
        }
    &lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
    &lt;div id=&quot;map&quot; style=&quot;width:800px; height:800px;&quot;&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt; 
</pre>
<p><br>
效果：</p>
<p>&nbsp;</p>
<img src="http://my.csdn.net/uploads/201206/18/1340013709_4569.png" alt="">

            <div>
                作者：adsdassadfasdfasdf 发表于2012/5/9 13:54:21 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549718">原文链接</a>
            </div>
            <div>
            阅读：5587 评论：4 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7549718#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[原]google地图--运动轨迹（自己上班的运动轨迹）]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7546873</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7546873</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/5/8 16:44:01</pubDate>
        <description><![CDATA[
            
<pre class="html" name="code">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;google地图 ——轨迹&lt;/title&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;js?sensor=false&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        function initialize() {
            var myOptions = {
                zoom: 16,
                center: new google.maps.LatLng(39.964556,116.274834),
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(document.getElementById(&quot;map_canvas&quot;), myOptions);
            // 这里填上轨迹的经纬坐标，或者ajax从后台读取
	    // 坐标做好是在路口的，不然画线不在路上。
            var trackPoints = [
                new google.maps.LatLng(39.964556,116.274834),
                new google.maps.LatLng(39.956662,116.275735),
                new google.maps.LatLng(39.957221,116.284447),
                new google.maps.LatLng(39.95834,116.29406),
                new google.maps.LatLng(39.959326,116.29951),
		new google.maps.LatLng(39.960083,116.303029),
		new google.maps.LatLng(39.96209,116.307793)
            ];
            
            var trackPath = new google.maps.Polyline({
                path: trackPoints,
                strokeColor: &quot;#FF0000&quot;, // 线条颜色
                strokeOpacity: 1.0, // 线条透明度
                strokeWeight: 2 // 线条粗细
            });

            trackPath.setMap(map);
        }
&lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;initialize()&quot;&gt;
    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
    &lt;div id=&quot;map_canvas&quot; style=&quot;width:1000px; height:700px;&quot;&gt;&lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
运行效果：</pre><img src="http://my.csdn.net/uploads/201205/08/1336466810_7767.png" alt=""><br>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/5/8 16:44:01 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7546873">原文链接</a>
            </div>
            <div>
            阅读：4138 评论：11 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7546873#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[转]Asp.net使用JQuery实现评论的无刷新分页及分段延迟加载效果]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7533618</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7533618</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/5/4 9:20:34</pubDate>
        <description><![CDATA[
            
<p>首先建立数据库，数据关系图如下：</p>
<p><img alt="" src="http://my.csdn.net/uploads/201205/04/1336094421_2038.JPG"></p>
<p>本文要实现的效果就是在评论别人文章时，如果文章内容过长或者评论内容过长，实现的一个评论分段延迟加载的效果，即每页可显示30条评论，可每隔10条延迟加载一次以提高网页传输显示效率。</p>
<p>&nbsp;</p>
<p>我所实现的页面延迟的原理如下图，就是求出X的距离小于100时进行加载延迟的评论，然后又设置了一个标记位，用来判断延迟加载了多少次，每页仅能加载30条评论记录。</p>
<p><img alt="" src="http://my.csdn.net/uploads/201205/04/1336094447_9615.PNG"></p>
<p>然后再评论末端加载上页码实现无刷新进行分页的效果。</p>
<p>分页的方法也是比较简单的，这里自己实现了一个存储过程，使用到row_number()函数：</p>
<pre class="sql" name="code">ALTER PROCEDURE ps_getpageandload     
	@aid int,     
	@startindex int,     
	@endindex int
AS    
	select  * from    
	(         
	select Row_Number() over(order by CID) as rownum,Username,Comment         from T_Comments where AID=@aid    
	 ) as T     
	 where T.rownum&gt;=@startindex and T.rownum&lt;=@endindex     
	 RETURN </pre>
<p><br>
&nbsp;</p>
<p>就是输入一个起始位置的参数和结束位置的参数，取出中间的数据。</p>
<p>这样，在程序中就好取出数据了，比如：我第一页就是要1-30的数据，就让startindex=1,endindex=30就行了；第二页就是31-60的数据，同理。</p>
<p style="line-height:24px; background-color:#c0c0c0; font-size:16px">LoadArticle.ashx：一个一般处理程序，用来加载文章内容，源代码如下：</p>
<pre class="csharp" name="code"><p>&nbsp;</p><pre class="csharp" name="code">using System; 
using System.Collections.Generic; 
using System.Linq; 
using System.Web; 
using System.Configuration; 
using System.Data.SqlClient; 
using Microsoft.ApplicationBlocks.Data; 
using System.Data; using System.Text;   
namespace AJAXPagingTest {     
	/// &lt;summary&gt;     
	/// Summary description for LoadArticle     
	/// &lt;/summary&gt;     
	public class LoadArticle : IHttpHandler     
	{           
		public void ProcessRequest(HttpContext context)         
		{             
			context.Response.ContentType = &quot;text/plain&quot;;              
		  //获取连接字符串 
		  String connString = ConfigurationManager.ConnectionStrings[&quot;MyConnectionString&quot;].ConnectionString;     
		  //获取所要读取的文章编号             
		  String aid = context.Request[&quot;article&quot;];             
		  SqlParameter[] sp=new SqlParameter[1];             
		  sp[0]=new SqlParameter(&quot;@aid&quot;,aid);               
		  SqlDataReader dr = SqlHelper.ExecuteReader(connString, CommandType.Text,&quot;select Title,Article from T_Articles where AID=@aid&quot;,sp);               
		  StringBuilder sb = new StringBuilder();               
		  while (dr.Read())             
		  {                 
		  	sb.Append(dr.GetString(dr.GetOrdinal(&quot;Title&quot;)));                 
		  	sb.Append(&quot;|&quot;);                 
		  	sb.Append(dr.GetString(dr.GetOrdinal(&quot;Article&quot;)));             
		  }               
		  context.Response.Write(sb.ToString());          
		 }           
		 public bool IsReusable         
		 {             
		 	get{return false;}         
		 }     
	} 
} 


</pre>
<p><br>
</p>
<br>
<pre></pre>
<p style="line-height:24px; background-color:#c0c0c0; font-size:16px">LoadCommentAndPaging.ashx：也是一个一般处理程序，用于加载评论，源代码如下：</p>
<pre class="csharp" name="code">using System; 
using System.Collections.Generic; 
using System.Linq; 
using System.Web; 
using System.Data; 
using System.Data.SqlClient; 
using Microsoft.ApplicationBlocks.Data; 
using System.Configuration; 
using System.Web.Script.Serialization;     
namespace AJAXPagingTest {     
	/// &lt;summary&gt;     
	/// Summary description for LoadCommentAndPaging     
	/// &lt;/summary&gt;     
	public class LoadCommentAndPaging : IHttpHandler     
	{           
		public void ProcessRequest(HttpContext context)         
		{             
			context.Response.ContentType = &quot;text/plain&quot;;               
			String connStr = ConfigurationManager.ConnectionStrings[&quot;MyConnectionString&quot;].ConnectionString;             
			List&lt;Comment&gt; Comments = new List&lt;Comment&gt;();             
			String result = String.Empty;               
			//获取页面的动作             
			String action = context.Request[&quot;action&quot;];                           
			//页面第一加载的时候             
			if (action==&quot;load&quot;)             
			{                 
				DataTable dt = SqlHelper.ExecuteDataset(connStr, CommandType.Text,&quot;select top(10) * from T_Comments where AID=1&quot;).Tables[0];  
				foreach (DataRow dr in dt.Rows)                 
				{                     
					Comment comment = new Comment();                     
					comment.Username = dr[&quot;Username&quot;].ToString();                     
					comment.Commentz = dr[&quot;Comment&quot;].ToString();                     
					Comments.Add(comment);                 
				}                 
				JavaScriptSerializer jss = new JavaScriptSerializer();                 
				result = jss.Serialize(Comments);                 
				context.Response.Write(result);                 
				return;             
			}               
			//获取当前页码             
			String pageString = context.Request[&quot;page&quot;];               
			//处理延时或分页加载评论             
			if (action==&quot;pageOrlazy&quot;)             
			{                 
				//获取当前延时加载的次数                 
				String countString = context.Request[&quot;count&quot;];                   
				int page, count;                   
				//判断参数是否正确                 
				if (int.TryParse(pageString, out page) &amp;&amp; int.TryParse(countString, out count))                 
				{                     
					//计算需要加载评论的起始索引                     
					int startindex = (page - 1) * 30 + count * 10 + 1;                       
					//计算需要加载评论结束索引                     
					int endindex = startindex + 9;                       
					SqlParameter[] sp = new SqlParameter[3];                     
					sp[0] = new SqlParameter(&quot;@aid&quot;, 1);                     
					sp[1] = new SqlParameter(&quot;@startindex&quot;, startindex);                     
					sp[2] = new SqlParameter(&quot;@endindex&quot;, endindex);                       
					DataTable dt = SqlHelper.ExecuteDataset(connStr,CommandType.StoredProcedure,&quot;ps_getpageandload&quot;,sp).Tables[0]; 
					foreach (DataRow dr in dt.Rows)                     
					{                         
						Comment comment = new Comment();                         
						comment.Username = dr[&quot;Username&quot;].ToString();                         
						comment.Commentz = dr[&quot;Comment&quot;].ToString();                         
						Comments.Add(comment);                     
					}                       
					JavaScriptSerializer jss = new JavaScriptSerializer();                     
					result = jss.Serialize(Comments);                     
					context.Response.Write(result);                     
					return;                   
				}                 
				else                
				{                     
					throw new Exception(&quot;参数传递错误&quot;);                 
				}               
			}               
			//获取页码             
			if (action==&quot;pagenumber&quot;)             
			{                 
				int number = Convert.ToInt32(SqlHelper.ExecuteScalar(connStr,CommandType.Text,&quot;select count(*) from T_Comments&quot;));
				context.Response.Write((number/30).ToString());                
				return;             
			}                        
		}           
		public bool IsReusable         
		{             
			get            
			{                 
				return false;             
			}         
		}     
	}       
	public class Comment     
	{         
		public String Username {get;set; }         
		public String Commentz {get;set; }     
	} 
}   

</pre>
<p><br>
&nbsp;</p>
<p>&nbsp;</p>
<p style="line-height:24px; background-color:#c0c0c0; font-size:16px">CommnetPage.htm：最后是前台页面的JQuery代码</p>
<pre class="html" name="code">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt; 
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt; 
&lt;head&gt;     
&lt;title&gt;&lt;/title&gt;     
&lt;link href=&quot;Style/StyleSheet1.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;     
&lt;script src=&quot;JS/jquery-1.4.2.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;     
&lt;script type=&quot;text/javascript&quot;&gt;         
$(function () 
{               
	//加载文章内容             
	$.post(&quot;LoadArticle.ashx&quot;, { &quot;article&quot;: &quot;1&quot; }, function (data, state) 
	{                 
		if (state == &quot;success&quot;) 
		{                       
			//利用&quot;|&quot;来分隔标题和正文                     
			var article = data.split(&quot;|&quot;);                     
			$(&quot;#article h3&quot;).text(article[0]);                     
			$(&quot;#article&quot;).append(article[1]);                 
		}             
	});               
	//加载初始的10条评论条数             
	$.post(&quot;LoadCommentAndPaging.ashx&quot;, { &quot;action&quot;: &quot;load&quot; }, function (data, state) 
	{                 
		if (state == &quot;success&quot;) 
		{                     
			var comments = $.parseJSON(data);                       
			for (var i = 0; i &lt; comments.length; i++) 
			{                         
				var comment = &quot;&lt;tr&gt;&lt;td&gt;&quot; + comments[i].Username + &quot;说：&lt;/td&gt;&lt;td&gt;&quot; + comments[i].Commentz + &quot;&lt;/td&gt;&lt;/tr&gt;&quot;;  
				$(&quot;#comment&quot;).append(comment);                     
			}                 
		}            
	});         
});           
//标记页面延迟数         
var flag = 1;           
//标记当前页面         
var currentpage = 1;           
//监测是否需要加载评论         
function check(n) {               
	//监测浏览器的模式，根据不同的模式获取客户端高度会有不同             
	var dom = document.compatMode == &quot;CSS1Compat&quot; ? document.documentElement : document.body;             
	var pre = document.getElementById(&quot;preload&quot;);               
	//获取滚动条离顶端的高度，用IE测试时是用             
	//documentElement.scrollTop获取高度，             
	//而在用chrome测试时是body.scrollTop获取高度             
	var scrtop = dom.scrollTop || document.body.scrollTop;               
	//传入的参数为当前页数，保存为全局变量             
	currentpage = n;               
	//当客户端显示窗口离标记的地方小于100距离时开始加载             
	if (pre.offsetTop - (dom.clientHeight + scrtop) &lt; 100) {                 
		$.post(&quot;LoadCommentAndPaging.ashx&quot;, { &quot;action&quot;: &quot;pageOrlazy&quot;, &quot;page&quot;: currentpage, &quot;count&quot;: flag }, function (data, state) 
		{                     
			if (state == &quot;success&quot;) 
			{                         
				var comments = $.parseJSON(data);                         
				for (var i = 0; i &lt; comments.length; i++) 
				{                             
					var comment = &quot;&lt;tr&gt;&lt;td&gt;&quot; + comments[i].Username + &quot;说：&lt;/td&gt;&lt;td&gt;&quot; + comments[i].Commentz + &quot;&lt;/td&gt;&lt;/tr&gt;&quot;;     
					$(&quot;#comment&quot;).append(comment);                         
				}                    
			}                 
		});                   
		flag = flag + 1;                   
		//如果加载多于3次了则不加载评论了，加载页码                 
		if (flag &lt;= 2) 
		{                     
			setTimeout(&quot;check(currentpage)&quot;, 2000);                 
		}                 
		else {                     
			//加载页码                     
			$.post(&quot;LoadCommentAndPaging.ashx&quot;, { &quot;action&quot;: &quot;pagenumber&quot; }, function (data, state) 
			{                         
				if (state == &quot;success&quot;) 
				{                             
					var count = parseInt(data, 10);                               
					for (var i = 1; i &lt;= count + 1; i++) 
					{                                 
						var control;                                   
						//等于当前页时则不显示超链接                                 
						if (i != currentpage) 
						{                                     
							control = &quot;&lt;td&gt;&lt;a href=''&gt;&quot; + i + &quot;&lt;/a&gt;&lt;/td&gt;&quot;;                                 
						}                                 
						else 
						{                                     
							control = &quot;&lt;td&gt;&quot; + i + &quot;&lt;/td&gt;&quot;;                                 
						}                                     
						$(&quot;#anchorlink&quot;).append(control);                                 
					}                             
					//加载分页点击时的事件                             
					$(&quot;#anchorlink td&quot;).click(function (e) 
					{                                 
						e.preventDefault();  
						//阻止超链接的转向                                 
						$(&quot;#comment&quot;).empty();  
						//将评论区清空                                 
						$(&quot;#anchorlink&quot;).empty();  
						//将页码清空                                 
						$(&quot;#preload&quot;).text(&quot;评论正在加载中...&quot;);                                   
						flag = 0;                                 
						var page = parseInt($(this).text());                                 
						check(page);                               
					});                           
				}                     
			});                     
			//去掉“评论加载中”的显示                     
			$(&quot;#preload&quot;).text(&quot;&quot;);                 
		}             
	}             
	else 
	{                 
		setTimeout(&quot;check(currentpage)&quot;, 2000);             
	}           
}           
//每隔两秒检查一下页面是否需要加载评论         
setTimeout(&quot;check(currentpage)&quot;, 2000);       
&lt;/script&gt; 
&lt;/head&gt; 
&lt;body&gt;     
&lt;div id=&quot;main&quot;&gt;         
&lt;div id=&quot;article&quot;&gt;             
&lt;h3&gt;             &lt;/h3&gt;         
&lt;/div&gt;         &lt;div&gt;             
&lt;table id=&quot;comment&quot;&gt;             &lt;/table&gt;             
&lt;p id=&quot;preload&quot;&gt;                 评论正在加载中...&lt;/p&gt;             
&lt;table&gt;                 
&lt;tr id=&quot;anchorlink&quot;&gt;                 &lt;/tr&gt;             
&lt;/table&gt;         
&lt;/div&gt;     
&lt;/div&gt; 
&lt;/body&gt; 
&lt;/html&gt;   
</pre>
<p><br>
<br>
&nbsp;</p>
<p><br>
&nbsp;</p>
<pre></pre>
<pre></pre>
<pre></pre>
<pre></pre>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/5/4 9:20:34 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7533618">原文链接</a>
            </div>
            <div>
            阅读：1097 评论：4 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7533618#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[转]关闭IE窗口时执行事件]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7531461</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7531461</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/5/3 14:33:49</pubDate>
        <description><![CDATA[
            
<div id="cnblogs_post_body">
<p>&lt;script language=&quot;javascript&quot;&gt; <br>
&nbsp;//关闭窗口时自动退出<br>
&nbsp;function&nbsp; window.onbeforeunload(){<br>
&nbsp;&nbsp;if(event.clientX&gt;360&amp;&amp;event.clientY&lt;0||event.altKey){&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;//alert(&quot;dddddddddd&quot;);<br>
&nbsp;&nbsp;&nbsp;Logout();<br>
&nbsp;&nbsp;}&nbsp;&nbsp; <br>
&nbsp;}&nbsp;&nbsp; <br>
&nbsp;function&nbsp; Logout(){&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp; try{&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlHttp = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp; }catch(e){&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlHttp = new XMLHttpRequest();&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp; //数据传输,flase为非异步方式<br>
&nbsp;&nbsp;&nbsp;&nbsp; xmlHttp.open(&quot;post&quot;,&quot;enter.asp?Active=Logout&quot;,true);&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp; xmlHttp.send(null);&nbsp;&nbsp; <br>
&nbsp;}&nbsp;&nbsp; <br>
&lt;/script&gt;&nbsp;&nbsp; </p>
</div>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/5/3 14:33:49 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7531461">原文链接</a>
            </div>
            <div>
            阅读：333 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7531461#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[转]存储过程生成所有实体类]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7527241</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7527241</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/5/2 10:35:45</pubDate>
        <description><![CDATA[
            
<pre class="sql" name="code">set ANSI_NULLS ON
set QUOTED_IDENTIFIER ON
go
 
create proc [dbo].[p_db_wsp]
@dbname varchar(50),   --数据库名
@path varchar(100),    --实体类所在目录名，如D:/My/Models
@namespace varchar(50) --实体类命名空间,默认值为Models
as
--判断数据库是否存在
if(db_id(@dbname)is not null)
begin
if(isnull(@namespace,'')='')
set @namespace='Models'
-- 允许配置高级选项
EXEC sp_configure 'show advanced options', 1
-- 重新配置
RECONFIGURE
-- 启用Ole Automation Procedures 
EXEC sp_configure 'Ole Automation Procedures', 1
-- 启用xp_cmdshell,可以向磁盘中写入文件
EXEC sp_configure 'xp_cmdshell', 1
-- 重新配置
RECONFIGURE
declare @dbsql varchar(1000),@tablename varchar(100)
set @dbsql='declare wsp cursor for select name from '+@dbname+'..sysobjects where xtype=''u''  and name &lt;&gt;''sysdiagrams'''
exec(@dbsql)
open wsp
fetch wsp into @tablename--使用游标循环遍历数据库中每个表
while(@@fetch_status=0)
begin
--根据表中字段组合实体类中的字段和属性
declare @nsql nvarchar(4000),@sql varchar(8000)
set @nsql='select @s=isnull(@s+char(9)+''private '',''using System;'+char(13)+'using System.Collections.Generic;'
+char(13)+'using System.Text;'+char(13)+'namespace '+@namespace+char(13)+
'{'+char(13)+char(9)+'public class '+@tablename+char(13)+'{''+char(13)+char(9)+''private '')+
case when a.name in(''image'',''uniqueidentifier'',''ntext'',''varchar'',''ntext'',''nchar'',''nvarchar'',''text'',''char'') then ''string''
when a.name in(''tinyint'',''smallint'',''int'',''bigint'') then ''int''
when a.name in(''datetime'',''smalldatetime'') then ''DateTime''
when a.name in(''float'',''decimal'',''numeric'',''money'',''real'',''smallmoney'') then ''decimal''
when a.name =''bit'' then ''bool''
else a.name end+'' ''+lower(''_''+b.name)+'';''+char(13)+char(9)+''public ''+
case when a.name in(''image'',''uniqueidentifier'',''ntext'',''varchar'',''ntext'',''nchar'',''nvarchar'',''text'',''char'') then ''string''
when a.name in(''tinyint'',''smallint'',''int'') then ''int''
when a.name=''bigint'' then ''long''
when a.name in(''datetime'',''smalldatetime'') then ''DateTime''
when a.name in(''float'',''decimal'',''numeric'',''money'',''real'',''smallmoney'') then ''decimal''
when a.name =''bit'' then ''bool''
else a.name end
+'' ''+b.name+char(13)+char(9)+''{''+char(13)+char(9)+char(9)+''get{return ''+lower(''_''+b.name)+'';}''+
char(13)+char(9)+char(9)+''set{''+lower(''_''+b.name)+''=value;}''+char(13)+char(9)+''}''+char(13)
from '+@dbname+'..syscolumns b,
(select distinct name,xtype from '+@dbname+'..systypes where status=0) a
where a.xtype=b.xtype and b.id=object_id('''+@dbname+'..'+@tablename+''')'
exec sp_executesql @nsql,N'@s varchar(8000) output',@sql output
set @sql=@sql+char(9)+'}'+char(13)+'}'
--print @sql
DECLARE @err INT,@fso INT,@fleExists BIT,@file VARCHAR(100)
SET @file=@path+'/'+@tablename+'.cs'
EXEC @err=sp_OACreate 'Scripting.FileSystemObject',@fso OUTPUT
EXEC @err=sp_OAMethod @fso, 'FileExists',@fleExists OUTPUT,@file
EXEC @err = sp_OADestroy @fso
 
IF @fleExists!=0
exec('exec xp_cmdshell ''del '+@file+'''') --存在则删除
exec('exec xp_cmdshell ''echo '+@sql+' &gt; '+@file+'''') --将文本写进文件中
set @sql=null
fetch wsp into @tablename
end
close wsp
deallocate wsp
print '生成成功！'
end
else
print '数据库不存在！'
 



</pre><br>
调用示例：<br>
<pre class="sql" name="code">exec [dbo].[p_db_wsp] 
                    '数据库名',
                    '如果你的项目在那个文件夹下面就直接写物理路径。例如：D:/My/Models',
                    '你需要给定的命名空间名称'



</pre><br>
使用：<br>
打开解决方案，点击解决方案资源管理器的“显示所有文件”<br>
看到生成的文件后鼠标右键选中，包括在项目中！<br>
1分钟内Model生成完毕。<br>
<br>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/5/2 10:35:45 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7527241">原文链接</a>
            </div>
            <div>
            阅读：584 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7527241#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
    <item>
        <title><![CDATA[[原]sql 日周月统计和]]></title>
        <link>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7492701</link>
        <guid>http://blog.csdn.net/adsdassadfasdfasdf/article/details/7492701</guid>
        <author>adsdassadfasdfasdf</author>
        <pubDate>2012/4/24 10:46:54</pubDate>
        <description><![CDATA[
            
<table style="width:100%; table-layout:fixed">
<tbody>
<tr>
<td>
<div id="blog_text" class="cnt">
<div>sql&nbsp;本日\本周\本月统计</div>
<div>
<p>SQL的本月统计和本周统计</p>
<p>本月统计(MySQL)<br>
select * from booking where month(booking_time) = month(curdate()) and year(booking_time) = year(curdate())<br>
<br>
本周统计(MySQL)<br>
select * from spf_booking where month(booking_time) = month(curdate()) and week(booking_time) = week(curdate())</p>
<p>&nbsp;</p>
<p>[SQLServer]<br>
表名为：tableName<br>
时间字段名为：theDate<br>
<br>
查询本月的记录<br>
select * from tableName where DATEPART(mm, theDate) = DATEPART(mm, GETDATE()) and DATEPART(yy, theDate) = DATEPART(yy, GETDATE())<br>
<br>
查询本周的记录<br>
select * from tableName where DATEPART(wk, theDate) = DATEPART(wk, GETDATE()) and DATEPART(yy, theDate) = DATEPART(yy, GETDATE())<br>
<br>
查询本季的记录<br>
select * from tableName where DATEPART(qq, theDate) = DATEPART(qq, GETDATE()) and DATEPART(yy, theDate) = DATEPART(yy, GETDATE())<br>
<br>
其中:GETDATE()是获得系统时间的函数。</p>
<p>&nbsp;</p>
<p><span style="color:#000000">如:&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="">表:consume_record&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="">字段:consume&nbsp;(money类型)&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="">date&nbsp;(datetime类型)&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="">请问怎么写四条sql语句分别按日,按周,按月,按季统计消费总量.&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="">如:1月&nbsp;1200元&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="">2月&nbsp;3400元&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="">3月&nbsp;2800元&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""><img src="http://www.cnblogs.com/Images/dot.gif" alt=""><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""></span><span style="color:#008080">--</span><span style="color:#008080">按日&nbsp;</span><span style="color:#008080"><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""></span><span style="color:#0000ff">select</span><span style="color:#000000">&nbsp;</span><span style="color:#ff00ff">sum</span><span style="color:#000000">(consume),</span><span style="color:#ff00ff">day</span><span style="color:#000000">(</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">)&nbsp;</span><span style="color:#0000ff">from</span><span style="color:#000000">&nbsp;consume_record&nbsp;</span><span style="color:#0000ff">where</span><span style="color:#000000">&nbsp;</span><span style="color:#ff00ff">year</span><span style="color:#000000">(</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">)&nbsp;</span><span style="color:#808080">=</span><span style="color:#000000">&nbsp;</span><span style="color:#ff0000">'</span><span style="color:#ff0000">2006</span><span style="color:#ff0000">'</span><span style="color:#000000">&nbsp;</span><span style="color:#0000ff">group</span><span style="color:#000000">&nbsp;</span><span style="color:#0000ff">by</span><span style="color:#000000">&nbsp;</span><span style="color:#ff00ff">day</span><span style="color:#000000">(</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">)&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""></span><span style="color:#008080">--</span><span style="color:#008080">按周quarter&nbsp;</span><span style="color:#008080"><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""></span><span style="color:#0000ff">select</span><span style="color:#000000">&nbsp;</span><span style="color:#ff00ff">sum</span><span style="color:#000000">(consume),</span><span style="color:#ff00ff">datename</span><span style="color:#000000">(week,</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">)&nbsp;</span><span style="color:#0000ff">from</span><span style="color:#000000">&nbsp;consume_record&nbsp;</span><span style="color:#0000ff">where</span><span style="color:#000000">&nbsp;</span><span style="color:#ff00ff">year</span><span style="color:#000000">(</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">)&nbsp;</span><span style="color:#808080">=</span><span style="color:#000000">&nbsp;</span><span style="color:#ff0000">'</span><span style="color:#ff0000">2006</span><span style="color:#ff0000">'</span><span style="color:#000000">&nbsp;</span><span style="color:#0000ff">group</span><span style="color:#000000">&nbsp;</span><span style="color:#0000ff">by</span><span style="color:#000000">&nbsp;</span><span style="color:#ff00ff">datename</span><span style="color:#000000">(week,</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">)&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""></span><span style="color:#008080">--</span><span style="color:#008080">按月&nbsp;</span><span style="color:#008080"><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""></span><span style="color:#0000ff">select</span><span style="color:#000000">&nbsp;</span><span style="color:#ff00ff">sum</span><span style="color:#000000">(consume),</span><span style="color:#ff00ff">month</span><span style="color:#000000">(</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">)&nbsp;</span><span style="color:#0000ff">from</span><span style="color:#000000">&nbsp;consume_record&nbsp;</span><span style="color:#0000ff">where</span><span style="color:#000000">&nbsp;</span><span style="color:#ff00ff">year</span><span style="color:#000000">(</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">)&nbsp;</span><span style="color:#808080">=</span><span style="color:#000000">&nbsp;</span><span style="color:#ff0000">'</span><span style="color:#ff0000">2006</span><span style="color:#ff0000">'</span><span style="color:#000000">&nbsp;</span><span style="color:#0000ff">group</span><span style="color:#000000">&nbsp;</span><span style="color:#0000ff">by</span><span style="color:#000000">&nbsp;</span><span style="color:#ff00ff">month</span><span style="color:#000000">(</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">)&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""></span><span style="color:#008080">--</span><span style="color:#008080">按季&nbsp;</span><span style="color:#008080"><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""></span><span style="color:#0000ff">select</span><span style="color:#000000">&nbsp;</span><span style="color:#ff00ff">sum</span><span style="color:#000000">(consume),</span><span style="color:#ff00ff">datename</span><span style="color:#000000">(quarter,</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">)&nbsp;</span><span style="color:#0000ff">from</span><span style="color:#000000">&nbsp;consume_record&nbsp;</span><span style="color:#0000ff">where</span><span style="color:#000000">&nbsp;</span><span style="color:#ff00ff">year</span><span style="color:#000000">(</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">)&nbsp;</span><span style="color:#808080">=</span><span style="color:#000000">&nbsp;</span><span style="color:#ff0000">'</span><span style="color:#ff0000">2006</span><span style="color:#ff0000">'</span><span style="color:#000000">&nbsp;</span><span style="color:#0000ff">group</span><span style="color:#000000">&nbsp;</span><span style="color:#0000ff">by</span><span style="color:#000000">&nbsp;</span><span style="color:#ff00ff">datename</span><span style="color:#000000">(quarter,</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">)&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="">&nbsp;<br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""></span><span style="color:#008080">--</span><span style="color:#008080">指定日期你就看上面的例子变通下呀，无非就是一个聚合函数和Group&nbsp;by&nbsp;</span><span style="color:#008080"><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""></span><span style="color:#000000"><br>
<img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""></span><span style="color:#0000ff">select</span><span style="color:#000000">&nbsp;</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">,</span><span style="color:#ff00ff">sum</span><span style="color:#000000">(consume)&nbsp;</span><span style="color:#0000ff">from</span><span style="color:#000000">&nbsp;consume_record&nbsp;</span><span style="color:#0000ff">where</span><span style="color:#000000">&nbsp;</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">&nbsp;</span><span style="color:#808080">between</span><span style="color:#000000">&nbsp;</span><span style="color:#ff0000">'</span><span style="color:#ff0000">2006-06-01</span><span style="color:#ff0000">'</span><span style="color:#000000">&nbsp;</span><span style="color:#808080">and</span><span style="color:#000000">&nbsp;</span><span style="color:#ff0000">'</span><span style="color:#ff0000">2006-07-10</span><span style="color:#ff0000">'</span><span style="color:#000000">&nbsp;</span><span style="color:#0000ff">group</span><span style="color:#000000">&nbsp;</span><span style="color:#0000ff">by</span><span style="color:#000000">&nbsp;</span><span style="color:#ff0000">[</span><span style="color:#ff0000">date</span><span style="color:#ff0000">]</span><span style="color:#000000">&nbsp;</span></p>
<p>&nbsp;</p>
<p><span style="color:#000000">统计博客聚合用户点击次数<br>
SELECT author, SUM(hits) AS hits<br>
FROM infos<br>
GROUP BY author<br>
ORDER BY hits DESC</span></p>
<p><span style="color:#000000">统计昨天的记录<br>
SELECT *<br>
FROM infos<br>
WHERE (DATEDIFF(d, pubdate, GETDATE()) = 1)</span></p>
<p><span style="color:#000000">统计本周的记录<br>
SELECT *<br>
FROM infos<br>
WHERE (DATEPART(yy, pubdate) = DATEPART(yy, GETDATE())) AND (DATEPART(week,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pubdate - 1) = DATEPART(week, GETDATE()))</span></p>
<p><span style="color:#000000">统计本月的记录:<br>
SELECT *<br>
FROM infos<br>
WHERE (DATEPART(yy, pubdate) = DATEPART(yy, GETDATE())) AND (DATEPART([month],<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pubdate - 1) = DATEPART([month], GETDATE()))</span></p>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<br>

            <div>
                作者：adsdassadfasdfasdf 发表于2012/4/24 10:46:54 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7492701">原文链接</a>
            </div>
            <div>
            阅读：1710 评论：0 <a href="http://blog.csdn.net/adsdassadfasdfasdf/article/details/7492701#comments" target="_blank">查看评论</a>
            </div>
        ]]>
        </description>
        <category></category>
    </item>
</channel>
</rss>
