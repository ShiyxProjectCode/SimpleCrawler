<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom"><title type="text">博客园_moss_tan_jun</title><subtitle type="text"></subtitle><id>uuid:27fc9aac-5a52-4f2d-9f21-2f058553e976;id=7399</id><updated>2013-06-21T08:46:02Z</updated><author><name>moss_tan_jun</name><uri>http://www.cnblogs.com/moss_tan_jun/</uri></author><generator>feed.cnblogs.com</generator><entry><id>http://www.cnblogs.com/moss_tan_jun/p/3148650.html</id><title type="text">SQL Server：sp_send_dbmail参数设置 - moss_tan_jun</title><summary type="text">sp_send_dbmail[[@profile_name=]'profile_name'][,[@recipients=]'recipients[;n]'][,[@copy_recipients=]'copy_recipient[;n]'][,[@blind_copy_recipients=]'blind_copy_recipient[;n]'][,[@subject=]'subject'][,[@body=]'body'][,[@body_format=]'body_format&amp;#39</summary><published>2013-06-21T08:46:00Z</published><updated>2013-06-21T08:46:00Z</updated><author><name>moss_tan_jun</name><uri>http://www.cnblogs.com/moss_tan_jun/</uri></author><link rel="alternate" href="http://www.cnblogs.com/moss_tan_jun/p/3148650.html" /><link rel="alternate" type="text/html" href="http://www.cnblogs.com/moss_tan_jun/p/3148650.html" /><content type="html">&lt;p&gt;&lt;span style="color: #000000;"&gt;sp_send_dbmail&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;[&amp;nbsp;@profile_name&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;profile_name&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@recipients&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;recipients&amp;nbsp;[&amp;nbsp;;&amp;nbsp;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/dot.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;n&amp;nbsp;]&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@copy_recipients&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;copy_recipient&amp;nbsp;[&amp;nbsp;;&amp;nbsp;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/dot.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;n&amp;nbsp;]&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@blind_copy_recipients&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;blind_copy_recipient&amp;nbsp;[&amp;nbsp;;&amp;nbsp;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/dot.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;n&amp;nbsp;]&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@subject&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;subject&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&amp;nbsp;&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@body&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;body&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&amp;nbsp;&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@body_format&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;body_format&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@importance&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;importance&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@sensitivity&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;sensitivity&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@file_attachments&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;attachment&amp;nbsp;[&amp;nbsp;;&amp;nbsp;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/dot.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;n&amp;nbsp;]&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@query&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;query&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@execute_query_database&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;execute_query_database&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@attach_query_result_as_file&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;attach_query_result_as_file&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@query_attachment_filename&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;query_attachment_filename&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@query_result_header&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;query_result_header&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@query_result_width&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;query_result_width&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@query_result_separator&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;query_result_separator&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@exclude_query_output&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;exclude_query_output&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@append_query_error&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;append_query_error&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@query_no_truncate&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;query_no_truncate&amp;nbsp;]&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;,&amp;nbsp;[&amp;nbsp;@mailitem_id&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;mailitem_id&amp;nbsp;]&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;[&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;&amp;nbsp;OUTPUT&amp;nbsp;&lt;/span&gt;&lt;span style="color: #ff0000;"&gt;]&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;参数&lt;/p&gt;&lt;div&gt;&lt;div&gt;&lt;a name="sectionToggle0"&gt;&lt;/a&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@profile_name&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;profile_name&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;发送邮件的配置文件的名称。&lt;em&gt;profile_name&lt;/em&gt; 的类型为 &lt;strong&gt;sysname&lt;/strong&gt;，默认值为 NULL。&lt;em&gt;profile_name&lt;/em&gt; 必须是现有数据库邮件配置文件的名称。如果未指定 &lt;em&gt;profile_name&lt;/em&gt;，则 &lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 使用当前用户的默认专用配置文件。如果该用户没有默认专用配置文件，&lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 会使用 &lt;strong&gt;msdb&lt;/strong&gt; 数据库的默认公共配置文件。如果用户没有默认的专用配置文件，而且数据库也没有默认的公共配置文件，则必须指定 &lt;strong&gt;@profile_name&lt;/strong&gt;。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@recipients&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;recipients&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;要向其发送邮件的电子邮件地址列表，以分号分隔。收件人列表的类型为 &lt;strong&gt;varchar(max)&lt;/strong&gt;。虽然此参数是可选参数，但是必须至少指定 &lt;strong&gt;@recipients&lt;/strong&gt;、&lt;strong&gt;@copy_recipients&lt;/strong&gt; 或 &lt;strong&gt;@blind_copy_recipients&lt;/strong&gt; 中的一个，否则 &lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 将返回错误。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@copy_recipients&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;copy_recipients&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;要向其抄送邮件的电子邮件地址列表，以分号分隔。抄送件收件人列表的类型为 &lt;strong&gt;varchar(max)&lt;/strong&gt;。虽然此参数是可选参数，但是必须至少指定 &lt;strong&gt;@recipients&lt;/strong&gt;、&lt;strong&gt;@copy_recipients&lt;/strong&gt; 或 &lt;strong&gt;@blind_copy_recipients&lt;/strong&gt; 中的一个，否则 &lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 将返回错误。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@blind_copy_recipients&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;blind_copy_recipients&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;要向其密件抄送邮件的电子邮件地址列表，以分号分隔。密件副本收件人列表的类型为 &lt;strong&gt;varchar(max)&lt;/strong&gt;。虽然此参数是可选参数，但是必须至少指定 &lt;strong&gt;@recipients&lt;/strong&gt;、&lt;strong&gt;@copy_recipients&lt;/strong&gt; 或 &lt;strong&gt;@blind_copy_recipients&lt;/strong&gt; 中的一个，否则 &lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 将返回错误。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@subject&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;subject&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;电子邮件的主题。主题的类型为 &lt;strong&gt;nvarchar(255)&lt;/strong&gt;。如果未指定主题，则默认为&amp;ldquo;SQL Server 消息&amp;rdquo;。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@body&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;body&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;电子邮件的正文。邮件正文的类型为 &lt;strong&gt;nvarchar(max)&lt;/strong&gt;，默认值为 NULL。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@body_format&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;body_format&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;邮件正文的格式。该参数的类型为 &lt;strong&gt;varchar(20)&lt;/strong&gt;，默认值为 NULL。如果已指定，则待发邮件的标头设置会指示邮件正文具有指定格式。该参数可能包含下列值之一：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;TEXT&lt;/li&gt;&lt;li&gt;HTML&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;默认为 TEXT。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@importance&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;importance&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;邮件的重要性。该参数的类型为 &lt;strong&gt;varchar(6)&lt;/strong&gt;。该参数可能包含下列值之一：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Low&lt;/li&gt;&lt;li&gt;Normal&lt;/li&gt;&lt;li&gt;High&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;默认值为 Normal。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@sensitivity&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;sensitivity&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;邮件的敏感度。该参数的类型为 &lt;strong&gt;varchar(12)&lt;/strong&gt;。该参数可能包含下列值之一：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Normal&lt;/li&gt;&lt;li&gt;Personal&lt;/li&gt;&lt;li&gt;Private&lt;/li&gt;&lt;li&gt;Confidential&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;默认值为 Normal。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@file_attachments&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;file_attachments&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;,&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;电子邮件附件的文件名列表，以分号分隔。必须使用绝对路径指定列表中的文件。附件列表的类型为 &lt;strong&gt;nvarchar(max)&lt;/strong&gt;。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@query&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;query&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;要执行的查询。查询结果可以作为文件附加，或包含在电子邮件的正文中。查询的类型为 &lt;strong&gt;nvarchar(max)&lt;/strong&gt;，并且可以包含任何有效的 Transact-SQL 语句。请注意，查询在单独的会话中执行，所以调用 &lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 的脚本中的局部变量不可用于查询。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@execute_query_database&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;execute_query_database&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;存储过程在其中运行查询的数据库上下文。该参数的类型为 &lt;strong&gt;sysname&lt;/strong&gt;，默认为当前数据库。只有在指定 &lt;strong&gt;@query&lt;/strong&gt; 时，此参数才适用。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@attach_query_result_as_file&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;em&gt;attach_query_result_as_file&lt;/em&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;指定查询结果集是否作为附件返回。&lt;em&gt;attach_query_result_as_file&lt;/em&gt; 的数据类型为 &lt;strong&gt;bit&lt;/strong&gt;，默认值为 0。&lt;/p&gt;&lt;p&gt;如果该值为 0，则查询结果包含在电子邮件的正文中，在 &lt;strong&gt;@body&lt;/strong&gt; 参数的内容之后。如果该值为 1，则结果作为附件返回。只有在指定 &lt;strong&gt;@query&lt;/strong&gt; 时，此参数才适用。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@query_attachment_filename&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;em&gt;query_attachment_filename&lt;/em&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;指定查询结果集附件使用的文件名。&lt;em&gt;query_attachment_filename&lt;/em&gt; 的数据类型为 &lt;strong&gt;nvarchar(255)&lt;/strong&gt;，默认值为 NULL。如果 &lt;em&gt;attach_query_result&lt;/em&gt; 为 0，则忽略此参数。如果 &lt;em&gt;attach_query_result&lt;/em&gt; 为 1 且此参数为 NULL，则数据库邮件会创建任意文件名。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@query_result_header&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;em&gt;query_result_header&lt;/em&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;指定查询结果是否包含列标题。query_result_header 值的数据类型为 &lt;strong&gt;bit&lt;/strong&gt;。如果该值为 1，则查询结果包含列标题。如果该值为 0，则查询结果不包含列标题。该参数的默认值为 &lt;strong&gt;1&lt;/strong&gt;。只有在指定 &lt;strong&gt;@query&lt;/strong&gt; 时，此参数才适用。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@query_result_width&lt;/strong&gt; = ] &lt;em&gt;query_result_width&lt;/em&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;用于设置查询结果的格式的线条宽度（字符）。&lt;em&gt;query_result_width&lt;/em&gt; 的数据类型为 &lt;strong&gt;int&lt;/strong&gt;，默认值为 256。提供的值必须介于 10 和 32767 之间。只有在指定 &lt;strong&gt;@query&lt;/strong&gt; 时，此参数才适用。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@query_result_separator&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;strong&gt;'&lt;/strong&gt;&lt;em&gt;query_result_separator&lt;/em&gt;&lt;strong&gt;'&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;用于分隔查询输出中的列的字符。分隔符的类型为 &lt;strong&gt;char(1)&lt;/strong&gt;。默认为&amp;ldquo; &amp;rdquo;（空格）。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@exclude_query_output&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;em&gt;exclude_query_output&lt;/em&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;指定是否使用电子邮件返回查询执行的输出。&lt;strong&gt;exclude_query_output&lt;/strong&gt; 的数据类型为 bit，默认值为 0。当此参数为 0 时，&lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 存储过程的执行将在控制台上打印作为查询执行结果而返回的消息。当此参数为 1 时，&lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 存储过程的执行不会在控制台上打印任何查询执行消息。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@append_query_error&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;em&gt;append_query_error&lt;/em&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;指定是否在 &lt;strong&gt;@query&lt;/strong&gt; 参数指定的查询返回错误时发送电子邮件。&lt;strong&gt;append_query_error&lt;/strong&gt; 的数据类型为 &lt;strong&gt;bit&lt;/strong&gt;，默认值为 0。如果此参数的值为 1，则数据库邮件会发送电子邮件，并电子邮件的正文中显示查询错误消息。如果此参数的值为 0，则数据库邮件不发送电子邮件，&lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 在结束时会返回代码 1，指示失败。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@query_no_truncate&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;em&gt;query_no_truncate&lt;/em&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;指定是否使用可避免截断大型可变长度数据类型（&lt;strong&gt;varchar(max)&lt;/strong&gt;、&lt;strong&gt;nvarchar(max)&lt;/strong&gt;、&lt;strong&gt;varbinary(max)&lt;/strong&gt;、&lt;strong&gt;xml&lt;/strong&gt;、&lt;strong&gt;text&lt;/strong&gt;、&lt;strong&gt;ntext&lt;/strong&gt;、&lt;strong&gt;image&lt;/strong&gt; 和用户定义类型）的选项执行查询。设置该选项后，查询结果将不包含列标题。&lt;em&gt;query_no_truncate&lt;/em&gt; 值的数据类型为 &lt;strong&gt;bit&lt;/strong&gt;。当该值为 0 或未指定时，查询中的列将截断为 256 个字符。当该值为 1 时，不截断查询中的列。此参数的默认值为 0。&lt;/p&gt;&lt;div&gt;&lt;table style="width: 100%;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th align="left"&gt;注意：&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;与大量数据一起使用时，@&lt;strong&gt;query_no_truncate&lt;/strong&gt; 选项会占用其他资源，并可降低服务器的性能。&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;/div&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;dl&gt;&lt;dt&gt;[ &lt;strong&gt;@mailitem_id&lt;/strong&gt;&lt;strong&gt;=&lt;/strong&gt; ] &lt;em&gt;mailitem_id&lt;/em&gt; [ OUTPUT ]&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;可选输出参数将返回消息的 &lt;em&gt;mailitem_id&lt;/em&gt;。&lt;em&gt;mailitem_id&lt;/em&gt; 的类型为 &lt;strong&gt;int&lt;/strong&gt;。&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://technet.microsoft.com/Platform/Controls/CollapsibleArea/resources/minus.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;返回代码值&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;a name="sectionToggle1"&gt;&lt;/a&gt;&lt;p&gt;0（成功）或 1（失败）&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://technet.microsoft.com/Platform/Controls/CollapsibleArea/resources/minus.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;结果集&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;a name="sectionToggle2"&gt;&lt;/a&gt;&lt;p&gt;成功时，返回消息&amp;ldquo;邮件已排队&amp;rdquo;。&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://technet.microsoft.com/Platform/Controls/CollapsibleArea/resources/plus.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;备注&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;a name="remarksToggle"&gt;&lt;/a&gt;&lt;p&gt;使用前，必须使用数据库邮件配置向导、SQL Server 外围应用配置器工具或 &lt;strong&gt;sp_configure&lt;/strong&gt; 启用数据库邮件。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;sysmail_stop_sp&lt;/strong&gt; 通过停止外部程序使用的 Service Broker 对象来停止数据库邮件。使用 &lt;strong&gt;sysmail_stop_sp&lt;/strong&gt; 停止数据库邮件后，&lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 仍会接受邮件。若要启动数据库邮件，请使用 &lt;strong&gt;sysmail_start_sp&lt;/strong&gt;。&lt;/p&gt;&lt;p&gt;如果未指定 &lt;strong&gt;@profile&lt;/strong&gt;，则 &lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 使用默认配置文件。如果发送电子邮件的用户具有默认专用配置文件，则数据库邮件使用该配置文件。如果该用户没有默认的专用配置文件，则 &lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 将使用默认的公共配置文件。如果用户没有默认的专用配置文件和默认的公共配置文件，则 &lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 将返回错误。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 不支持没有任何内容的电子邮件。若要发送电子邮件，至少必须指定 &lt;strong&gt;@body&lt;/strong&gt;、&lt;strong&gt;@query&lt;/strong&gt;、&lt;strong&gt;@file_attachments&lt;/strong&gt; 或 &lt;strong&gt;@subject&lt;/strong&gt; 之一。否则，&lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 会返回错误。&lt;/p&gt;&lt;p&gt;数据库邮件使用当前用户的 Microsoft Windows 安全上下文控制对文件的访问。因此，经过 SQL Server 身份验证的用户无法使用 &lt;strong&gt;@file_attachments&lt;/strong&gt; 附加文件。Windows 不允许 SQL Server 从一台远程计算机向另一台远程计算机提供凭据。所以，如果从运行 SQL Server 的计算机以外的计算机运行该命令，则数据库邮件可能无法从网络共享附加文件。&lt;/p&gt;&lt;p&gt;如果已同时指定 &lt;strong&gt;@query&lt;/strong&gt; 和 &lt;strong&gt;@file_attachments&lt;/strong&gt; 且未找到文件，则查询仍然会执行，但是不会发送电子邮件。&lt;/p&gt;&lt;p&gt;指定查询后，结果集的格式被设置为内联文本。使用十六进制格式发送结果中的二进制数据。&lt;/p&gt;&lt;p&gt;参数 &lt;strong&gt;@recipients&lt;/strong&gt;、&lt;strong&gt;@copy_recipients&lt;/strong&gt; 和 &lt;strong&gt;@blind_copy_recipients&lt;/strong&gt; 是以分号分隔的电子邮件地址列表。至少必须提供以上参数之一，否则 &lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 会返回错误。&lt;/p&gt;&lt;p&gt;在没有事务上下文的情况下执行 &lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 时，数据库邮件将启动并提交隐式事务。从现有事务内执行 &lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 时，数据库邮件将依赖用户提交或回滚任何更改。它不会启动内部事务。&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://technet.microsoft.com/Platform/Controls/CollapsibleArea/resources/minus.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;权限&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;a name="sectionToggle3"&gt;&lt;/a&gt;&lt;p&gt;默认情况下，&lt;strong&gt;msdb&lt;/strong&gt; 数据库中的 &lt;strong&gt;DatabaseMailUser&lt;/strong&gt; 数据库角色的所有成员对 &lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 都有执行权限。不过，如果发送邮件的用户不具有使用该请求的配置文件的权限，&lt;strong&gt;sp_send_dbmail&lt;/strong&gt; 会返回错误且不发送该邮件。&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;img title="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" src="http://technet.microsoft.com/Platform/Controls/CollapsibleArea/resources/minus.gif" alt="SQL&amp;nbsp;&amp;lt;wbr&amp;gt;Server：sp_send_dbmail参数设置（转载）" /&gt;&amp;nbsp;示例&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;a name="sectionToggle4"&gt;&lt;/a&gt;&lt;p&gt;&lt;strong&gt;A. 发送电子邮件&lt;/strong&gt;&lt;/p&gt;&lt;div&gt;&lt;p&gt;此示例使用电子邮件地址 &lt;tt&gt;danw@Adventure-Works.com&lt;/tt&gt; 向 Dan Wilson 发送电子邮件。该邮件的主题为 &lt;tt&gt;Automated Success Message&lt;/tt&gt;。邮件正文包含一句话 &lt;tt&gt;'The stored procedure finished successfully'&lt;/tt&gt;。&lt;/p&gt;&lt;div&gt;EXEC msdb.dbo.sp_send_dbmail@profile_name = 'AdventureWorks Administrator',@recipients = 'danw@Adventure-Works.com',@body = 'The stored procedure finished successfully.',@subject = 'Automated Success Message' ;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;B. 发送包含查询结果的电子邮件&lt;/strong&gt;&lt;/p&gt;&lt;div&gt;&lt;p&gt;此示例使用电子邮件地址 &lt;tt&gt;danw@Adventure-Works.com&lt;/tt&gt; 向 Dan Wilson 发送电子邮件。该邮件的主题为 &lt;tt&gt;Work Order Count&lt;/tt&gt;，并执行查询以显示 &lt;tt&gt;DueDate&lt;/tt&gt; 在 2004 年 4 月 30 日后的两日内的工单数。数据库邮件将该结果附加为文本文件。&lt;/p&gt;&lt;div&gt;EXEC msdb.dbo.sp_send_dbmail@profile_name = 'AdventureWorks Administrator',@recipients = 'danw@Adventure-Works.com',@query = 'SELECT COUNT(*) FROM AdventureWorks.Production.WorkOrderWHERE DueDate &amp;gt; ''2004-04-30''AND DATEDIFF(dd, ''2004-04-30'', DueDate) &amp;lt; 2' ,@subject = 'Work Order Count',@attach_query_result_as_file = 1 ;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;A. 发送 HTML 电子邮件&lt;/strong&gt;&lt;/p&gt;&lt;div&gt;&lt;p&gt;此示例使用电子邮件地址 &lt;tt&gt;danw@Adventure-Works.com&lt;/tt&gt; 向 Dan Wilson 发送电子邮件。邮件的主题为 &lt;tt&gt;Work Order List&lt;/tt&gt;，并包含一个 HTML 文档，其中列出 &lt;tt&gt;DueDate&lt;/tt&gt; 在 2004 年 4 月 30 日后的二日内的工单。数据库邮件使用 HTML 格式发送该邮件。&lt;/p&gt;&lt;div&gt;DECLARE @tableHTML NVARCHAR(MAX) ;SET @tableHTML =N'&amp;lt;H1&amp;gt;Work Order Report&amp;lt;/H1&amp;gt;' +N'&amp;lt;table border="1"&amp;gt;' +N'&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Work Order ID&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Product ID&amp;lt;/th&amp;gt;' +N'&amp;lt;th&amp;gt;Name&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Order Qty&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Due Date&amp;lt;/th&amp;gt;' +N'&amp;lt;th&amp;gt;Expected Revenue&amp;lt;/th&amp;gt;&amp;lt;/tr&amp;gt;' +CAST ( ( SELECT td = wo.WorkOrderID, '',td = p.ProductID, '',td = p.Name, '',td = wo.OrderQty, '',td = wo.DueDate, '',td = (p.ListPrice - p.StandardCost) * wo.OrderQtyFROM AdventureWorks.Production.WorkOrder as woJOIN AdventureWorks.Production.Product AS pON wo.ProductID = p.ProductIDWHERE DueDate &amp;gt; '2004-04-30'AND DATEDIFF(dd, '2004-04-30', DueDate) &amp;lt; 2ORDER BY DueDate ASC,(p.ListPrice - p.StandardCost) * wo.OrderQty DESCFOR XML PATH('tr'), TYPE) AS NVARCHAR(MAX) ) +N'&amp;lt;/table&amp;gt;' ;EXEC msdb.dbo.sp_send_dbmail @recipients='danw@Adventure-Works.com',@subject = 'Work Order List',@body = @tableHTML,@body_format = 'HTML' ;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;img src="http://counter.cnblogs.com/blog/rss/3148650" width="1" height="1" alt=""/&gt;&lt;br/&gt;&lt;p&gt;本文链接：&lt;a href="http://www.cnblogs.com/moss_tan_jun/p/3148650.html" target="_blank"&gt;http://www.cnblogs.com/moss_tan_jun/p/3148650.html&lt;/a&gt;，转载请注明。&lt;/p&gt;</content></entry><entry><id>http://www.cnblogs.com/moss_tan_jun/archive/2013/03/25/2980644.html</id><title type="text">23个C#经典实用技巧 - moss_tan_jun</title><summary type="text">这些技巧不好找，我归类总结了一下，对大家访问使用也方便，好了，列表如下：1.怎样定制VC#DataGrid列标题？ DataGridTableStyledgts=newDataGridTableStyle(); dgts.MappingName="myTable";//myTable为要载入数据的DataTable DataGridTextBoxColumndgcs=newDataGridTextBoxColumn(); dgcs.MappingName="title_id"; dgcs.HeaderText="标题ID"; dgts</summary><published>2013-03-25T05:54:00Z</published><updated>2013-03-25T05:54:00Z</updated><author><name>moss_tan_jun</name><uri>http://www.cnblogs.com/moss_tan_jun/</uri></author><link rel="alternate" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/03/25/2980644.html" /><link rel="alternate" type="text/html" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/03/25/2980644.html" /><content type="html">&lt;p&gt;这些技巧不好找，我归类总结了一下，对大家访问使用也方便，好了，列表如下：&amp;nbsp;&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;1.怎样定制VC#DataGrid列标题？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　DataGridTableStyle&amp;nbsp;dgts&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;DataGridTableStyle();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dgts.MappingName&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"myTable"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&lt;/span&gt;&lt;span class="comment"&gt;&lt;span style="color: #008200;"&gt;//myTable为要载入数据的DataTable&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　DataGridTextBoxColumn&amp;nbsp;dgcs&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;DataGridTextBoxColumn();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dgcs.MappingName&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"title_id"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dgcs.HeaderText&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"标题ID"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dgts.GridColumnStyles.Add(dgcs);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　。。。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dataGrid1.TableStyles.Add(dgts);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　2.检索某个字段为空的所有记录的条件语句怎么写？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　...where&amp;nbsp;col_name&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;is&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;null&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　3.如何在c#&amp;nbsp;Winform应用中接收回车键输入？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　设一下form的AcceptButton.&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　4.比如Oracle中的NUMBER(15)，在Sql&amp;nbsp;Server中应是什么？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　NUMBER(15):用numeric，精度15试试。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　5.sql&amp;nbsp;server的应用like语句的存储过程怎样写?&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　select&amp;nbsp;*&amp;nbsp;from&amp;nbsp;mytable&amp;nbsp;where&amp;nbsp;haoma&amp;nbsp;like&amp;nbsp;&amp;lsquo;%&amp;rsquo;&amp;nbsp;+&amp;nbsp;@hao&amp;nbsp;+&amp;nbsp;&amp;lsquo;%&amp;rsquo;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　6.vc#&amp;nbsp;winform中如何让textBox接受回车键消息（假没没有按钮的情况下）？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;textBox1_KeyPress(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;sender,&amp;nbsp;System.Windows.Forms.KeyPressEventArgs&amp;nbsp;e)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;(e.KeyChar&amp;nbsp;!=&amp;nbsp;(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;char&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;)13)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;return&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;else&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="comment"&gt;&lt;span style="color: #008200;"&gt;//do&amp;nbsp;something;&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　7.为什么(Int32)cmd.ExecuteScalar()赋值给Int32变量时提示转换无效?&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　Int32.Parse(cmd.ExecuteScalar().ToString());&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　8.DataSource为子表的DataGrid里怎样增加一个列以显示母表中的某个字段？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　在子表里手动添加一个列。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　DataColumn&amp;nbsp;dc&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;DataColumn(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"newCol"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;,&amp;nbsp;Type.GetType(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"System.String"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;));&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dc.Expression&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"Parent.parentColumnName"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dt.Columns.Add(dc);&amp;nbsp;&lt;/span&gt;&lt;span class="comment"&gt;&lt;span style="color: #008200;"&gt;//dt为子表&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　9.怎样使DataGrid显示DataTable中某列的数据时只显示某一部分？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　select&amp;nbsp;...,&amp;nbsp;SUBSTR(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;string&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;,&amp;nbsp;start_index,&amp;nbsp;end_index)&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;as&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;***,&amp;nbsp;***&amp;nbsp;from&amp;nbsp;***&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　10.如何让winform的combobox只能选不能输入？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　DropDownStyle&amp;nbsp;属性确定用户能否在文本部分中输入新值以及列表部分是否总显示。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　值:&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　DropDown&amp;nbsp;---&amp;nbsp;文本部分可编辑。用户必须单击箭头按钮来显示列表部分。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　DropDownList&amp;nbsp;---&amp;nbsp;用户不能直接编辑文本部分。用户必须单击箭头按钮来显示列表部分。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　Simple&amp;nbsp;---&amp;nbsp;文本部分可编辑。列表部分总可见。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　11.怎样使winform的DataGrid里显示的日期只显示年月日部分，去掉时间？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　sql语句里加上to_date(日期字段,&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;'yyyy-mm-dd'&lt;/span&gt;&lt;/span&gt;&lt;span&gt;)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　12.怎样把数据库表的二个列合并成一个列Fill进DataSet里？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dcChehao&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;DataColumn(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"newColumnName"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;,&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;typeof&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;string&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;));&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dcChehao.Expression&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"columnName1+columnName2"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dt.Columns.Add(dcChehao);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　Oracle：&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　select&amp;nbsp;col1　　col2&amp;nbsp;from&amp;nbsp;table&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　sql&amp;nbsp;server：&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　select&amp;nbsp;col1+col2&amp;nbsp;from&amp;nbsp;table&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　13.如何从合并后的字段里提取出括号内的文字作为DataGrid或其它绑定控件的显示内容？即把合并后的字段内容里的左括号（和右括号）之间的文字提取出来。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　Select&amp;nbsp;COL1,COL2,&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;case&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　when&amp;nbsp;COL3&amp;nbsp;like&amp;nbsp;&amp;lsquo;%（%&amp;rsquo;&amp;nbsp;THEN&amp;nbsp;substr(COL3,&amp;nbsp;INSTR(COL3,&amp;nbsp;&amp;lsquo;（&amp;rsquo;&amp;nbsp;)+1,&amp;nbsp;INSTR(COL3,&amp;lsquo;）&amp;rsquo;)-INSTR(COL3,&amp;lsquo;（&amp;rsquo;)-1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　end&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;as&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;COL3&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　from&amp;nbsp;MY_TABLE&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　14.当用鼠标滚轮浏览DataGrid数据超过一定范围DataGrid会失去焦点。怎样解决？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;.dataGrid1.MouseWheel+=&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;MouseEventHandler(dataGrid1_MouseWheel);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;dataGrid1_MouseWheel(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;sender,&amp;nbsp;MouseEventArgs&amp;nbsp;e)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;.dataGrid1.Select();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　15.怎样把键盘输入的&amp;lsquo;+&amp;rsquo;符号变成&amp;lsquo;A&amp;rsquo;？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　textBox的KeyPress事件中&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;(e.KeyChar&amp;nbsp;==&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;'+'&lt;/span&gt;&lt;/span&gt;&lt;span&gt;)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　SendKeys.Send(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"A"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　e.Handled&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;true&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　16.怎样使Winform启动时直接最大化？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;.WindowState&amp;nbsp;=&amp;nbsp;FormWindowState.Maximized;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　17.c#怎样获取当前日期及时间，在sql语句里又是什么？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　c#:&amp;nbsp;DateTime.Now&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　sql&amp;nbsp;server:&amp;nbsp;GetDate()&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　18.怎样访问winform&amp;nbsp;DataGrid的某一行某一列，或每一行每一列？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dataGrid[row,col]&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　19.怎样为DataTable进行汇总，比如DataTable的某列值&amp;lsquo;延吉'的列为多少？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dt.Select(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"城市='延吉'"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;).Length;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　20.DataGrid数据导出到Excel后0212等会变成212。怎样使它导出后继续显示为0212?&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　range.NumberFormat&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"0000"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;21.&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　①&amp;nbsp;怎样把DataGrid的数据导出到Excel以供打印？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　②&amp;nbsp;之前已经为DataGrid设置了TableStyle，即自定义了列标题和要显示的列，如果想以自定义的视图导出数据该怎么办？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　③&amp;nbsp;把数据导出到Excel后，怎样为它设置边框啊？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　④&amp;nbsp;怎样使从DataGrid导出到Excel的某个列居中对齐？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　⑤&amp;nbsp;数据从DataGrid导出到Excel后，怎样使标题行在打印时出现在每一页？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　⑥&amp;nbsp;DataGrid数据导出到Excel后打印时每一页显示&amp;rsquo;当前页/共几页&amp;rsquo;，怎样实现？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　①&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;button1_Click(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;sender,&amp;nbsp;System.EventArgs&amp;nbsp;e)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;row_index,&amp;nbsp;col_index;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　row_index&amp;nbsp;=&amp;nbsp;1;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　col_index&amp;nbsp;=&amp;nbsp;1;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　Excel.ApplicationClass&amp;nbsp;excel&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;Excel.ApplicationClass();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　excel.Workbooks.Add(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;true&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　DataTable&amp;nbsp;dt&amp;nbsp;=&amp;nbsp;ds.Tables[&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"table"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;];&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;foreach&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;(DataColumn&amp;nbsp;dcHeader&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;in&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;dt.Columns)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　excel.Cells[row_index,&amp;nbsp;col_index++]&amp;nbsp;=&amp;nbsp;dcHeader.ColumnName;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;foreach&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;(DataRow&amp;nbsp;dr&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;in&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;dt.Rows)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　col_index&amp;nbsp;=&amp;nbsp;0;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;foreach&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;(DataColumn&amp;nbsp;dc&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;in&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;dt.Columns)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　excel.Cells[row_index+1,&amp;nbsp;col_index+1]&amp;nbsp;=&amp;nbsp;dr[dc];&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　col_index++;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　row_index++;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　excel.Visible&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;true&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;Form1_Load(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;sender,&amp;nbsp;System.EventArgs&amp;nbsp;e)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　SqlConnection&amp;nbsp;conn&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;SqlConnection(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"server=tao;&amp;nbsp;uid=sa;&amp;nbsp;pwd=;&amp;nbsp;database=pubs"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　conn.Open();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　SqlDataAdapter&amp;nbsp;da&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;SqlDataAdapter(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"select&amp;nbsp;*&amp;nbsp;from&amp;nbsp;authors"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;,&amp;nbsp;conn);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　ds&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;DataSet();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　da.Fill(ds,&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"table"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　dataGrid1.DataSource&amp;nbsp;=&amp;nbsp;ds;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　dataGrid1.DataMember&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"table"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　②dataGrid1.TableStyles[0].GridColumnStyles[index].HeaderText;&amp;nbsp;&lt;/span&gt;&lt;span class="comment"&gt;&lt;span style="color: #008200;"&gt;//index可以从0~dataGrid1.TableStyles[0].GridColumnStyles.Count遍历。&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　③&amp;nbsp;Excel.Range&amp;nbsp;range;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　range=worksheet.get_Range(worksheet.Cells[1,1],xSt.Cells[ds.Tables[0].Rows.Count+1,ds.Tables[0].Columns.Count]);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　range.BorderAround(Excel.XlLineStyle.xlContinuous,Excel.XlBorderWeight.xlThin,Excel.XlColorIndex.xlColorIndexAutomatic,&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;null&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　range.Borders[Excel.XlBordersIndex.xlInsideHorizontal].ColorIndex&amp;nbsp;=&amp;nbsp;Excel.XlColorIndex.xlColorIndexAutomatic;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　range.Borders[Excel.XlBordersIndex.xlInsideHorizontal].LineStyle&amp;nbsp;=Excel.XlLineStyle.xlContinuous;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　range.Borders[Excel.XlBordersIndex.xlInsideHorizontal].Weight&amp;nbsp;=Excel.XlBorderWeight.xlThin;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　range.Borders[Excel.XlBordersIndex.xlInsideVertical].ColorIndex&amp;nbsp;=Excel.XlColorIndex.xlColorIndexAutomatic;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　range.Borders[Excel.XlBordersIndex.xlInsideVertical].LineStyle&amp;nbsp;=&amp;nbsp;Excel.XlLineStyle.xlContinuous;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　range.Borders[Excel.XlBordersIndex.xlInsideVertical].Weight&amp;nbsp;=&amp;nbsp;Excel.XlBorderWeight.xlThin;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　④&amp;nbsp;range.HorizontalAlignment&amp;nbsp;=&amp;nbsp;Excel.XlHAlign.xlHAlignCenter&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　⑤&amp;nbsp;worksheet.PageSetup.PrintTitleRows&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"$1:$1"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　⑥&amp;nbsp;worksheet.PageSetup.CenterFooter&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"第&amp;amp;P页&amp;nbsp;/&amp;nbsp;共&amp;amp;N页"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　22.当把DataGrid的Cell内容赋值到Excel的过程中想在DataGrid的CaptionText上显示进度，但不显示。WHY？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　...&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　dataGrid1.CaptionText&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"正在导出："&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;+&amp;nbsp;(row&amp;nbsp;+&amp;nbsp;1)&amp;nbsp;+&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"/"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;+&amp;nbsp;row_cnt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　System.Windows.Forms.Application.DoEvents();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　...&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　处理当前在消息队列中的所有Windows消息。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　当运行Windows窗体时，它将创建新窗体，然后该窗体等待处理事件。该窗体在每次处理事件时，均将处理与该事件关联的所有代码。所有其他事件在队列中等待。在代码处理事件时，应用程序并不响应。如果在代码中调用DoEvents,则应用程序可以处理其他事件。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;　　如果从代码中移除DoEvents，那么在按钮的单机事件处理程序执行结束以前，窗体不会重新绘制。通常在循环中使用该方法来处理消息。&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　23.怎样从Flash调用外部程序，如一个C#编译后生成的.exe?&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　fscommand(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"exec"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;,&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"应用程序.exe"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　①&amp;nbsp;必须把flash发布为.exe&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　②&amp;nbsp;必须在flash生成的.exe文件所在目录建一个名为fscommand的子目录，并把要调用的可执行程序拷贝到那里。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　24.有没有办法用代码控制DataGrid的上下、左右的滚动？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　dataGrid1.Select();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　SendKeys.Send(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"{PGUP}"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　SendKeys.Send(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"{PGDN}"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　SendKeys.Send(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"{^{LEFT}"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;);&amp;nbsp;&lt;/span&gt;&lt;span class="comment"&gt;&lt;span style="color: #008200;"&gt;//&amp;nbsp;Ctrl+左方向键&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　SendKeys.Send(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"{^{RIGHT}"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;);&amp;nbsp;&lt;/span&gt;&lt;span class="comment"&gt;&lt;span style="color: #008200;"&gt;//&amp;nbsp;Ctrl+右方向键&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　25.怎样使两个DataGrid绑定两个主从关系的表？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　DataGrid1.DataSource&amp;nbsp;=&amp;nbsp;ds;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　DataGrid1.DataMember&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"母表"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　...&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　DataGrid2.DataSouce&amp;nbsp;=&amp;nbsp;ds;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　DataGrid2.DataMember&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"母表.关系名"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　26.assembly的版本号怎样才能自动生成？特别是在Console下没有通过VStudio环境编写程序时。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　关键是AssemblyInfo.cs里的[assembly:&amp;nbsp;AssemblyVersion(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"1.0.*"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;)]，命令行编译时包含AssemblyInfo.cs&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　27.怎样建立一个Shared&amp;nbsp;Assembly？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　用sn.exe生成一个Strong&amp;nbsp;Name：keyfile.sn，放在源程序目录下&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　在项目的AssemblyInfo.cs里[assembly:&amp;nbsp;AssemblyKeyFile(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"..\\..\\keyfile.sn"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;)]&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　生成dll后，用gacutil&amp;nbsp;/i&amp;nbsp;myDll.dll放进Global&amp;nbsp;Assembly&amp;nbsp;Cach.&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　28.在Oracle里如何取得某字段第一个字母为大写英文A~Z之间的记录？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　select&amp;nbsp;*&amp;nbsp;from&amp;nbsp;table&amp;nbsp;where&amp;nbsp;ascii(substr(字段,1,1))&amp;nbsp;between&amp;nbsp;ascii(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;'A'&lt;/span&gt;&lt;/span&gt;&lt;span&gt;)&amp;nbsp;and&amp;nbsp;ascii(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;'Z'&lt;/span&gt;&lt;/span&gt;&lt;span&gt;)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　29.怎样取得当前Assembly的版本号？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　Process&amp;nbsp;current&amp;nbsp;=&amp;nbsp;Process.GetCurrentProcess();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　FileVersionInfo&amp;nbsp;myFileVersionInfo&amp;nbsp;=&amp;nbsp;FileVersionInfo.GetVersionInfo(current.MainModule.FileName);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　Console.WriteLine(myFileVersionInfo.FileVersion);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　30.怎样制作一个简单的winform安装程序？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　①&amp;nbsp;建一个WinForm应用程序，最最简单的那种。运行。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　②&amp;nbsp;添加新项目-&amp;gt;安装和部署项目，&amp;lsquo;模板&amp;rsquo;选择&amp;lsquo;安装向导&amp;rsquo;。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　③&amp;nbsp;连续二个&amp;lsquo;下一步&amp;rsquo;，在&amp;lsquo;选择包括的项目输出&amp;rsquo;步骤打勾&amp;lsquo;主输出来自&amp;rsquo;，连续两个&amp;lsquo;下一步&amp;rsquo;，&amp;lsquo;完成&amp;rsquo;。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　④&amp;nbsp;生成。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　⑤&amp;nbsp;到项目目录下找到Setup.exe（还有一个.msi和.ini文件），执行。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　31.怎样通过winform安装程序在Sql&amp;nbsp;Server数据库上建表？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　①&amp;nbsp;[项目]&amp;mdash;[添加新项]&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　类别：代码；模板：安装程序类。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　名称：MyInstaller.cs&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　②&amp;nbsp;在SQL&amp;nbsp;Server建立一个表，再[所有任务]&amp;mdash;[生成SQL脚本]。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　生成类似如下脚本（注意：把所有GO语句去掉）：&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;exists&amp;nbsp;(select&amp;nbsp;*&amp;nbsp;from&amp;nbsp;dbo.sysobjects&amp;nbsp;where&amp;nbsp;id&amp;nbsp;=&amp;nbsp;object_id(N&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;'[dbo].[MyTable]'&lt;/span&gt;&lt;/span&gt;&lt;span&gt;)&amp;nbsp;and&amp;nbsp;OBJECTPROPERTY(id,&amp;nbsp;N&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;'IsUserTable'&lt;/span&gt;&lt;/span&gt;&lt;span&gt;)&amp;nbsp;=&amp;nbsp;1)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　drop&amp;nbsp;table&amp;nbsp;[dbo].[MyTable]&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　CREATE&amp;nbsp;TABLE&amp;nbsp;[dbo].[MyTable]&amp;nbsp;(&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　[ID]&amp;nbsp;[&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;]&amp;nbsp;NOT&amp;nbsp;NULL&amp;nbsp;,&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　[NAME]&amp;nbsp;[nchar]&amp;nbsp;(4)&amp;nbsp;COLLATE&amp;nbsp;Chinese_PRC_CI_AS&amp;nbsp;NOT&amp;nbsp;NULL&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　)&amp;nbsp;ON&amp;nbsp;[PRIMARY]&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　ALTER&amp;nbsp;TABLE&amp;nbsp;[dbo].[MyTable]&amp;nbsp;WITH&amp;nbsp;NOCHECK&amp;nbsp;ADD&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　CONSTRAINT&amp;nbsp;[PK_MyTable]&amp;nbsp;PRIMARY&amp;nbsp;KEY&amp;nbsp;CLUSTERED&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　(&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　[ID]&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　)&amp;nbsp;ON&amp;nbsp;[PRIMARY]&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　③&amp;nbsp;[项目]&amp;mdash;[添加现有项]。mytable.sql&amp;mdash;[生成操作]-[嵌入的资源]。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　④&amp;nbsp;将MyInstaller.cs切换到代码视图,添加下列代码：&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　先增加：&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;System.Reflection;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;System.IO;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　然后：&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;string&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;GetSql(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;string&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;Name)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;try&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　　Assembly&amp;nbsp;Asm&amp;nbsp;=&amp;nbsp;Assembly.GetExecutingAssembly();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　　Stream&amp;nbsp;strm&amp;nbsp;=&amp;nbsp;Asm.GetManifestResourceStream(Asm.GetName().Name&amp;nbsp;+&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"."&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;+&amp;nbsp;Name);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　　StreamReader&amp;nbsp;reader&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;StreamReader(strm);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;return&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;reader.ReadToEnd();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;catch&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;(Exception&amp;nbsp;ex)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　　Console.Write(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"In&amp;nbsp;GetSql:"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;+ex.Message);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;throw&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;ex;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;ExecuteSql(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;string&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;DataBaseName,&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;string&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;Sql)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　System.Data.SqlClient.SqlConnection&amp;nbsp;sqlConn&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;System.Data.SqlClient.SqlConnection();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　sqlConn.ConnectionString&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"server=myserver;&amp;nbsp;uid=sa;&amp;nbsp;password=;&amp;nbsp;database=master"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　System.Data.SqlClient.SqlCommand&amp;nbsp;Command&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;System.Data.SqlClient.SqlCommand(Sql,sqlConn);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　Command.Connection.Open();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　Command.Connection.ChangeDatabase(DataBaseName);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;try&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　Command.ExecuteNonQuery();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;finally&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　Command.Connection.Close();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;protected&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;AddDBTable(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;string&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;strDBName)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;try&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　ExecuteSql(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"master"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"create&amp;nbsp;DATABASE&amp;nbsp;"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;+&amp;nbsp;strDBName);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　ExecuteSql(strDBName,GetSql(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"mytable.sql"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;));&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;catch&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;(Exception&amp;nbsp;ex)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　Console.Write(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"In&amp;nbsp;exception&amp;nbsp;handler&amp;nbsp;:"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;+ex.Message);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;override&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;Install(System.Collections.IDictionary&amp;nbsp;stateSaver)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;base&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;.Install(stateSaver);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　AddDBTable(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"MyDB"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;);&amp;nbsp;&lt;/span&gt;&lt;span class="comment"&gt;&lt;span style="color: #008200;"&gt;//建一个名为MyDB的DataBase&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　⑤&amp;nbsp;[添加新项目]&amp;mdash;[项目类型：安装和部署项目]&amp;mdash;[模板：安装项目]&amp;mdash;[名称：MySetup]。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　⑥&amp;nbsp;[应用程序文件夹]&amp;mdash;[添加]&amp;mdash;[项目输出]&amp;mdash;[主输出]。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　⑦&amp;nbsp;解决方案资源管理器&amp;mdash;右键&amp;mdash;[安装项目(MySetup)]&amp;mdash;[视图]&amp;mdash;[自定义操作]。[安装]&amp;mdash;[添加自定义操作]&amp;mdash;[双击：应用程序文件夹]的[主输出来自***(活动)]。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　32.怎样用TreeView显示父子关系的数据库表（winform）？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　三个表a1,a2,a3,&amp;nbsp;a1为a2看母表,a2为a3的母表。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　a1:&amp;nbsp;id,&amp;nbsp;name&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　a2:&amp;nbsp;id,&amp;nbsp;parent_id,&amp;nbsp;name&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　a3:&amp;nbsp;id,&amp;nbsp;parent_id,&amp;nbsp;name&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　用三个DataAdapter把三个表各自Fill进DataSet的三个表。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　用DataRelation设置好三个表之间的关系。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;foreach&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;(DataRow&amp;nbsp;drA1&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;in&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;ds.Tables[&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"a1"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;].Rows)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　tn1&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;TreeNode(drA1[&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"name"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;].ToString());&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　treeView1.Nodes.Add(tn1);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;foreach&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;(DataRow&amp;nbsp;drA2&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;in&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;drA1.GetChildRows(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"a1a2"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;))&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　tn2&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;TreeNode(drA2[&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"name"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;].ToString());&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　tn1.Nodes.Add(tn2);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;foreach&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;(DataRow&amp;nbsp;drA3&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;in&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;drA2.GetChildRows(&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"a2a3"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;))&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　tn3&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;TreeNode(drA3[&lt;/span&gt;&lt;span class="string"&gt;&lt;span style="color: #ff0000;"&gt;"name"&lt;/span&gt;&lt;/span&gt;&lt;span&gt;].ToString());&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　tn2.Nodes.Add(tn3);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　33.怎样从一个form传递数据到另一个form？&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　假设Form2的数据要传到Form1的TextBox。&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　在Form2：&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="comment"&gt;&lt;span style="color: #008200;"&gt;//&amp;nbsp;Define&amp;nbsp;delegate&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;delegate&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;SendData(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;sender);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="comment"&gt;&lt;span style="color: #008200;"&gt;//&amp;nbsp;Create&amp;nbsp;instance&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;SendData&amp;nbsp;sendData;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　在Form2的按钮单击事件或其它事件代码中：&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;(sendData&amp;nbsp;!=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;null&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　　sendData(txtBoxAtForm2);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;.Close();&amp;nbsp;&lt;/span&gt;&lt;span class="comment"&gt;&lt;span style="color: #008200;"&gt;//关闭Form2&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　在Form1的弹出Form2的代码中：&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　Form2&amp;nbsp;form2&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;Form2();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　form2.sendData&amp;nbsp;=&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;Form2.SendData(MyFunction);&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　form2.ShowDialog();&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　====================&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;MyFunction(&lt;/span&gt;&lt;span class="keyword"&gt;&lt;strong&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;sender)&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　{&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　textBox1.Text&amp;nbsp;=&amp;nbsp;((TextBox)sender).Text;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li class="alt"&gt;&lt;span&gt;　　}&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;img src="http://counter.cnblogs.com/blog/rss/2980644" width="1" height="1" alt=""/&gt;&lt;br/&gt;&lt;p&gt;本文链接：&lt;a href="http://www.cnblogs.com/moss_tan_jun/archive/2013/03/25/2980644.html" target="_blank"&gt;http://www.cnblogs.com/moss_tan_jun/archive/2013/03/25/2980644.html&lt;/a&gt;，转载请注明。&lt;/p&gt;</content></entry><entry><id>http://www.cnblogs.com/moss_tan_jun/archive/2013/03/25/2980271.html</id><title type="text">C# Regex类用法 - moss_tan_jun</title><summary type="text">使用Regex类需要引用命名空间：using System.Text.RegularExpressions;利用Regex类实现验证示例1：注释的代码所起的作用是相同的，不过一个是静态方法，一个是实例方法var source = "刘备关羽张飞孙权";//Regex regex = new Regex("孙权");//if (regex.IsMatch(source))//{// Console.WriteLine("字符串中包含有敏感词:孙权！");//}if (Regex.IsMatch(source, "孙权&amp;quot</summary><published>2013-03-25T02:33:00Z</published><updated>2013-03-25T02:33:00Z</updated><author><name>moss_tan_jun</name><uri>http://www.cnblogs.com/moss_tan_jun/</uri></author><link rel="alternate" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/03/25/2980271.html" /><link rel="alternate" type="text/html" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/03/25/2980271.html" /><content type="html">&lt;p&gt;使用Regex类需要引用命名空间：using System.Text.RegularExpressions;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;利用Regex类实现验证&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;示例1：注释的代码所起的作用是相同的，不过一个是静态方法，一个是实例方法&lt;/p&gt;&lt;p&gt;var source = "刘备关羽张飞孙权";&lt;br /&gt;//Regex regex = new Regex("孙权");&lt;br /&gt;//if (regex.IsMatch(source))&lt;br /&gt;//{&lt;br /&gt;// Console.WriteLine("字符串中包含有敏感词:孙权！");&lt;br /&gt;//}&lt;br /&gt;if (Regex.IsMatch(source, "孙权")) &lt;br /&gt;{&lt;br /&gt;　　Console.WriteLine("字符串中包含有敏感词:孙权！");&lt;br /&gt;}&lt;br /&gt;Console.ReadLine();&lt;/p&gt;&lt;p&gt;示例2：使用带两个参数的构造函数,第二个参数指示忽略大小写，很常用&lt;/p&gt;&lt;p&gt;var source = "123abc345DEf";&lt;br /&gt;Regex regex = new Regex("def",RegexOptions.IgnoreCase);&lt;br /&gt;if (regex.IsMatch(source))&lt;br /&gt;{&lt;br /&gt;　　Console.WriteLine("字符串中包含有敏感词:def！");&lt;br /&gt;} &lt;br /&gt;Console.ReadLine();&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;使用Regex类进行替换&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;示例1：简单情况&lt;/p&gt;&lt;p&gt;var source = "123abc456ABC789";&lt;br /&gt;// 静态方法&lt;br /&gt;//var newSource=&lt;span style="background-color: #ffcc00;"&gt;Regex.Replace(source,"abc","|",RegexOptions.IgnoreCase);&lt;/span&gt;&lt;br /&gt;// 实例方法&lt;br /&gt;Regex regex = new Regex("abc", RegexOptions.IgnoreCase);&lt;br /&gt;var newSource = &lt;span style="background-color: #ffcc00;"&gt;regex.Replace(source, "|");&lt;/span&gt;&lt;br /&gt;Console.WriteLine("原字符串："+source);&lt;br /&gt;Console.WriteLine("替换后的字符串：" + newSource);&lt;br /&gt;Console.ReadLine();&lt;/p&gt;&lt;p&gt;结果：&lt;/p&gt;&lt;p&gt;原字符串：123abc456ABC789&lt;/p&gt;&lt;p&gt;替换后的字符串：123|456|789&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;示例2：将匹配到的选项替换为html代码，我们使用了MatchEvaluator委托&lt;/p&gt;&lt;p&gt;var source = "123abc456ABCD789"; &lt;br /&gt;Regex regex = new Regex("[A-Z]{3}", RegexOptions.IgnoreCase);&lt;br /&gt;var newSource = &lt;span style="background-color: #ffcc00;"&gt;regex.Replace(source,new MatchEvaluator(OutPutMatch));&lt;/span&gt;&lt;br /&gt;Console.WriteLine("原字符串："+source);&lt;br /&gt;Console.WriteLine("替换后的字符串：" + newSource);&lt;br /&gt;Console.ReadLine();&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;private static string OutPutMatch(Match match)&lt;br /&gt;{&lt;br /&gt;　　return "&amp;lt;b&amp;gt;" +match.Value+ "&amp;lt;/b&amp;gt;";&lt;br /&gt;}&lt;/p&gt;&lt;p&gt;输出：&lt;/p&gt;&lt;p&gt;原字符串：123abc456ABCD789&lt;/p&gt;&lt;p&gt;替换后的字符串：123&amp;lt;b&amp;gt;abc&amp;lt;/b&amp;gt;456&amp;lt;b&amp;gt;ABC&amp;lt;/b&amp;gt;D789&lt;/p&gt;&lt;img src="http://counter.cnblogs.com/blog/rss/2980271" width="1" height="1" alt=""/&gt;&lt;br/&gt;&lt;p&gt;本文链接：&lt;a href="http://www.cnblogs.com/moss_tan_jun/archive/2013/03/25/2980271.html" target="_blank"&gt;http://www.cnblogs.com/moss_tan_jun/archive/2013/03/25/2980271.html&lt;/a&gt;，转载请注明。&lt;/p&gt;</content></entry><entry><id>http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850690.html</id><title type="text">winform 分页控件 - moss_tan_jun</title><summary type="text">程序很简单，用的时候需要提供pageCount（页数），pageShow(显示的页数），currPage（当前页号）控件提供一个自定义的事件LnkLblClicked，当用户点击页面链接的时候就会触发这个事件。下面是程序的源码。usingSystem;usingSystem.Collections;usingSystem.ComponentModel;usingSystem.Drawing;usingSystem.Data;usingSystem.Windows.Forms;namespaceActiveButton{/**////&lt;summary&gt;///Summarydescri</summary><published>2013-01-08T02:53:00Z</published><updated>2013-01-08T02:53:00Z</updated><author><name>moss_tan_jun</name><uri>http://www.cnblogs.com/moss_tan_jun/</uri></author><link rel="alternate" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850690.html" /><link rel="alternate" type="text/html" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850690.html" /><content type="html">&lt;p&gt;程序很简单，用的时候需要提供pageCount（页数），pageShow(显示的页数），currPage（当前页号）&lt;br /&gt;控件提供一个自定义的事件LnkLblClicked，当用户点击页面链接的时候就会触发这个事件。下面是程序的源码。&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;div style="padding-bottom: 4px; padding-left: 5.4pt; width: 98%; padding-right: 5.4pt; background: #e6e6e6; padding-top: 4px; border: windowtext 0.5pt solid;"&gt;&lt;div&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Collections;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.ComponentModel;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Drawing;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Data;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Windows.Forms;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;namespace&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;ActiveButton&lt;br /&gt;&lt;img id="Codehighlighter1_162_6061_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_162_6061_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_162_6061_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_162_6061_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img id="Codehighlighter1_165_236_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_165_236_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_165_236_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;/**/&lt;/span&gt;&lt;span id="Codehighlighter1_165_236_Open_Text"&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;Summary&amp;nbsp;description&amp;nbsp;for&amp;nbsp;PageControl.&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;class&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;PageControl&amp;nbsp;:&amp;nbsp;System.Windows.Forms.UserControl&lt;br /&gt;&lt;img id="Codehighlighter1_299_6059_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_299_6059_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_299_6059_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_299_6059_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img id="Codehighlighter1_303_368_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_303_368_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_303_368_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;/**/&lt;/span&gt;&lt;span id="Codehighlighter1_303_368_Open_Text"&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;Required&amp;nbsp;designer&amp;nbsp;variable.&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageCount;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;currPage;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;private&amp;nbsp;int&amp;nbsp;pageSize;&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageShow;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;xDistance;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;bool&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;bolPrev;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;bool&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;bolNext;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;start,&amp;nbsp;end;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;EventHandler&amp;nbsp;lnkLblClicked;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;event&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;EventHandler&amp;nbsp;LnkLblClicked&lt;br /&gt;&lt;img id="Codehighlighter1_651_722_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_651_722_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_651_722_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_651_722_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img id="Codehighlighter1_659_683_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_659_683_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;add&lt;/span&gt;&lt;span id="Codehighlighter1_659_683_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_659_683_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{lnkLblClicked&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;value;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_694_718_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_694_718_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;remove&lt;/span&gt;&lt;span id="Codehighlighter1_694_718_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_694_718_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{lnkLblClicked&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;-=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;value;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;protected&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;virtual&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;OnLnkLblClicked(EventArgs&amp;nbsp;e)&lt;br /&gt;&lt;img id="Codehighlighter1_780_857_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_780_857_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_780_857_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_780_857_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(lnkLblClicked&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;!=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;null&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;lnkLblClicked(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;,e);&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_862_1310_Closed_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_862_1310_Open_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_862_1310_Closed_Text" style="background-color: #ffffff; border: #808080 1px solid;"&gt;Field&lt;/span&gt;&lt;span id="Codehighlighter1_862_1310_Open_Text" style="display: none;"&gt;&lt;span style="color: #0000ff;"&gt;#region&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Field&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;PageCount&lt;br /&gt;&lt;img id="Codehighlighter1_901_960_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_901_960_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_901_960_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_901_960_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img id="Codehighlighter1_909_927_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_909_927_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;get&lt;/span&gt;&lt;span id="Codehighlighter1_909_927_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_909_927_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;return&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageCount;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_935_954_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_935_954_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;set&lt;/span&gt;&lt;span id="Codehighlighter1_935_954_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_935_954_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{pageCount&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;value;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;CurrPage&lt;br /&gt;&lt;img id="Codehighlighter1_986_1041_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_986_1041_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_986_1041_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_986_1041_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img id="Codehighlighter1_994_1011_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_994_1011_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;get&lt;/span&gt;&lt;span id="Codehighlighter1_994_1011_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_994_1011_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;return&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;currPage;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_1019_1037_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1019_1037_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;set&lt;/span&gt;&lt;span id="Codehighlighter1_1019_1037_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1019_1037_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{currPage&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;value;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public&amp;nbsp;int&amp;nbsp;PageSize&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;get{return&amp;nbsp;pageSize;}&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;set{pageSize&amp;nbsp;=&amp;nbsp;value;}&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;PageShow&lt;br /&gt;&lt;img id="Codehighlighter1_1158_1213_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1158_1213_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_1158_1213_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1158_1213_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img id="Codehighlighter1_1166_1183_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1166_1183_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;get&lt;/span&gt;&lt;span id="Codehighlighter1_1166_1183_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1166_1183_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;return&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageShow;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_1191_1209_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1191_1209_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;set&lt;/span&gt;&lt;span id="Codehighlighter1_1191_1209_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1191_1209_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{pageShow&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;value;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;XDistance&lt;br /&gt;&lt;img id="Codehighlighter1_1240_1297_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1240_1297_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_1240_1297_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1240_1297_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img id="Codehighlighter1_1248_1266_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1248_1266_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;get&lt;/span&gt;&lt;span id="Codehighlighter1_1248_1266_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1248_1266_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;return&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;xDistance;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_1274_1293_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1274_1293_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;set&lt;/span&gt;&lt;span id="Codehighlighter1_1274_1293_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1274_1293_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{xDistance&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;value;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;#endregion&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.ComponentModel.Container&amp;nbsp;components&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;null&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;PageControl()&lt;br /&gt;&lt;img id="Codehighlighter1_1403_1569_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1403_1569_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_1403_1569_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1403_1569_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;This&amp;nbsp;call&amp;nbsp;is&amp;nbsp;required&amp;nbsp;by&amp;nbsp;the&amp;nbsp;Windows.Forms&amp;nbsp;Form&amp;nbsp;Designer.&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;InitializeComponent();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;TODO:&amp;nbsp;Add&amp;nbsp;any&amp;nbsp;initialization&amp;nbsp;after&amp;nbsp;the&amp;nbsp;InitializeComponent&amp;nbsp;call&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;PageControl(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageCount,&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageSize,&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageShow):&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;()&lt;br /&gt;&lt;img id="Codehighlighter1_1642_1746_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1642_1746_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_1642_1746_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1642_1746_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.pageCount&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageCount;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;this.pageSize&amp;nbsp;=&amp;nbsp;pageSize;&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.pageShow&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageShow;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_1751_1823_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1751_1823_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_1751_1823_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;/**/&lt;/span&gt;&lt;span id="Codehighlighter1_1751_1823_Open_Text"&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;Clean&amp;nbsp;up&amp;nbsp;any&amp;nbsp;resources&amp;nbsp;being&amp;nbsp;used.&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;protected&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;override&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Dispose(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;bool&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;disposing&amp;nbsp;)&lt;br /&gt;&lt;img id="Codehighlighter1_1878_2007_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1878_2007_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_1878_2007_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1878_2007_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;(&amp;nbsp;disposing&amp;nbsp;)&lt;br /&gt;&lt;img id="Codehighlighter1_1902_1973_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1902_1973_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_1902_1973_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1902_1973_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;(components&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;!=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;null&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&lt;img id="Codehighlighter1_1935_1968_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1935_1968_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_1935_1968_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1935_1968_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;components.Dispose();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;base&lt;/span&gt;&lt;span style="color: #000000;"&gt;.Dispose(&amp;nbsp;disposing&amp;nbsp;);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_2012_2490_Closed_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_2012_2490_Open_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_2012_2490_Closed_Text" style="background-color: #ffffff; border: #808080 1px solid;"&gt;Component&amp;nbsp;Designer&amp;nbsp;generated&amp;nbsp;code&lt;/span&gt;&lt;span id="Codehighlighter1_2012_2490_Open_Text" style="display: none;"&gt;&lt;span style="color: #0000ff;"&gt;#region&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Component&amp;nbsp;Designer&amp;nbsp;generated&amp;nbsp;code&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_2056_2203_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_2056_2203_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_2056_2203_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;/**/&lt;/span&gt;&lt;span id="Codehighlighter1_2056_2203_Open_Text"&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;Required&amp;nbsp;method&amp;nbsp;for&amp;nbsp;Designer&amp;nbsp;support&amp;nbsp;-&amp;nbsp;do&amp;nbsp;not&amp;nbsp;modify&amp;nbsp;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;the&amp;nbsp;contents&amp;nbsp;of&amp;nbsp;this&amp;nbsp;method&amp;nbsp;with&amp;nbsp;the&amp;nbsp;code&amp;nbsp;editor.&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;///&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #808080;"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;InitializeComponent()&lt;br /&gt;&lt;img id="Codehighlighter1_2243_2477_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_2243_2477_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_2243_2477_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_2243_2477_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.SuspendLayout();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;PageControl&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.Name&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;PageControl&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.Size&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Drawing.Size(&lt;/span&gt;&lt;span style="color: #000000;"&gt;320&lt;/span&gt;&lt;span style="color: #000000;"&gt;,&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;24&lt;/span&gt;&lt;span style="color: #000000;"&gt;);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.Load&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.EventHandler(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.PageControl_Load);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.ResumeLayout(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;false&lt;/span&gt;&lt;span style="color: #000000;"&gt;);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;#endregion&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;PageControl_Load(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;sender,&amp;nbsp;System.EventArgs&amp;nbsp;e)&lt;br /&gt;&lt;img id="Codehighlighter1_2562_2727_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_2562_2727_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_2562_2727_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_2562_2727_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;xDistance&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;0&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;bolPrev&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageCount&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageShow;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;currPage&amp;nbsp;=&amp;nbsp;pageCount;&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageCount;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;start&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Math.Max(&lt;/span&gt;&lt;span style="color: #000000;"&gt;1&lt;/span&gt;&lt;span style="color: #000000;"&gt;,end&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;-&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageShow&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;1&lt;/span&gt;&lt;span style="color: #000000;"&gt;);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;DrawControl();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;DrawControl()&lt;br /&gt;&lt;img id="Codehighlighter1_2760_4669_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_2760_4669_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_2760_4669_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_2760_4669_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.Controls.Clear();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.Windows.Forms.Label&amp;nbsp;lblPageCount&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Label();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;lblPageCount.Text&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;共&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageCount&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;页&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.AddControl(lblPageCount,&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Point(&lt;/span&gt;&lt;span style="color: #000000;"&gt;8&lt;/span&gt;&lt;span style="color: #000000;"&gt;,&lt;/span&gt;&lt;span style="color: #000000;"&gt;8&lt;/span&gt;&lt;span style="color: #000000;"&gt;),&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Size(&lt;/span&gt;&lt;span style="color: #000000;"&gt;40&lt;/span&gt;&lt;span style="color: #000000;"&gt;,&lt;/span&gt;&lt;span style="color: #000000;"&gt;16&lt;/span&gt;&lt;span style="color: #000000;"&gt;));&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;x&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;lblPageCount.Bounds.Right;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;y&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;lblPageCount.Location.Y;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.Windows.Forms.Control&amp;nbsp;currCtl&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;lblPageCount;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;calculate&amp;nbsp;page&amp;nbsp;start&amp;nbsp;and&amp;nbsp;end&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageShowCount&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Math.Min(pageCount,pageShow);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;start&amp;nbsp;=&amp;nbsp;Math.Max(1,currPage&amp;nbsp;-&amp;nbsp;pageShow/2);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end&amp;nbsp;=&amp;nbsp;start&amp;nbsp;+&amp;nbsp;pageShowCount&amp;nbsp;-1;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;(pageCount&amp;nbsp;-&amp;nbsp;currPage&amp;nbsp;&amp;lt;&amp;nbsp;pageShow/2)&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end&amp;nbsp;=&amp;nbsp;pageCount;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;start&amp;nbsp;=&amp;nbsp;pageCount&amp;nbsp;-&amp;nbsp;pageShowCount&amp;nbsp;+&amp;nbsp;1;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;bolPrev&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;start&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;!=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;1&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;bolNext&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;end&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;!=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageCount;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(bolPrev)&lt;br /&gt;&lt;img id="Codehighlighter1_3480_3794_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_3480_3794_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_3480_3794_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_3480_3794_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;add&amp;nbsp;Linklabel&amp;nbsp;"prev"&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.Windows.Forms.LinkLabel&amp;nbsp;lblPrev&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;LinkLabel();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;lblPrev.Text&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;前一页&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;x&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;xDistance;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;((LinkLabel)lblPrev).LinkClicked&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;LinkLabelLinkClickedEventHandler(lblCtl_Clicked);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.AddControl(lblPrev,&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Point(x,y),&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Size(&lt;/span&gt;&lt;span style="color: #000000;"&gt;45&lt;/span&gt;&lt;span style="color: #000000;"&gt;,&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;16&lt;/span&gt;&lt;span style="color: #000000;"&gt;));&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;currCtl&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;lblPrev;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;for&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;i&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;start;&amp;nbsp;i&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;lt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;end;&amp;nbsp;i&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;++&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&lt;img id="Codehighlighter1_3842_4322_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_3842_4322_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_3842_4322_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_3842_4322_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;add&amp;nbsp;linklabel&amp;nbsp;"page"&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;x&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;currCtl.Bounds.Right;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.Windows.Forms.Control&amp;nbsp;lblCtl&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;null&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(&amp;nbsp;i&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;currPage)&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;lblCtl&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Windows.Forms.Label();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;else&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_4030_4182_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_4030_4182_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_4030_4182_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_4030_4182_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;lblCtl&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Windows.Forms.LinkLabel();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;((LinkLabel)lblCtl).LinkClicked&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;LinkLabelLinkClickedEventHandler(lblCtl_Clicked);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;lblCtl.Text&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;i.ToString();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;x&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;xDistance;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.AddControl(lblCtl,&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Point(x,y),&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Size(&lt;/span&gt;&lt;span style="color: #000000;"&gt;10&lt;/span&gt;&lt;span style="color: #000000;"&gt;,&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;16&lt;/span&gt;&lt;span style="color: #000000;"&gt;));&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;currCtl&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;lblCtl;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(bolNext)&lt;br /&gt;&lt;img id="Codehighlighter1_4343_4665_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_4343_4665_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_4343_4665_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_4343_4665_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;add&amp;nbsp;linklabel&amp;nbsp;"next"&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.Windows.Forms.LinkLabel&amp;nbsp;lblNext&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;LinkLabel();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;lblNext.Text&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;后一页&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;x&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;currCtl.Bounds.Right;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;x&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;xDistance;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;((LinkLabel)lblNext).LinkClicked&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;LinkLabelLinkClickedEventHandler(lblCtl_Clicked);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.AddControl(lblNext,&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Point(x,y),&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Size(&lt;/span&gt;&lt;span style="color: #000000;"&gt;45&lt;/span&gt;&lt;span style="color: #000000;"&gt;,&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;16&lt;/span&gt;&lt;span style="color: #000000;"&gt;));&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;AddControl(Control&amp;nbsp;ctlObj,Point&amp;nbsp;point,Size&amp;nbsp;size)&lt;br /&gt;&lt;img id="Codehighlighter1_4737_5181_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_4737_5181_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_4737_5181_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_4737_5181_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ctlObj.Anchor&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;|&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Windows.Forms.AnchorStyles.Bottom)&amp;nbsp;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;|&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Windows.Forms.AnchorStyles.Left)));&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ctlObj.Location&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;point;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;x&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;ctlObj.Text.Length&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;*&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;10&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(ctlObj.Text.IndexOf(&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;页&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;0&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;)&lt;br /&gt;&lt;img id="Codehighlighter1_5034_5114_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_5034_5114_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_5034_5114_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_5034_5114_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(ctlObj.Text.IndexOf(&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;共&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;0&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;x&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;10&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;else&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;x&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;*=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;2&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ctlObj.Size&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Size(x,&lt;/span&gt;&lt;span style="color: #000000;"&gt;16&lt;/span&gt;&lt;span style="color: #000000;"&gt;);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.Controls.Add(ctlObj);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;lblCtl_Clicked(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;sender,&amp;nbsp;System.Windows.Forms.LinkLabelLinkClickedEventArgs&amp;nbsp;e)&lt;br /&gt;&lt;img id="Codehighlighter1_5285_5845_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_5285_5845_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_5285_5845_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_5285_5845_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(sender&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;is&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;LinkLabel)&lt;br /&gt;&lt;img id="Codehighlighter1_5318_5841_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_5318_5841_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_5318_5841_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_5318_5841_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;try&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_5332_5824_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_5332_5824_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_5332_5824_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_5332_5824_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;string&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;lblText&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;((LinkLabel)sender).Text;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(lblText&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;前一页&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&lt;img id="Codehighlighter1_5414_5511_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_5414_5511_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_5414_5511_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_5414_5511_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;start&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;-&lt;/span&gt;&lt;span style="color: #000000;"&gt;1&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;start&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Math.Max(&lt;/span&gt;&lt;span style="color: #000000;"&gt;1&lt;/span&gt;&lt;span style="color: #000000;"&gt;,end&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;-&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageShow&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;1&lt;/span&gt;&lt;span style="color: #000000;"&gt;);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;currPage&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;end;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;else&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(lblText&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;后一页&lt;/span&gt;&lt;span style="color: #000000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&lt;img id="Codehighlighter1_5550_5673_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_5550_5673_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_5550_5673_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_5550_5673_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;start&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;end&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;1&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Math.Min(pageCount,start&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageShow&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;-&lt;/span&gt;&lt;span style="color: #000000;"&gt;1&lt;/span&gt;&lt;span style="color: #000000;"&gt;);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;currPage&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;end;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;else&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_5690_5763_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_5690_5763_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_5690_5763_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_5690_5763_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;int&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;page&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Convert.ToInt32(lblText);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;currPage&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;page;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.DrawControl();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.OnLnkLblClicked(e);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_5835_5836_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_5835_5836_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;catch&lt;/span&gt;&lt;span id="Codehighlighter1_5835_5836_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_5835_5836_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;ReDraw()&lt;br /&gt;&lt;img id="Codehighlighter1_5873_6056_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_5873_6056_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_5873_6056_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_5873_6056_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;bolPrev&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageCount&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageShow;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;currPage&amp;nbsp;=&amp;nbsp;pageCount;&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;end&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageCount;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;start&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Math.Max(&lt;/span&gt;&lt;span style="color: #000000;"&gt;1&lt;/span&gt;&lt;span style="color: #000000;"&gt;,end&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;-&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;pageShow&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;1&lt;/span&gt;&lt;span style="color: #000000;"&gt;);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.DrawControl();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;.OnLnkLblClicked(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;null&lt;/span&gt;&lt;span style="color: #000000;"&gt;);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" alt="" align="top" /&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;img src="http://counter.cnblogs.com/blog/rss/2850690" width="1" height="1" alt=""/&gt;&lt;br/&gt;&lt;p&gt;本文链接：&lt;a href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850690.html" target="_blank"&gt;http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850690.html&lt;/a&gt;，转载请注明。&lt;/p&gt;</content></entry><entry><id>http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850685.html</id><title type="text">Windows Forms DataGridView 中合并单元格 - moss_tan_jun</title><summary type="text">Windows Forms DataGridView 没有提供合并单元格的功能，要实现合并单元格的功能就要在CellPainting事件中使用Graphics.DrawLine和 Graphics.DrawString 自己来“画”。下面的代码可以对DataGridView第1列内容相同的单元格进行合并： private void dataGridView1_CellPainting(object sender, DataGridViewCellPaintingEventArgs e) { // 对第1列相同单元格进行合并 if (e.ColumnIndex == 0 &amp;&amp; e</summary><published>2013-01-08T02:49:00Z</published><updated>2013-01-08T02:49:00Z</updated><author><name>moss_tan_jun</name><uri>http://www.cnblogs.com/moss_tan_jun/</uri></author><link rel="alternate" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850685.html" /><link rel="alternate" type="text/html" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850685.html" /><content type="html">&lt;p&gt;Windows Forms DataGridView 没有提供合并单元格的功能，要实现合并单元格的功能就要在CellPainting事件中使用Graphics.DrawLine和 Graphics.DrawString 自己来&amp;ldquo;画&amp;rdquo;。&lt;/p&gt;&lt;p&gt;下面的代码可以对DataGridView第1列内容相同的单元格进行合并：&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; private void dataGridView1_CellPainting(object sender, DataGridViewCellPaintingEventArgs e)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // 对第1列相同单元格进行合并&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (e.ColumnIndex == 0 &amp;amp;&amp;amp; e.RowIndex != -1)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; (&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Brush gridBrush = new SolidBrush(this.dataGridView1.GridColor),&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; backColorBrush = new SolidBrush(e.CellStyle.BackColor)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; )&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; using (Pen gridLinePen = new Pen(gridBrush))&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // 清除单元格&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; e.Graphics.FillRectangle(backColorBrush, e.CellBounds);&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // 画 Grid 边线（仅画单元格的底边线和右边线）&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //&amp;nbsp;&amp;nbsp; 如果下一行和当前行的数据不同，则在当前的单元格画一条底边线&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (e.RowIndex &amp;lt; dataGridView1.Rows.Count - 1 &amp;amp;&amp;amp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; dataGridView1.Rows[e.RowIndex + 1].Cells[e.ColumnIndex].Value.ToString() != &lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; e.Value.ToString())&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; e.Graphics.DrawLine(gridLinePen, e.CellBounds.Left,&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; e.CellBounds.Bottom - 1, e.CellBounds.Right - 1,&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; e.CellBounds.Bottom - 1);&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // 画右边线&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; e.Graphics.DrawLine(gridLinePen, e.CellBounds.Right - 1,&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; e.CellBounds.Top, e.CellBounds.Right - 1,&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; e.CellBounds.Bottom);&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; // 画（填写）单元格内容，相同的内容的单元格只填写第一个&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (e.Value != null)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (e.RowIndex &amp;gt; 0 &amp;amp;&amp;amp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; dataGridView1.Rows[e.RowIndex - 1].Cells[e.ColumnIndex].Value.ToString() == &lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; e.Value.ToString())&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; { }&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; else&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; e.Graphics.DrawString((String)e.Value, e.CellStyle.Font,&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Brushes.Black, e.CellBounds.X + 2,&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; e.CellBounds.Y + 5, StringFormat.GenericDefault);&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; e.Handled = true;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;/p&gt;&lt;img src="http://counter.cnblogs.com/blog/rss/2850685" width="1" height="1" alt=""/&gt;&lt;br/&gt;&lt;p&gt;本文链接：&lt;a href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850685.html" target="_blank"&gt;http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850685.html&lt;/a&gt;，转载请注明。&lt;/p&gt;</content></entry><entry><id>http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850672.html</id><title type="text">c#+winform技巧三，c#,winform,show,showdialog,子窗体,父窗体,传值,输入正确 - moss_tan_jun</title><summary type="text">窗体的show方法，没有给调用代码任何通知，如果需要通知，使用showdialog是一种好的选择。在调用show方法后，show方法后面的代码会立即执行，调用showdialog方法后，调用代码被暂停执行，等到调用showdialog方法的窗体关系后再继续执行。而且窗体可以返回一个dialogresult值，他描述了窗体关闭的原因，例如OK,Cancel，yes，no等。为了让窗体返回一个dialogresult，必须设置窗体的dialogresult值，或者在窗体的一个按钮上设置dialogresult属性。例子：下面是子窗体代码，要求输入phone，然后会返回给父窗体。usingSyste</summary><published>2013-01-08T02:42:00Z</published><updated>2013-01-08T02:42:00Z</updated><author><name>moss_tan_jun</name><uri>http://www.cnblogs.com/moss_tan_jun/</uri></author><link rel="alternate" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850672.html" /><link rel="alternate" type="text/html" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850672.html" /><content type="html">&lt;p&gt;窗体的show方法，没有给调用代码任何通知，如果需要通知，使用showdialog是一种好的选择。&lt;br /&gt;在调用show方法后，show方法后面的代码会立即执行，调用showdialog方法后，调用代码被暂停执行，等到调用showdialog方法的窗体关系后再继续执行。而且窗体可以返回一个dialogresult值，他描述了窗体关闭的原因，例如OK,Cancel，yes，no等。为了让窗体返回一个dialogresult，必须设置窗体的dialogresult值，或者在窗体的一个按钮上设置dialogresult属性。&lt;br /&gt;&lt;br /&gt;例子：&lt;br /&gt;下面是子窗体代码，要求输入phone，然后会返回给父窗体。&lt;/p&gt;&lt;div style="padding-bottom: 4px; background-color: #eeeeee; padding-left: 4px; width: 98%; padding-right: 5px; font-size: 13px; word-break: break-all; padding-top: 4px; border: #cccccc 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Collections.Generic;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.ComponentModel;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Data;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Drawing;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Text;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Windows.Forms;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;namespace&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;WindowsApplication1&lt;br /&gt;&lt;img id="Codehighlighter1_196_651_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_196_651_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_196_651_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_196_651_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;partial&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;class&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Phone&amp;nbsp;:&amp;nbsp;Form&lt;br /&gt;&lt;img id="Codehighlighter1_240_649_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_240_649_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_240_649_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_240_649_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Phone()&lt;br /&gt;&lt;img id="Codehighlighter1_273_423_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_273_423_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_273_423_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_273_423_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;InitializeComponent();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;btnOK.DialogResult&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;DialogResult.OK;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;btnOK.DialogResult&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;DialogResult.Cancel;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;string&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;PhoneNumber&lt;br /&gt;&lt;img id="Codehighlighter1_466_562_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_466_562_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_466_562_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_466_562_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img id="Codehighlighter1_484_509_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_484_509_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;get&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_484_509_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_484_509_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;return&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;textBox1.Text;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_526_552_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_526_552_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;set&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_526_552_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_526_552_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&amp;nbsp;textBox1.Text&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;value;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Phone_Load(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;sender,&amp;nbsp;EventArgs&amp;nbsp;e)&lt;br /&gt;&lt;img id="Codehighlighter1_631_643_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_631_643_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_631_643_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_631_643_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" alt="" align="top" /&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;p&gt;不包含任何处理按钮单击事件的代码，因为设置了每个按钮的dialogresult属性，所以单击OK或者Cancel按钮后，窗体就消失了。下面的代码显示了父窗体中调用Phone对话框的方法。&lt;/p&gt;&lt;div style="padding-bottom: 4px; background-color: #eeeeee; padding-left: 4px; width: 98%; padding-right: 5px; font-size: 13px; word-break: break-all; padding-top: 4px; border: #cccccc 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Collections.Generic;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.ComponentModel;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Data;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Drawing;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Text;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Windows.Forms;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;namespace&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;WindowsApplication1&lt;br /&gt;&lt;img id="Codehighlighter1_196_826_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_196_826_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_196_826_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_196_826_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;partial&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;class&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Form7&amp;nbsp;:&amp;nbsp;Form&lt;br /&gt;&lt;img id="Codehighlighter1_240_824_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_240_824_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_240_824_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_240_824_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Form7()&lt;br /&gt;&lt;img id="Codehighlighter1_273_319_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_273_319_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_273_319_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_273_319_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;InitializeComponent();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;button1_Click(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;sender,&amp;nbsp;EventArgs&amp;nbsp;e)&lt;br /&gt;&lt;img id="Codehighlighter1_392_818_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_392_818_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_392_818_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_392_818_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Phone&amp;nbsp;frm&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Phone();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;frm.ShowDialog();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(frm.DialogResult&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;DialogResult.OK)&lt;br /&gt;&lt;img id="Codehighlighter1_526_626_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_526_626_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_526_626_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_526_626_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;label1.Text&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #800000;"&gt;"&lt;/span&gt;&lt;span style="color: #800000;"&gt;Phone&amp;nbsp;number&amp;nbsp;is&amp;nbsp;&lt;/span&gt;&lt;span style="color: #800000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;frm.PhoneNumber;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;else&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(frm.DialogResult&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;DialogResult.Cancel)&lt;br /&gt;&lt;img id="Codehighlighter1_701_783_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_701_783_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_701_783_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_701_783_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;label1.Text&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #800000;"&gt;"&lt;/span&gt;&lt;span style="color: #800000;"&gt;form&amp;nbsp;was&amp;nbsp;canceled&lt;/span&gt;&lt;span style="color: #800000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;frm.Close();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" alt="" align="top" /&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;p&gt;看起来非常简单，创建新的Phone对象frm，在调用frm.showdialog方法是，代码停止，等待phone窗体返回，接着检查phone窗体的dialogresult属性，由于窗体还没有释放，是不可见的，所以仍可以访问公共属性phonenumber，一旦获取了需要的数据，就可以嗲用窗体的close方法。&lt;br /&gt;一切正常，但是如果返回的格式不正确怎么办，就要把showdialog方法放在循环中，就可以再次调用，让用户重新输入，就可以得到正确的值。&lt;br /&gt;&lt;br /&gt;上面的代码改成下面的即可。&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;&lt;div style="padding-bottom: 4px; background-color: #eeeeee; padding-left: 4px; width: 98%; padding-right: 5px; font-size: 13px; word-break: break-all; padding-top: 4px; border: #cccccc 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Collections.Generic;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.ComponentModel;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Data;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Drawing;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Text;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Windows.Forms;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;namespace&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;WindowsApplication1&lt;br /&gt;&lt;img id="Codehighlighter1_196_1184_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_196_1184_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_196_1184_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_196_1184_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;partial&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;class&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Form7&amp;nbsp;:&amp;nbsp;Form&lt;br /&gt;&lt;img id="Codehighlighter1_240_1182_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_240_1182_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_240_1182_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_240_1182_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Form7()&lt;br /&gt;&lt;img id="Codehighlighter1_273_319_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_273_319_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_273_319_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_273_319_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;InitializeComponent();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;button1_Click(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;sender,&amp;nbsp;EventArgs&amp;nbsp;e)&lt;br /&gt;&lt;img id="Codehighlighter1_392_1176_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_392_1176_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_392_1176_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_392_1176_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Phone&amp;nbsp;frm&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Phone();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;while&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;true&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&lt;img id="Codehighlighter1_469_1141_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_469_1141_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_469_1141_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_469_1141_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;frm.ShowDialog();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(frm.DialogResult&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;DialogResult.OK)&lt;br /&gt;&lt;img id="Codehighlighter1_578_943_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_578_943_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_578_943_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_578_943_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;label1.Text&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #800000;"&gt;"&lt;/span&gt;&lt;span style="color: #800000;"&gt;Phone&amp;nbsp;number&amp;nbsp;is&amp;nbsp;&lt;/span&gt;&lt;span style="color: #800000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;+&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;frm.PhoneNumber;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(frm.PhoneNumber.Length&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #800080;"&gt;8&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;||&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;frm.PhoneNumber.Length&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #800080;"&gt;12&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&lt;img id="Codehighlighter1_757_811_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_757_811_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_757_811_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_757_811_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;break&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;else&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img id="Codehighlighter1_857_925_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_857_925_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_857_925_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_857_925_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;MessageBox.Show(&lt;/span&gt;&lt;span style="color: #800000;"&gt;""&lt;/span&gt;&lt;span style="color: #000000;"&gt;);&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;else&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(frm.DialogResult&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;DialogResult.Cancel)&lt;br /&gt;&lt;img id="Codehighlighter1_1026_1127_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1026_1127_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_1026_1127_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1026_1127_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;label1.Text&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #800000;"&gt;"&lt;/span&gt;&lt;span style="color: #800000;"&gt;form&amp;nbsp;was&amp;nbsp;canceled&lt;/span&gt;&lt;span style="color: #800000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;break&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;frm.Close();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" alt="" align="top" /&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;img src="http://counter.cnblogs.com/blog/rss/2850672" width="1" height="1" alt=""/&gt;&lt;br/&gt;&lt;p&gt;本文链接：&lt;a href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850672.html" target="_blank"&gt;http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850672.html&lt;/a&gt;，转载请注明。&lt;/p&gt;</content></entry><entry><id>http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850663.html</id><title type="text">WinForm中如何判断关闭事件来源于用户点击右上角的“关闭”按钮 - moss_tan_jun</title><summary type="text">在C#的WinForm程序中，有的时候需要判定关闭请求从哪里发出来的。比如是用户点击了右上角的“关闭”按钮，还是调用了WinForm.Close()方法。最典型的是要知道点击右上角的“关闭”按钮发出的事件。下面这个方法可以判断这点：protected override void WndProc(refMessage msg) { const int WM_SYSCOMMAND = 0x0112;const int SC_CLOSE = 0xF060; if (msg.Msg == WM_SYSCOMMAND&amp;&amp; ((int)msg.WParam == SC_CLOSE)){//</summary><published>2013-01-08T02:40:00Z</published><updated>2013-01-08T02:40:00Z</updated><author><name>moss_tan_jun</name><uri>http://www.cnblogs.com/moss_tan_jun/</uri></author><link rel="alternate" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850663.html" /><link rel="alternate" type="text/html" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850663.html" /><content type="html">&lt;p&gt;在C#的WinForm程序中，有的时候需要判定关闭请求从哪里发出来的。比如是用户点击了右上角的&amp;ldquo;关闭&amp;rdquo;按钮，还是调用了WinForm.Close()方法。最典型的是要知道点击右上角的&amp;ldquo;关闭&amp;rdquo;按钮发出的事件。下面这个方法可以判断这点：&lt;/p&gt;&lt;p&gt;protected override void WndProc(ref&amp;nbsp;Message msg) &lt;br /&gt;{&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; const int WM_SYSCOMMAND = 0x0112;&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;const int SC_CLOSE = 0xF060;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (msg.Msg == WM_SYSCOMMAND&amp;nbsp;&amp;amp;&amp;amp; ((int)msg.WParam == SC_CLOSE))&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// 点击winform右上关闭按钮&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// 加入想要的逻辑处理&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; return;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;base.WndProc(ref&amp;nbsp;msg);&amp;nbsp;&lt;br /&gt;}&lt;/p&gt;&lt;img src="http://counter.cnblogs.com/blog/rss/2850663" width="1" height="1" alt=""/&gt;&lt;br/&gt;&lt;p&gt;本文链接：&lt;a href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850663.html" target="_blank"&gt;http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850663.html&lt;/a&gt;，转载请注明。&lt;/p&gt;</content></entry><entry><id>http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850661.html</id><title type="text">MDI窗体，子窗体在父窗体中最大化，如果子窗体已经打开则显示，不重复打开窗体 - moss_tan_jun</title><summary type="text">usingSystem;usingSystem.Collections.Generic;usingSystem.ComponentModel;usingSystem.Data;usingSystem.Drawing;usingSystem.Text;usingSystem.Windows.Forms;namespaceWindowsApplication4{publicpartialclassfrmMain:Form{publicfrmMain(){InitializeComponent();}privatevoid登录ToolStripMenuItem_Click(objectsender,</summary><published>2013-01-08T02:39:00Z</published><updated>2013-01-08T02:39:00Z</updated><author><name>moss_tan_jun</name><uri>http://www.cnblogs.com/moss_tan_jun/</uri></author><link rel="alternate" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850661.html" /><link rel="alternate" type="text/html" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850661.html" /><content type="html">&lt;p&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Collections.Generic;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.ComponentModel;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Data;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Drawing;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Text;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Windows.Forms;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;namespace&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;WindowsApplication4&lt;br /&gt;&lt;img id="Codehighlighter1_196_1635_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_196_1635_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" alt="" align="top" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_196_1635_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_196_1635_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;partial&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;class&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;frmMain&amp;nbsp;:&amp;nbsp;Form&lt;br /&gt;&lt;img id="Codehighlighter1_242_1632_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_242_1632_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_242_1632_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_242_1632_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;frmMain()&lt;br /&gt;&lt;img id="Codehighlighter1_277_323_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_277_323_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_277_323_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_277_323_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;InitializeComponent();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;登录ToolStripMenuItem_Click(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;sender,&amp;nbsp;EventArgs&amp;nbsp;e)&lt;br /&gt;&lt;img id="Codehighlighter1_408_884_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_408_884_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_408_884_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_408_884_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;foreach&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(Form&amp;nbsp;form&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;in&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Application.OpenForms)&lt;br /&gt;&lt;img id="Codehighlighter1_479_706_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_479_706_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_479_706_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_479_706_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(form.Name&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #800000;"&gt;"&lt;/span&gt;&lt;span style="color: #800000;"&gt;frmLogin&lt;/span&gt;&lt;span style="color: #800000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&lt;img id="Codehighlighter1_542_692_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_542_692_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_542_692_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_542_692_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;form.Activate();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;form.WindowState&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;FormWindowState.Maximized;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;return&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;frmLogin&amp;nbsp;login&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;frmLogin();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;login.MdiParent&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;login.WindowState&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;FormWindowState.Maximized;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;login.Show();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;日志ToolStripMenuItem_Click(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;sender,&amp;nbsp;EventArgs&amp;nbsp;e)&lt;br /&gt;&lt;img id="Codehighlighter1_969_1376_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_969_1376_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_969_1376_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_969_1376_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;foreach&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(Form&amp;nbsp;form&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;in&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;Application.OpenForms)&lt;br /&gt;&lt;img id="Codehighlighter1_1040_1203_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1040_1203_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_1040_1203_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1040_1203_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(form.Text&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #800000;"&gt;"&lt;/span&gt;&lt;span style="color: #800000;"&gt;frmLogInfo&lt;/span&gt;&lt;span style="color: #800000;"&gt;"&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&lt;img id="Codehighlighter1_1105_1189_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1105_1189_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_1105_1189_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1105_1189_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;form.Activate();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;return&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;frmLogInfo&amp;nbsp;log&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;frmLogInfo();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;log.MdiParent&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;log.WindowState&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;FormWindowState.Maximized;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;log.Show();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;frmMain_Load(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;sender,&amp;nbsp;EventArgs&amp;nbsp;e)&lt;br /&gt;&lt;img id="Codehighlighter1_1448_1625_Open_Image" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" alt="" align="top" /&gt;&lt;img id="Codehighlighter1_1448_1625_Closed_Image" style="display: none;" onclick="code_collapse_toggle(this);" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span id="Codehighlighter1_1448_1625_Closed_Text" style="background-color: #ffffff; display: none; border: #808080 1px solid;"&gt;&lt;img src="http://www.cnblogs.com/Images/dot.gif" alt="" /&gt;&lt;/span&gt;&lt;span id="Codehighlighter1_1448_1625_Open_Text"&gt;&lt;span style="color: #000000;"&gt;{&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;frmLogin&amp;nbsp;login&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;new&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;frmLogin();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;login.WindowState&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;FormWindowState.Maximized;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;login.MdiParent&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;this&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;login.Show();&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /&gt;&lt;br /&gt;&lt;img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" alt="" align="top" /&gt;}&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;MDI窗体，子窗体在父窗体中最大化，如果子窗体已经打开则显示，不重复打开窗体，当然可以使用单件模式来实现或者使用多线程里面的互斥体技术。&lt;/p&gt;&lt;img src="http://counter.cnblogs.com/blog/rss/2850661" width="1" height="1" alt=""/&gt;&lt;br/&gt;&lt;p&gt;本文链接：&lt;a href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850661.html" target="_blank"&gt;http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850661.html&lt;/a&gt;，转载请注明。&lt;/p&gt;</content></entry><entry><id>http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850638.html</id><title type="text">c#，winform，treeview，选中节点，选中相应的全部子节点，取消节点，取消父节点，小技巧 - moss_tan_jun</title><summary type="text">在开发的时候经常使用treeview控件来显示组织结构啊，目录结构啊，通常会结合属性checkedboxs，来做选中，取消的操作下面是一个选中，取消的小例子，选中节点的时候，如果节点存在子节点，可以选中全部的子节点；如果取消一个节点的选中状态，当前节点同时又存在父节点的话，就取消父节点的选中状态。如图所示：代码如下：CodeCode highlighting produced by Actipro CodeHighlighter (freeware)http://www.CodeHighlighter.com/--&gt;usingSystem;usingSystem.Collections.</summary><published>2013-01-08T02:29:00Z</published><updated>2013-01-08T02:29:00Z</updated><author><name>moss_tan_jun</name><uri>http://www.cnblogs.com/moss_tan_jun/</uri></author><link rel="alternate" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850638.html" /><link rel="alternate" type="text/html" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850638.html" /><content type="html">&lt;p&gt;在开发的时候经常使用treeview控件来显示组织结构啊，目录结构啊，通常会结合属性checkedboxs，来做选中，取消的操作&lt;br /&gt;&lt;br /&gt;下面是一个选中，取消的小例子，选中节点的时候，如果节点存在子节点，可以选中全部的子节点；如果取消一个节点的选中状态，当前节点同时又存在父节点的话，就取消父节点的选中状态。&lt;br /&gt;&lt;br /&gt;如图所示：&lt;br /&gt;&lt;img src="http://images.cnblogs.com/cnblogs_com/virusswb/treeview1.JPG" alt="treeview1.JPG" width="147" height="192" border="0" /&gt;&lt;br /&gt;&lt;br /&gt;&lt;img src="http://images.cnblogs.com/cnblogs_com/virusswb/treeview2.JPG" alt="treeview2.JPG" width="143" height="198" border="0" /&gt;&lt;br /&gt;&lt;br /&gt;代码如下：&lt;/p&gt;&lt;div style="background-color: #F5F5F5;border: 1px solid #CCCCCC;padding:10px;"&gt;&lt;img id="Code_Closed_Image_113331" style="display: none;" onclick="this.style.display='none'; document.getElementById('Code_Closed_Text_113331').style.display='none'; document.getElementById('Code_Open_Image_113331').style.display='inline'; document.getElementById('Code_Open_Text_113331').style.display='inline';" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" alt="" width="11" height="16" align="top" /&gt;&lt;img id="Code_Open_Image_113331" style="display: inline;" onclick="this.style.display='none'; document.getElementById('Code_Open_Text_113331').style.display='none'; getElementById('Code_Closed_Image_113331').style.display='inline'; getElementById('Code_Closed_Text_113331').style.display='inline';" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" alt="" width="11" height="16" align="top" /&gt;&lt;span id="Code_Closed_Text_113331" class="cnblogs_code_Collapse" style="display: none;"&gt;Code&lt;/span&gt;&lt;span id="Code_Open_Text_113331" style="display: inline;"&gt;&lt;br /&gt;&lt;!--&lt;br&gt;&lt;br&gt;Code highlighting produced by Actipro CodeHighlighter (freeware)&lt;br&gt;http://www.CodeHighlighter.com/&lt;br&gt;&lt;br&gt;--&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Collections.Generic;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.ComponentModel;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Data;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Drawing;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Text;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;using&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Windows.Forms;&lt;br /&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;namespace&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;WindowsApplication6&lt;br /&gt;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;partial&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;class&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;TreeViewTest&amp;nbsp;:&amp;nbsp;Form&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;public&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;TreeViewTest()&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;InitializeComponent();&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;TreeViewTest_Load(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;sender,&amp;nbsp;EventArgs&amp;nbsp;e)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;treeView1.ExpandAll();&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;treeView1_AfterCheck(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;sender,&amp;nbsp;TreeViewEventArgs&amp;nbsp;e)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(e.Action&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;TreeViewAction.ByMouse)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;textBox1.Text&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;e.Node.Text;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(e.Node.Checked)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;取消节点选中状态之后，取消所有父节点的选中状态&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;setChildNodeCheckedState(e.Node,&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;true&lt;/span&gt;&lt;span style="color: #000000;"&gt;);&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;else&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;取消节点选中状态之后，取消所有父节点的选中状态&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;setChildNodeCheckedState(e.Node,&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;false&lt;/span&gt;&lt;span style="color: #000000;"&gt;);&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;如果节点存在父节点，取消父节点的选中状态&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(e.Node.Parent&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;!=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;null&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;setParentNodeCheckedState(e.Node,&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;false&lt;/span&gt;&lt;span style="color: #000000;"&gt;);&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;取消节点选中状态之后，取消所有父节点的选中状态&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;setParentNodeCheckedState(TreeNode&amp;nbsp;currNode,&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;bool&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;state)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;TreeNode&amp;nbsp;parentNode&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;currNode.Parent;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;parentNode.Checked&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;state;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(currNode.Parent.Parent&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;!=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;null&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;setParentNodeCheckedState(currNode.Parent,&amp;nbsp;state);&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;选中节点之后，选中节点的所有子节点&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;setChildNodeCheckedState(TreeNode&amp;nbsp;currNode,&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;bool&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;state)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;TreeNodeCollection&amp;nbsp;nodes&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;currNode.Nodes;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;(nodes.Count&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color: #800080;"&gt;0&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;foreach&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(TreeNode&amp;nbsp;tn&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;in&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;nodes)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;tn.Checked&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;state;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;setChildNodeCheckedState(tn,&amp;nbsp;state);&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;img src="http://counter.cnblogs.com/blog/rss/2850638" width="1" height="1" alt=""/&gt;&lt;br/&gt;&lt;p&gt;本文链接：&lt;a href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850638.html" target="_blank"&gt;http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850638.html&lt;/a&gt;，转载请注明。&lt;/p&gt;</content></entry><entry><id>http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850617.html</id><title type="text">只能输入数字的TextBox - moss_tan_jun</title><summary type="text">原代码:privatevoidtextBox1_KeyPress(objectsender,KeyPressEventArgse){if(!char.IsDigit(e.KeyChar))e.Handled=true;//'\b'是退格键值if(e.KeyChar=='\b'||e.KeyChar=='.')e.Handled=false;}以上代码是无法限制全角数字输入的.而在项目中全角数字是不能算真正的数字,因为在参加计算时全角可能会出错.修改的代码:privatevoidtextBox1_KeyPress(objectsender,KeyP</summary><published>2013-01-08T02:19:00Z</published><updated>2013-01-08T02:19:00Z</updated><author><name>moss_tan_jun</name><uri>http://www.cnblogs.com/moss_tan_jun/</uri></author><link rel="alternate" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850617.html" /><link rel="alternate" type="text/html" href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850617.html" /><content type="html">&lt;p&gt;原代码:&lt;/p&gt;&lt;div style="padding-bottom: 4px; background-color: #eeeeee; padding-left: 4px; width: 98%; padding-right: 5px; font-size: 13px; word-break: break-all; padding-top: 4px; border: #cccccc 1px solid;"&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;textBox1_KeyPress(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;sender,&amp;nbsp;KeyPressEventArgs&amp;nbsp;e)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;(&lt;/span&gt;&lt;span style="color: #000000;"&gt;!&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;char&lt;/span&gt;&lt;span style="color: #000000;"&gt;.IsDigit(e.KeyChar))&amp;nbsp;e.Handled&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;true&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;'\b'是退格键值&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;(e.KeyChar&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #800000;"&gt;'&lt;/span&gt;&lt;span style="color: #800000;"&gt;\b&lt;/span&gt;&lt;span style="color: #800000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;||&lt;/span&gt;&lt;span style="color: #000000;"&gt;e.KeyChar&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #800000;"&gt;'&lt;/span&gt;&lt;span style="color: #800000;"&gt;.&lt;/span&gt;&lt;span style="color: #800000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&amp;nbsp;e.Handled&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;false&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/div&gt;&lt;p&gt;以上代码是无法限制全角数字输入的.而在项目中全角数字是不能算真正的数字,因为在参加计算时全角可能会出错.&lt;br /&gt;修改的代码:&lt;/p&gt;&lt;div style="padding-bottom: 4px; background-color: #eeeeee; padding-left: 4px; width: 98%; padding-right: 5px; font-size: 13px; word-break: break-all; padding-top: 4px; border: #cccccc 1px solid;"&gt;&lt;span style="color: #0000ff;"&gt;private&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;void&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;textBox1_KeyPress(&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;object&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;sender,&amp;nbsp;KeyPressEventArgs&amp;nbsp;e)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;全角占一个汉字,半角点半个汉字,所以在字节上是不同的&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;全角数字"KeyChar"=2,半解数字"KeyChar"=1&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;byte&lt;/span&gt;&lt;span style="color: #000000;"&gt;[]&amp;nbsp;array&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;System.Text.Encoding.Default.GetBytes(e.KeyChar.ToString());&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;array.LongLength,而不是array.Length&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(&lt;/span&gt;&lt;span style="color: #000000;"&gt;!&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;char&lt;/span&gt;&lt;span style="color: #000000;"&gt;.IsDigit(e.KeyChar)&lt;/span&gt;&lt;span style="color: #000000;"&gt;||&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;array.LongLength&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #800080;"&gt;2&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&amp;nbsp;e.Handled&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;true&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #008000;"&gt;//&lt;/span&gt;&lt;span style="color: #008000;"&gt;'\b'是退格键值&lt;/span&gt;&lt;span style="color: #008000;"&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;if&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;(e.KeyChar&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #800000;"&gt;'&lt;/span&gt;&lt;span style="color: #800000;"&gt;\b&lt;/span&gt;&lt;span style="color: #800000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;||&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;e.KeyChar&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;==&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #800000;"&gt;'&lt;/span&gt;&lt;span style="color: #800000;"&gt;.&lt;/span&gt;&lt;span style="color: #800000;"&gt;'&lt;/span&gt;&lt;span style="color: #000000;"&gt;)&amp;nbsp;e.Handled&amp;nbsp;&lt;/span&gt;&lt;span style="color: #000000;"&gt;=&lt;/span&gt;&lt;span style="color: #000000;"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff;"&gt;false&lt;/span&gt;&lt;span style="color: #000000;"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;/span&gt;&lt;/div&gt;&lt;img src="http://counter.cnblogs.com/blog/rss/2850617" width="1" height="1" alt=""/&gt;&lt;br/&gt;&lt;p&gt;本文链接：&lt;a href="http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850617.html" target="_blank"&gt;http://www.cnblogs.com/moss_tan_jun/archive/2013/01/08/2850617.html&lt;/a&gt;，转载请注明。&lt;/p&gt;</content></entry></feed>